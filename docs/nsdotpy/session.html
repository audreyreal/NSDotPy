<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.1.1"/>
    <title>nsdotpy.session API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>




            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#canonicalize">canonicalize</a>
            </li>
            <li>
                    <a class="function" href="#uncanonicalize">uncanonicalize</a>
            </li>
            <li>
                    <a class="class" href="#NSSession">NSSession</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#NSSession.__init__">NSSession</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.refresh_auth_values">refresh_auth_values</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.request">request</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.api_request">api_request</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.api_issue">api_issue</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.api_command">api_command</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.api_giftcard">api_giftcard</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.api_dispatch">api_dispatch</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.api_rmb">api_rmb</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.login">login</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.change_nation_flag">change_nation_flag</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.change_nation_settings">change_nation_settings</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.move_to_region">move_to_region</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.vote">vote</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.join_wa">join_wa</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.resign_wa">resign_wa</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.apply_wa">apply_wa</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.endorse">endorse</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.clear_dossier">clear_dossier</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.add_to_dossier">add_to_dossier</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.wa_vote">wa_vote</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.refound_nation">refound_nation</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.create_region">create_region</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.upload_to_region">upload_to_region</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.set_flag_and_banner">set_flag_and_banner</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.change_wfe">change_wfe</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.request_embassy">request_embassy</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.close_embassy">close_embassy</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.abort_embassy">abort_embassy</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.cancel_embassy">cancel_embassy</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.tag">tag</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.eject">eject</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.banject">banject</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.junk_card">junk_card</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.open_pack">open_pack</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.ask">ask</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.bid">bid</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.remove_ask">remove_ask</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.remove_bid">remove_bid</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.expand_deck">expand_deck</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.add_to_collection">add_to_collection</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.remove_from_collection">remove_from_collection</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.create_collection">create_collection</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.delete_collection">delete_collection</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.can_nation_be_founded">can_nation_be_founded</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.join_nday_faction">join_nday_faction</a>
                        </li>
                        <li>
                                <a class="function" href="#NSSession.leave_nday_faction">leave_nday_faction</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
nsdotpy<wbr>.session    </h1>

                
                        <input id="mod-session-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-session-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="c1"># This file is part of NSDotPy, a wrapper around httpx that makes interacting</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="c1"># with the HTML nationstates.net site legally and efficiently easier.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="c1">#</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="c1"># NSDotPy is free software: you can redistribute it and/or modify</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="c1"># it under the terms of the GNU Affero General Public License</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="c1"># as published by the Free Software Foundation either version</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="c1"># 3 of the License, or (at your option) any later version.</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="c1">#</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="c1"># NSDotPy is distributed in the hope that it will be useful but</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="c1"># WITHOUT ANY WARRANTY; without even the implied warranty of</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="c1"># See the GNU Affero General Public License for more details.</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="c1">#</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="c1"># You should have received a copy of the GNU Affero General Public License</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="c1"># along with NSDotPy. If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="c1"># standard library imports</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">import</span> <span class="nn">time</span>  <span class="c1"># for ratelimiting and userclick</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">import</span> <span class="nn">logging</span>  <span class="c1"># for logging</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">import</span> <span class="nn">logging.config</span>  <span class="c1"># for logging configuration</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">import</span> <span class="nn">mimetypes</span>  <span class="c1"># for flag and banner uploading</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="c1"># external library imports</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="kn">import</span> <span class="nn">keyboard</span>  <span class="c1"># for the required user input</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="kn">import</span> <span class="nn">httpx</span>  <span class="c1"># for http stuff</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span><span class="p">,</span> <span class="n">Tag</span>  <span class="c1"># for parsing html and xml</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">from</span> <span class="nn">benedict</span> <span class="kn">import</span> <span class="n">benedict</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="c1"># local imports</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">valid</span>  <span class="c1"># for valid region tags</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="k">def</span> <span class="nf">canonicalize</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a string to its canonical form used by the nationstates api.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd">    Args:</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="sd">        string (str): The string to convert</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">    Returns:</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">        str: The canonical form of the string</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="k">def</span> <span class="nf">uncanonicalize</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a string into a user friendly form from it&#39;s canonical nationstates api form.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">    Args:</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">        string (str): The string to convert</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">    Returns:</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">        str: The uncanonicale form of the string</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="k">class</span> <span class="nc">NSSession</span><span class="p">:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>        <span class="n">script_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>        <span class="n">script_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>        <span class="n">script_author</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>        <span class="n">script_user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>        <span class="n">keybind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;space&quot;</span><span class="p">,</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a>        <span class="n">link_to_src</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>    <span class="p">):</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A wrapper around httpx that abstracts away</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">        interacting with the HTML nationstates.net site.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">        Focused on legality, correctness, and ease of use.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">        Args:</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">            script_name (str): Name of your script</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">            script_version (str): Version number of your script</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">            script_author (str): Author of your script</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">            script_user (str): Nation name of the user running your script</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">            keybind (str, optional): Keybind to count as a user click. Defaults to &quot;space&quot;.</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">            link_to_src (str, optional): Link to the source code of your script.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">            logger (logging.Logger | None, optional): Logger to use. Will create its own with name &quot;NSDotPy&quot; if none is specified. Defaults to None.</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">=</span> <span class="s2">&quot;2.3.0&quot;</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>        <span class="c1"># Initialize logger</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="p">:</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_init_logger</span><span class="p">()</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a>        <span class="c1"># Create a new httpx session</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_session</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a>            <span class="n">http2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>        <span class="p">)</span>  <span class="c1"># ns can b slow, 30 seconds is hopefully a good sweet spot</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>        <span class="c1"># Set the user agent to the script name, version, author, and user as recommended in the script rules thread:</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a>        <span class="c1"># https://forum.nationstates.net/viewtopic.php?p=16394966&amp;sid=be37623536dbc8cee42d8d043945b887#p16394966</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_user_agent</span><span class="p">(</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>            <span class="n">script_name</span><span class="p">,</span> <span class="n">script_version</span><span class="p">,</span> <span class="n">script_author</span><span class="p">,</span> <span class="n">script_user</span><span class="p">,</span> <span class="n">link_to_src</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>        <span class="p">)</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>        <span class="c1"># Initialize nationstates specific stuff</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_auth_region</span> <span class="o">=</span> <span class="s2">&quot;rwby&quot;</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chk</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">localid</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">keybind</span> <span class="o">=</span> <span class="n">keybind</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>        <span class="c1"># Make sure the nations in the user agent actually exist</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_nations</span><span class="p">({</span><span class="n">script_author</span><span class="p">,</span> <span class="n">script_user</span><span class="p">}):</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>                <span class="s2">&quot;One of, or both, of the nations in the user agent do not exist. Make sure you&#39;re only including the nation name in the constructor, e.g. &#39;Thorn1000&#39; instead of &#39;Devved by Thorn1000&#39;&quot;</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a>            <span class="p">)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initialized. Keybind to continue is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">keybind</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>    <span class="k">def</span> <span class="nf">_validate_shard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shard</span><span class="p">,</span> <span class="n">valid_shards</span><span class="p">,</span> <span class="n">api</span><span class="p">):</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper function to validate a single shard.&quot;&quot;&quot;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>        <span class="k">if</span> <span class="n">shard</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_shards</span><span class="p">:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">shard</span><span class="si">}</span><span class="s2"> is not a valid shard for </span><span class="si">{</span><span class="n">api</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a>    <span class="k">def</span> <span class="nf">_validate_shards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">shards</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates shards for a given API.&quot;&quot;&quot;</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>        <span class="n">api_to_shard_set</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">NATION_SHARDS</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>            <span class="o">|</span> <span class="n">valid</span><span class="o">.</span><span class="n">PRIVATE_NATION_SHARDS</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>            <span class="o">|</span> <span class="n">valid</span><span class="o">.</span><span class="n">PRIVATE_NATION_SHARDS</span><span class="p">,</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a>            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">REGION_SHARDS</span><span class="p">,</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>            <span class="s2">&quot;world&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">WORLD_SHARDS</span><span class="p">,</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>            <span class="s2">&quot;wa&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">WA_SHARDS</span><span class="p">,</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>        <span class="p">}</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="n">valid_shards</span> <span class="o">=</span> <span class="n">api_to_shard_set</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">api</span><span class="p">)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_shards</span><span class="p">:</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid API type: </span><span class="si">{</span><span class="n">api</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>        <span class="k">for</span> <span class="n">shard</span> <span class="ow">in</span> <span class="n">shards</span><span class="p">:</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_shard</span><span class="p">(</span><span class="n">shard</span><span class="p">,</span> <span class="n">valid_shards</span><span class="p">,</span> <span class="n">api</span><span class="p">)</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>    <span class="k">def</span> <span class="nf">_set_user_agent</span><span class="p">(</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>        <span class="n">script_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>        <span class="n">script_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>        <span class="n">script_author</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>        <span class="n">script_user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>        <span class="n">link_to_src</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>    <span class="p">):</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">script_version</span><span class="si">}</span><span class="s2"> (by:</span><span class="si">{</span><span class="n">script_author</span><span class="si">}</span><span class="s2">; usedBy:</span><span class="si">{</span><span class="n">script_user</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a>        <span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>        <span class="k">if</span> <span class="n">link_to_src</span><span class="p">:</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="si">}</span><span class="s2">; src:</span><span class="si">{</span><span class="n">link_to_src</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="si">}</span><span class="s2">; Written with NSDotPy/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span><span class="si">}</span><span class="s2"> (by:Sweeze; src:github.com/sw33ze/NSDotPy)&quot;</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">})</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>    <span class="k">def</span> <span class="nf">_validate_nations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nations</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if a list of nations exist using the NationStates API.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">        Args:</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">            nations (set[str]): List of nations to check</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="sd">        Returns:</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">            bool: True if all nations in the set exist, False otherwise.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_request</span><span class="p">(</span><span class="s2">&quot;world&quot;</span><span class="p">,</span> <span class="n">shard</span><span class="o">=</span><span class="s2">&quot;nations&quot;</span><span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="n">world_nations</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">nations</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>        <span class="c1"># check if all nations in the list exist in the world nations</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span> <span class="ow">in</span> <span class="n">world_nations</span> <span class="k">for</span> <span class="n">nation</span> <span class="ow">in</span> <span class="n">nations</span><span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>    <span class="k">def</span> <span class="nf">_init_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;NSDotPy&quot;</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>            <span class="s2">&quot;disable_existing_loggers&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>            <span class="s2">&quot;formatters&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>                <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>                    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>                    <span class="s2">&quot;datefmt&quot;</span><span class="p">:</span> <span class="s2">&quot;%I:%M:%S %p&quot;</span><span class="p">,</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>                <span class="p">}</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>            <span class="p">},</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>            <span class="s2">&quot;handlers&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>                <span class="s2">&quot;console&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>                    <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;logging.StreamHandler&quot;</span><span class="p">,</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>                    <span class="s2">&quot;formatter&quot;</span><span class="p">:</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>                <span class="p">}</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>            <span class="p">},</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>            <span class="s2">&quot;loggers&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>                <span class="s2">&quot;NSDotPy&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;handlers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;console&quot;</span><span class="p">],</span> <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;INFO&quot;</span><span class="p">},</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>                <span class="s2">&quot;httpx&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;handlers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;console&quot;</span><span class="p">],</span> <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">},</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>            <span class="p">},</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>        <span class="p">}</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dictConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>    <span class="k">def</span> <span class="nf">_get_auth_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Response</span><span class="p">):</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>        <span class="c1"># make sure it&#39;s actually html first</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;text/html&quot;</span><span class="p">):</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>            <span class="k">return</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>        <span class="c1"># parse the html</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>        <span class="c1"># gathering chk and localid so i dont have to worry about authenticating l8r</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="k">if</span> <span class="n">chk</span> <span class="o">:=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;chk&quot;</span><span class="p">}):</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">chk</span> <span class="o">=</span> <span class="n">chk</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>        <span class="k">if</span> <span class="n">localid</span> <span class="o">:=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;localid&quot;</span><span class="p">}):</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">localid</span> <span class="o">=</span> <span class="n">localid</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        <span class="k">if</span> <span class="n">pin</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pin&quot;</span><span class="p">):</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>            <span class="c1"># you should never really need the pin but just in case i&#39;ll store it</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>            <span class="c1"># PAST ME WAS RIGHT, I NEEDED IT FOR THE PRIVATE API!!</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pin</span> <span class="o">=</span> <span class="n">pin</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>        <span class="k">if</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;STANDOUT&quot;</span><span class="p">}):</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>                <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;STANDOUT&quot;</span><span class="p">})[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>            <span class="p">)</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>    <span class="k">def</span> <span class="nf">_wait_for_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Blocks execution until the user presses a key. Used as the one click = one request action.</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">        Args:</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">            key (str): The key to wait for</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a><span class="sd">        Returns:</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">            int: Userclick parameter, milliseconds since the epoch&quot;&quot;&quot;</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>        <span class="n">keyboard</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>        <span class="c1"># the trigger_on_release parameter is broken on windows</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>        <span class="c1"># because of a bug in keyboard so we have to do this</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>        <span class="k">while</span> <span class="n">keyboard</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>            <span class="k">pass</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>    <span class="k">def</span> <span class="nf">_get_detag_wfe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the detagged WFE of the region you&#39;re in.</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="sd">        Returns:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">            str: The detagged WFE&quot;&quot;&quot;</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting detag WFE for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>            <span class="sa">f</span><span class="s2">&quot;https://greywardens.xyz/tools/wfe_index/region=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>        <span class="p">)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>        <span class="c1"># the safest bet for a detag wfe is the first wfe of the region</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>        <span class="k">return</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;pre&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>    <span class="k">def</span> <span class="nf">_validate_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>        <span class="n">max_lengths</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>            <span class="s2">&quot;pretitle&quot;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>            <span class="s2">&quot;slogan&quot;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>            <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>            <span class="s2">&quot;animal&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>            <span class="s2">&quot;demonym_noun&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>            <span class="s2">&quot;demonym_adjective&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>            <span class="s2">&quot;demonym_plural&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="p">}</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>        <span class="c1"># go through each key in the data dict and make sure they&#39;re below the max length</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">max_lengths</span><span class="p">:</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>                <span class="k">continue</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_lengths</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is too long, max length is </span><span class="si">{</span><span class="n">max_lengths</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;slogan&quot;</span><span class="p">:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> should have a minimum length of 2 characters.&quot;</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>            <span class="c1"># check if pretitle contains any non-alphanumeric characters (except spaces)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;pretitle&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isalnum</span><span class="p">():</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>                    <span class="s2">&quot;Pretitle should only contain alphanumeric characters or spaces.&quot;</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>                <span class="p">)</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>    <span class="k">def</span> <span class="nf">_wait_for_ratelimit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>        <span class="k">if</span> <span class="s2">&quot;X-Pin&quot;</span> <span class="ow">in</span> <span class="n">head</span><span class="p">:</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pin</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>        <span class="k">if</span> <span class="n">waiting_time</span> <span class="o">:=</span> <span class="n">head</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Retry-After&quot;</span><span class="p">):</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rate limited. Waiting </span><span class="si">{</span><span class="n">waiting_time</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">waiting_time</span><span class="p">))</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>        <span class="c1"># slow down requests so we dont hit the rate limit in the first place</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>        <span class="n">requests_left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="s2">&quot;RateLimit-Remaining&quot;</span><span class="p">])</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>        <span class="k">if</span> <span class="n">requests_left</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="ow">or</span> <span class="n">constant_rate_limit</span><span class="p">:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>            <span class="n">seconds_until_reset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="s2">&quot;RateLimit-Reset&quot;</span><span class="p">])</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">seconds_until_reset</span> <span class="o">/</span> <span class="n">requests_left</span><span class="p">)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>    <span class="k">def</span> <span class="nf">_html_request</span><span class="p">(</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{},</span> <span class="n">files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="kc">False</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Response</span><span class="p">:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>        <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;chk&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">chk</span><span class="p">,</span> <span class="s2">&quot;localid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">localid</span><span class="p">}</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>        <span class="n">userclick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keybind</span><span class="p">)</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>        <span class="c1"># userclick is the number of milliseconds since the epoch, admin uses this for help enforcing the simultaneity rule</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">/userclick=</span><span class="si">{</span><span class="n">userclick</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>            <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>            <span class="n">follow_redirects</span><span class="o">=</span><span class="n">follow_redirects</span><span class="p">,</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>        <span class="p">)</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">&gt;=</span> <span class="mi">400</span><span class="p">:</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;error.html&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>            <span class="k">raise</span> <span class="n">httpx</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>                <span class="sa">f</span><span class="s2">&quot;Received status code </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">. Error page saved to error.html.&quot;</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>            <span class="p">)</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_auth_values</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>    <span class="c1"># --- end private methods --- #</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>    <span class="k">def</span> <span class="nf">refresh_auth_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Refreshing authentication values...&quot;</span><span class="p">)</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>            <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/page=display_region/region=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth_region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="s2">&quot;century&quot;</span><span class="p">},</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>        <span class="p">)</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_auth_values</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>    <span class="k">def</span> <span class="nf">request</span><span class="p">(</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>        <span class="n">files</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>        <span class="n">follow_redirects</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Response</span><span class="p">:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends a request to the given url with the given data and files.</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">        Args:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">            url (str): URL to send the request to</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">            data (dict, optional): Payload to send with the request</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">            files (dict, optional): Payload to send with requests that upload files</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">        Returns:</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">            httpx.Response: The response from the server</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>            <span class="n">banned_page</span> <span class="ow">in</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>            <span class="k">for</span> <span class="n">banned_page</span> <span class="ow">in</span> <span class="p">{</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>                <span class="s2">&quot;page=telegrams&quot;</span><span class="p">,</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>                <span class="s2">&quot;page=dilemmas&quot;</span><span class="p">,</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>                <span class="s2">&quot;page=compose_telegram&quot;</span><span class="p">,</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>                <span class="s2">&quot;page=store&quot;</span><span class="p">,</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>                <span class="s2">&quot;page=help&quot;</span><span class="p">,</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>            <span class="p">}</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>        <span class="p">):</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>                <span class="s2">&quot;You cannot use a tool to interact with telegrams, issues, getting help, or the store. Read up on the script rules: https://forum.nationstates.net/viewtopic.php?p=16394966#p16394966&quot;</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>            <span class="p">)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>        <span class="k">if</span> <span class="s2">&quot;api.cgi&quot;</span> <span class="ow">in</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>            <span class="c1"># you should be using api_request for api requests</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You should be using api_request() for api requests.&quot;</span><span class="p">)</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>        <span class="k">elif</span> <span class="s2">&quot;nationstates&quot;</span> <span class="ow">in</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>            <span class="c1"># do all the things that need to be done for html requests</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>                <span class="c1"># if lock is true then we&#39;re already in the middle of a</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>                <span class="c1"># request and we&#39;re in danger of breaking the simultaneity rule</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>                <span class="c1"># so raise an error</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>                <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>                    <span class="s2">&quot;You&#39;re already in the middle of a request. Stop trying to violate simultaneity.&quot;</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>                <span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html_request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>            <span class="c1"># if its not nationstates then just pass the request through</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>                <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="n">follow_redirects</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>            <span class="p">)</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>    <span class="k">def</span> <span class="nf">api_request</span><span class="p">(</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>        <span class="n">api</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a>        <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>        <span class="n">shard</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends a request to the nationstates api with the given data.</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">        Args:</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="sd">            api (str): The api to send the request to. Must be &quot;nation&quot;, &quot;region&quot;, &quot;world&quot;, or &quot;wa&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">            target (str, optional): The nation, region, or wa council to target. Required for non-world api requests.</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">            shard (str, optional): The shard, or shards, you&#39;re requesting for. Must be a valid shard for the given api. Only required for world and wa api requests.</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">        Returns:</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>        <span class="c1"># TODO: probably move this responsibility to a third party api library to avoid reinventing the wheel</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        <span class="c1"># if one exists of sufficient quality thats AGPLv3 compatible</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;nation&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">,</span> <span class="s2">&quot;wa&quot;</span><span class="p">}:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;api must be &#39;nation&#39;, &#39;region&#39;, &#39;world&#39;, or &#39;wa&#39;&quot;</span><span class="p">)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="o">!=</span> <span class="s2">&quot;world&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">target</span><span class="p">:</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;target must be specified for non-world api requests&quot;</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;wa&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">}</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">shard</span><span class="p">:</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;shard must be specified for world and wa api requests&quot;</span><span class="p">)</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>        <span class="c1"># end argument validation</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>        <span class="c1"># shard validation</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">shard</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>            <span class="n">shard</span> <span class="o">=</span> <span class="p">{</span><span class="n">shard</span><span class="p">}</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_shards</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="n">shard</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a>        <span class="c1"># end shard validation</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>        <span class="p">}</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="o">!=</span> <span class="s2">&quot;world&quot;</span><span class="p">:</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">api</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>        <span class="k">if</span> <span class="n">shard</span><span class="p">:</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">shard</span><span class="p">)</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/api.cgi&quot;</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>        <span class="c1"># rate limiting section</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>        <span class="c1"># if the server tells us to wait, wait</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ratelimit</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">)</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>        <span class="n">parsed_response</span> <span class="o">=</span> <span class="n">benedict</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">keyattr_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>        <span class="n">parsed_response</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>        <span class="n">parsed_response</span><span class="p">:</span> <span class="n">benedict</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="n">api</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="k">return</span> <span class="n">parsed_response</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>    <span class="k">def</span> <span class="nf">api_issue</span><span class="p">(</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>        <span class="n">issue</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>        <span class="n">option</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Answers an issue via the API.</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">        Args:</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">            issue (int): the ID of the issue.</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">            option (int): the issue option to choose.</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">        Returns:</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">password</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">):</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify authentication&quot;</span><span class="p">)</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>            <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;issue&quot;</span><span class="p">,</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>            <span class="s2">&quot;issue&quot;</span><span class="p">:</span> <span class="n">issue</span><span class="p">,</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="n">option</span><span class="p">,</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="p">}</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/api.cgi&quot;</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="c1"># rate limiting section</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>        <span class="c1"># if the server tells us to wait, wait</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ratelimit</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>        <span class="n">parsed_response</span> <span class="o">=</span> <span class="n">benedict</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">keyattr_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="n">parsed_response</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>        <span class="n">parsed_response</span><span class="p">:</span> <span class="n">benedict</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="s2">&quot;nation&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>        <span class="k">return</span> <span class="n">parsed_response</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>    <span class="k">def</span> <span class="nf">api_command</span><span class="p">(</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>        <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>        <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends a non-issue command to the nationstates api with the given data and password.</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a><span class="sd">        Args:</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a><span class="sd">            command (str): The command to perform. Must be &quot;giftcard&quot;, &quot;dispatch&quot;, &quot;rmbpost&quot;</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a><span class="sd">            data (str, optional): The unique data to send with the parameters of the command; consult the API docs for more information.</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="sd">            mode (str, optional): Whether to prepare or to execute the command. If value is given, does one of the two and returns result, if no value is given, does both and returns result of execute.</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="sd">        Returns:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>        <span class="k">if</span> <span class="n">command</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;giftcard&quot;</span><span class="p">,</span> <span class="s2">&quot;dispatch&quot;</span><span class="p">,</span> <span class="s2">&quot;rmbpost&quot;</span><span class="p">}:</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;command must be &#39;giftcard&#39;, &#39;dispatch&#39;, or &#39;rmbpost&#39;&quot;</span><span class="p">)</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">password</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">):</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify authentication&quot;</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;prepare&quot;</span><span class="p">,</span> <span class="s2">&quot;execute&quot;</span><span class="p">}:</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be prepare or execute&quot;</span><span class="p">)</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;12&quot;</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;nation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span> <span class="k">if</span> <span class="n">mode</span> <span class="k">else</span> <span class="s2">&quot;prepare&quot;</span>  <span class="c1"># if no mode than first prepare</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/api.cgi&quot;</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>        <span class="c1"># rate limiting section</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="c1"># if the server tells us to wait, wait</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ratelimit</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">)</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>        <span class="n">parsed_response</span> <span class="o">=</span> <span class="n">benedict</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">keyattr_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>        <span class="n">parsed_response</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>        <span class="n">parsed_response</span><span class="p">:</span> <span class="n">benedict</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="s2">&quot;nation&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>            <span class="c1"># if no mode was specified earlier, repeat command with execute and token</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">nation</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;execute&quot;</span><span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>            <span class="k">return</span> <span class="n">parsed_response</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>    <span class="k">def</span> <span class="nf">api_giftcard</span><span class="p">(</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>        <span class="n">card_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="n">season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="n">recipient</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gifts a card using the API.</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a><span class="sd">        Args:</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a><span class="sd">            card_id (int): The ID of the card to gift.</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a><span class="sd">            season (int): The season of the card to gift.</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a><span class="sd">            recipient (str): The nation to gift the card to.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a><span class="sd">        Returns:</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cardid&quot;</span><span class="p">:</span> <span class="n">card_id</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">:</span> <span class="n">season</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">recipient</span><span class="p">)}</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>            <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;giftcard&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="o">=</span><span class="n">constant_rate_limit</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>        <span class="p">)</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>    <span class="k">def</span> <span class="nf">api_dispatch</span><span class="p">(</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>        <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>        <span class="n">category</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>        <span class="n">subcategory</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>        <span class="n">dispatchid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add, edit, or remove a dispatch.</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a><span class="sd">        Args:</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a><span class="sd">            action (str): The action to take. Must be &quot;add&quot;, &quot;edit&quot;, &quot;remove&quot;</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a><span class="sd">            title (str, optional): The dispatch title when adding or editing.</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a><span class="sd">            text (str, optional): The dispatch text when adding or editing.</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a><span class="sd">            category: (int, optional), The category ID when adding or editing.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a><span class="sd">            subcategory (int, optional): The subcategory ID when adding or editing.</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="sd">            dispatchid (int, optional): The dispatch ID when editing or removing.</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="sd">        Returns:</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>        <span class="c1"># TODO: maybe consider splitting these three functions?</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>        <span class="c1"># TODO: maybe create enums for category and subcategory</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="s2">&quot;remove&quot;</span><span class="p">}:</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;action must be &#39;add&#39;, &#39;edit&#39;, or &#39;remove&#39;&quot;</span><span class="p">)</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="o">!=</span> <span class="s2">&quot;remove&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">({</span><span class="n">title</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">subcategory</span><span class="p">}):</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify title, text, category, and subcategory&quot;</span><span class="p">)</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="o">!=</span> <span class="s2">&quot;add&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dispatchid</span><span class="p">:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify a dispatch id&quot;</span><span class="p">)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dispatch&quot;</span><span class="p">:</span> <span class="n">action</span><span class="p">}</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>        <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>        <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a>        <span class="k">if</span> <span class="n">subcategory</span><span class="p">:</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;subcategory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subcategory</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>        <span class="k">if</span> <span class="n">dispatchid</span><span class="p">:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;dispatchid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dispatchid</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>            <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;dispatch&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="o">=</span><span class="n">constant_rate_limit</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>        <span class="p">)</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>    <span class="k">def</span> <span class="nf">api_rmb</span><span class="p">(</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>        <span class="n">region</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Post a message on the regional message board via the API.</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a><span class="sd">        Args:</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a><span class="sd">            region (str): the region to post the message in.</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a><span class="sd">            text (str): the text to post.</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a><span class="sd">        Returns:</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">}</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>            <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;rmbpost&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="o">=</span><span class="n">constant_rate_limit</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>        <span class="p">)</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>    <span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Logs in to the nationstates site.</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">        Args:</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a><span class="sd">            nation (str): Nation name</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="sd">            password (str): Nation password</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="sd">        Returns:</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a><span class="sd">            bool: True if login was successful, False otherwise</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logging in to </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/page=display_region/region=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth_region</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>        <span class="c1"># shoutouts to roavin for telling me i had to have page=display_region in the url so it&#39;d work with a userclick parameter</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>            <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="s2">&quot;century&quot;</span><span class="p">,</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>            <span class="s2">&quot;logging_in&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>            <span class="s2">&quot;submit&quot;</span><span class="p">:</span> <span class="s2">&quot;Login&quot;</span><span class="p">,</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>        <span class="p">}</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>        <span class="c1"># checks if the body tag has your nation name in it; if it does, you&#39;re logged in</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;data-nname&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)}):</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nation</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>    <span class="k">def</span> <span class="nf">change_nation_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the nation flag to the given image.</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a><span class="sd">        Args:</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a><span class="sd">            flag_filename (str): Filename of the flag to change to</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="sd">        Returns:</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="sd">            bool: True if the flag was changed, False otherwise</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changing flag on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>        <span class="c1"># THIS WAS SO FUCKING FRUSTRATING BUT IT WORKS NOW AND IM NEVER TOUCHING THIS BULLSHIT UNLESS NS BREAKS IT AGAIN</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/upload.cgi&quot;</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>            <span class="s2">&quot;nationname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="p">,</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>        <span class="p">}</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>            <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>                <span class="n">flag_filename</span><span class="p">,</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>                <span class="nb">open</span><span class="p">(</span><span class="n">flag_filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">),</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>                <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">flag_filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>            <span class="p">)</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>        <span class="p">}</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>        <span class="k">if</span> <span class="s2">&quot;page=settings&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]:</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="k">elif</span> <span class="s2">&quot;Just a moment...&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>                <span class="s2">&quot;Cloudflare blocked you idiot get fucked have fun with that like I had to lmaoooooooooo&quot;</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="p">)</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>    <span class="k">def</span> <span class="nf">change_nation_settings</span><span class="p">(</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>        <span class="n">email</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>        <span class="n">pretitle</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>        <span class="n">slogan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>        <span class="n">currency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a>        <span class="n">animal</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>        <span class="n">demonym_noun</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a>        <span class="n">demonym_adjective</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>        <span class="n">demonym_plural</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>        <span class="n">new_password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a logged in session, changes customizable fields and settings of the logged in nation.</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="sd">        Variables must be explicitly named in the call to the function, e.g. &quot;session.change_nation_settings(pretitle=&#39;Join Lily&#39;, currency=&#39;Join Lily&#39;)&quot;</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a><span class="sd">        Args:</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a><span class="sd">            email (str, optional): New email for WA apps.</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="sd">            pretitle (str, optional): New pretitle of the nation. Max length of 28. Nation must have minimum population of 250 million.</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="sd">            slogan (str, optional): New Slogan/Motto of the nation. Max length of 55.</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a><span class="sd">            currency (str, optional): New currency of the nation. Max length of 40.</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="sd">            animal (str, optional): New national animal of the nation. Max length of 40.</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">            demonym_noun (str, optional): Noun the nation will refer to its citizens as. Max length of 44.</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="sd">            demonym_adjective (str, optional): Adjective the nation will refer to its citizens as. Max length of 44.</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">            demonym_plural (str, optional): Plural form of &quot;demonym_noun&quot;. Max length of 44.</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">            new_password (str, optional): New password to assign to the nation.</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a><span class="sd">        Returns:</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">            bool: True if changes were successful, False otherwise.</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changing settings on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=settings&quot;</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pretitle</span><span class="p">,</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>            <span class="s2">&quot;slogan&quot;</span><span class="p">:</span> <span class="n">slogan</span><span class="p">,</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>            <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="n">currency</span><span class="p">,</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>            <span class="s2">&quot;animal&quot;</span><span class="p">:</span> <span class="n">animal</span><span class="p">,</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>            <span class="s2">&quot;demonym2&quot;</span><span class="p">:</span> <span class="n">demonym_noun</span><span class="p">,</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>            <span class="s2">&quot;demonym&quot;</span><span class="p">:</span> <span class="n">demonym_adjective</span><span class="p">,</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>            <span class="s2">&quot;demonym2pl&quot;</span><span class="p">:</span> <span class="n">demonym_plural</span><span class="p">,</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>            <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="n">email</span><span class="p">,</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">new_password</span><span class="p">,</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>            <span class="s2">&quot;confirm_password&quot;</span><span class="p">:</span> <span class="n">new_password</span><span class="p">,</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>            <span class="s2">&quot;update&quot;</span><span class="p">:</span> <span class="s2">&quot; Update &quot;</span><span class="p">,</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>        <span class="p">}</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>        <span class="c1"># remove keys that have empty values</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">}</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>        <span class="c1"># make sure everything is following the proper length limits and only contains acceptable characters</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_fields</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>        <span class="k">return</span> <span class="s2">&quot;Your settings have been successfully updated.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>    <span class="k">def</span> <span class="nf">move_to_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Moves the nation to the given region.</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">        Args:</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a><span class="sd">            region (str): Region to move to</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">            password (str, optional): Region password, if the region is passworded</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="sd">        Returns:</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">            bool: True if the move was successful, False otherwise</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=change_region&quot;</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;region_name&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span> <span class="s2">&quot;move_region&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a>        <span class="k">if</span> <span class="s2">&quot;Success!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>    <span class="k">def</span> <span class="nf">vote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pollid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Votes on a poll.</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="sd">        Args:</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">            pollid (str): ID of the poll to vote on, e.g. &quot;199747&quot;</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">            option (str): Option to vote for (starts at 0)</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">        Returns:</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">            bool: True if the vote was successful, False otherwise</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Voting on poll </span><span class="si">{</span><span class="n">pollid</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=poll/p=</span><span class="si">{</span><span class="n">pollid</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;pollid&quot;</span><span class="p">:</span> <span class="n">pollid</span><span class="p">,</span> <span class="s2">&quot;q1&quot;</span><span class="p">:</span> <span class="n">option</span><span class="p">,</span> <span class="s2">&quot;poll_submit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>        <span class="k">return</span> <span class="s2">&quot;Your vote has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>    <span class="c1"># below are functions that are related to the WA</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>    <span class="k">def</span> <span class="nf">join_wa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Joins the WA with the given nation.</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="sd">        Args:</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a><span class="sd">            nation (str): Nation to join the WA with</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">            app_id (str): ID of the WA application to use</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a><span class="sd">        Returns:</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">            bool: True if the join was successful, False otherwise</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joining WA with </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/join_un.cgi&quot;</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span> <span class="s2">&quot;appid&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="o">.</span><span class="n">strip</span><span class="p">()}</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>        <span class="k">if</span> <span class="s2">&quot;?welcome=1&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]:</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>            <span class="c1"># since we&#39;re just getting thrown into a cgi script, we&#39;ll have to manually grab authentication values</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>    <span class="k">def</span> <span class="nf">resign_wa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Resigns from the WA.</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a><span class="sd">        Returns:</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">            bool: True if the resignation was successful, False otherwise</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Resigning from WA&quot;</span><span class="p">)</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=UN_status&quot;</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;leave_UN&quot;</span><span class="p">,</span> <span class="s2">&quot;submit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="k">return</span> <span class="s2">&quot;From this moment forward, your nation is on its own.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>    <span class="k">def</span> <span class="nf">apply_wa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reapply</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies to the WA.</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="sd">        Args:</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a><span class="sd">            reapply (bool, optional): Whether to reapply if you&#39;ve been sent an application that&#39;s still valid. Defaults to True.</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">        Returns:</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a><span class="sd">            bool: True if the application was successful, False otherwise</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying to WA with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=UN_status&quot;</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;join_UN&quot;</span><span class="p">}</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a>        <span class="k">if</span> <span class="n">reapply</span><span class="p">:</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;resend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;submit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>            <span class="s2">&quot;Your application to join the World Assembly has been received!&quot;</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>            <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>        <span class="p">)</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>    <span class="k">def</span> <span class="nf">endorse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endorse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Endorses the given nation.</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="sd">        Args:</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">            nation (str): Nation to endorse</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a><span class="sd">            endorse (bool, optional): True=endorse, False=unendorse. Defaults to True.</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">        Returns:</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a><span class="sd">            bool: True if the endorsement was successful, False otherwise</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="s1">&#39;Unendorsing&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Endorsing&#39;</span><span class="p">)[</span><span class="n">endorse</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>        <span class="p">)</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/endorse.cgi&quot;</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;endorse&quot;</span> <span class="k">if</span> <span class="n">endorse</span> <span class="k">else</span> <span class="s2">&quot;unendorse&quot;</span><span class="p">,</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>        <span class="p">}</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;nation=</span><span class="si">{</span><span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>    <span class="k">def</span> <span class="nf">clear_dossier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clears a logged in nation&#39;s dossier.</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">        Returns:</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">            bool: Whether it was successful or not</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Clearing dossier on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=dossier&quot;</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;clear_dossier&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>        <span class="k">return</span> <span class="s2">&quot;Dossier cleared of nations.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>    <span class="k">def</span> <span class="nf">add_to_dossier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds nations to the logged in nation&#39;s dossier.</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">        Args:</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">            nations (list[str] | str): List of nations to add, or a single nation</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">        Returns:</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">            bool: Whether it was successful or not</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">nations</span><span class="si">}</span><span class="s2"> to dossier on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/dossier.cgi&quot;</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>            <span class="s2">&quot;currentnation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="p">),</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>            <span class="s2">&quot;action_append&quot;</span><span class="p">:</span> <span class="s2">&quot;Upload Nation Dossier File&quot;</span><span class="p">,</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>        <span class="p">}</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>            <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>                <span class="s2">&quot;dossier.txt&quot;</span><span class="p">,</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nations</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">nations</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">nations</span><span class="p">,</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>                <span class="s2">&quot;text/plain&quot;</span><span class="p">,</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>            <span class="p">),</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>        <span class="p">}</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>        <span class="k">return</span> <span class="s2">&quot;appended=&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>    <span class="k">def</span> <span class="nf">wa_vote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">council</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">vote</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Votes on the current WA resolution.</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">        Args:</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="sd">            council (str): Must be &quot;ga&quot; for general assembly, &quot;sc&quot; for security council.</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="sd">            vote (str): Must be &quot;for&quot; or &quot;against&quot;.</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a><span class="sd">        Returns:</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a><span class="sd">            bool: Whether the vote was successful or not</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>            <span class="sa">f</span><span class="s2">&quot;Voting </span><span class="si">{</span><span class="n">vote</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">council</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> resolution with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>        <span class="p">)</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="k">if</span> <span class="n">council</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;ga&quot;</span><span class="p">,</span> <span class="s2">&quot;sc&quot;</span><span class="p">}:</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;council must be &#39;ga&#39; or &#39;sc&#39;&quot;</span><span class="p">)</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>        <span class="k">if</span> <span class="n">vote</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;for&quot;</span><span class="p">,</span> <span class="s2">&quot;against&quot;</span><span class="p">}:</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;vote must be &#39;for&#39; or &#39;against&#39;&quot;</span><span class="p">)</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Voting on WA resolution&quot;</span><span class="p">)</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=</span><span class="si">{</span><span class="n">council</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>            <span class="s2">&quot;vote&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Vote </span><span class="si">{</span><span class="n">vote</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>        <span class="p">}</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>        <span class="k">return</span> <span class="s2">&quot;Your vote has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>    <span class="k">def</span> <span class="nf">refound_nation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Refounds a nation.</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">        Args:</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">            nation (str): Name of the nation to refound</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">            password (str): Password to the nation</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">        Returns:</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="sd">            bool: Whether the nation was successfully refounded or not</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/&quot;</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>            <span class="s2">&quot;logging_in&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>            <span class="s2">&quot;restore_password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>            <span class="s2">&quot;restore_nation&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">nation</span><span class="p">,</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="p">}</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">302</span><span class="p">:</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nation</span> <span class="o">=</span> <span class="n">nation</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>    <span class="c1"># methods for region control</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>    <span class="k">def</span> <span class="nf">create_region</span><span class="p">(</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>        <span class="n">region_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>        <span class="n">wfe</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>        <span class="n">frontier</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>        <span class="n">executive_delegacy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a new region.</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">        Args:</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a><span class="sd">            region_name (str): Name of the region</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="sd">            wfe (str): WFE of the region</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="sd">            password (str, optional): Password to the region. Defaults to &quot;&quot;.</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">            frontier (bool, optional): Whether or not the region is a frontier. Defaults to False.</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">            executive_delegacy (bool, optional): Whether or not the region has an executive WA delegacy. Defaults to False. Ignored if frontier is True.</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="sd">        Returns:</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">            bool: Whether the region was successfully created or not</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating new region </span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=create_region&quot;</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>            <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;create_region&quot;</span><span class="p">,</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a>            <span class="s2">&quot;region_name&quot;</span><span class="p">:</span> <span class="n">region_name</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>            <span class="s2">&quot;desc&quot;</span><span class="p">:</span> <span class="n">wfe</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>            <span class="s2">&quot;create_region&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>        <span class="p">}</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>            <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;pw&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;rpassword&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">}</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>        <span class="k">if</span> <span class="n">frontier</span><span class="p">:</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>            <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;is_frontier&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>        <span class="k">elif</span> <span class="n">executive_delegacy</span><span class="p">:</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>            <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;delegate_control&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>        <span class="k">return</span> <span class="s2">&quot;Success! You have founded &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>    <span class="k">def</span> <span class="nf">upload_to_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Uploads a file to the current region.</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">        Args:</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">            type (str): Type of file to upload. Must be &quot;flag&quot; or &quot;banner&quot;.</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a><span class="sd">            filename (str): Name of the file to upload. e.g. &quot;myflag.png&quot;</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">        Raises:</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">            ValueError: If type is not &quot;flag&quot; or &quot;banner&quot;</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">        Returns:</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">            str: Empty string if the upload failed, otherwise the ID of the uploaded file</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploading </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="s2">&quot;banner&quot;</span><span class="p">}:</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type must be &#39;flag&#39; or &#39;banner&#39;&quot;</span><span class="p">)</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/upload.cgi&quot;</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>            <span class="s2">&quot;uploadtype&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;r</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>            <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;region_control&quot;</span><span class="p">,</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>            <span class="s2">&quot;expect&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>        <span class="p">}</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>            <span class="sa">f</span><span class="s2">&quot;file_upload_r</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>                <span class="n">filename</span><span class="p">,</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>                <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">),</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>                <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>            <span class="p">)</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="p">}</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">else</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>    <span class="k">def</span> <span class="nf">set_flag_and_banner</span><span class="p">(</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">flag_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">banner_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">flag_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the uploaded flag and/or banner for the current region.</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">        Args:</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">            flag_id (str, optional): ID of the flag, uploaded with upload_to_region(). Defaults to &quot;&quot;.</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="sd">            banner_id (str, optional): ID of the banner, uploaded with upload_to_region(). Defaults to &quot;&quot;.</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="sd">            flagmode (str, optional): Must be &quot;flag&quot; which will have a shadow, or &quot;logo&quot; which will not, or &quot;&quot; to not change it. Defaults to &quot;&quot;.</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a><span class="sd">        Raises:</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a><span class="sd">            ValueError: If flagmode is not &quot;flag&quot;, &quot;logo&quot;, or &quot;&quot;</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">        Returns:</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">            bool: Whether the change was successful or not</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>        <span class="k">if</span> <span class="n">flag_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="s2">&quot;logo&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">}:</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;flagmode must be &#39;flag&#39;, &#39;logo&#39;, or &#39;&#39;&quot;</span><span class="p">)</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting flag and banner for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>            <span class="s2">&quot;newflag&quot;</span><span class="p">:</span> <span class="n">flag_id</span><span class="p">,</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>            <span class="s2">&quot;newbanner&quot;</span><span class="p">:</span> <span class="n">banner_id</span><span class="p">,</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>            <span class="s2">&quot;saveflagandbannerchanges&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>            <span class="s2">&quot;flagmode&quot;</span><span class="p">:</span> <span class="n">flag_mode</span><span class="p">,</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>        <span class="p">}</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>        <span class="c1"># remove entries with empty values</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">}</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>        <span class="k">return</span> <span class="s2">&quot;Regional banner/flag updated!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>    <span class="k">def</span> <span class="nf">change_wfe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wfe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the WFE of the current region.</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">        Args:</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">            wfe (str, optional): World Factbook Entry to change to. Defaults to the oldest WFE the region has, for detags.</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">        Returns:</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">            bool: True if successful, False otherwise</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changing WFE for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">wfe</span><span class="p">:</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>            <span class="n">wfe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_detag_wfe</span><span class="p">()</span>  <span class="c1"># haku im sorry for hitting your site so much</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">wfe</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;iso-8859-1&quot;</span><span class="p">,</span> <span class="s2">&quot;xmlcharrefreplace&quot;</span><span class="p">)</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>            <span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>            <span class="o">.</span><span class="n">strip</span><span class="p">(),</span>  <span class="c1"># lol.</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>            <span class="s2">&quot;setwfebutton&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>        <span class="p">}</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>        <span class="k">return</span> <span class="s2">&quot;World Factbook Entry updated!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>    <span class="c1"># methods for embassies</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>    <span class="k">def</span> <span class="nf">request_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Requests an embassy with a region.</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="sd">        Args:</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">            target (str): The region to request the embassy with.</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">        Returns:</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">            bool: Whether the request was successfully sent or not</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requesting embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>            <span class="s2">&quot;requestembassyregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>            <span class="s2">&quot;requestembassy&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>  <span class="c1"># it&#39;s silly that requesting needs this but not closing, aborting, or cancelling</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>        <span class="p">}</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>        <span class="k">return</span> <span class="s2">&quot;Your proposal for the construction of embassies with&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>    <span class="k">def</span> <span class="nf">close_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Closes an embassy with a region.</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a><span class="sd">        Args:</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a><span class="sd">            target (str): The region with which to close the embassy.</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a><span class="sd">        Returns:</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a><span class="sd">            bool: Whether the embassy was successfully closed or not</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Closing embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cancelembassyregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="k">return</span> <span class="s2">&quot; has been scheduled for demolition.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>    <span class="k">def</span> <span class="nf">abort_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Aborts an embassy with a region.</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a><span class="sd">        Args:</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a><span class="sd">            target (str): The region with which to abort the embassy.</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a><span class="sd">        Returns:</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a><span class="sd">            bool: Whether the embassy was successfully aborted or not</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Aborting embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abortembassyregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>        <span class="k">return</span> <span class="s2">&quot; aborted.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>    <span class="k">def</span> <span class="nf">cancel_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cancels an embassy with a region.</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">        Args:</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a><span class="sd">            target (str): The region with which to cancel the embassy.</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a><span class="sd">        Returns:</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="sd">            bool: Whether the embassy was successfully cancelled or not</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cancelling embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cancelembassyclosureregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>        <span class="k">return</span> <span class="s2">&quot;Embassy closure order cancelled.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>    <span class="c1"># end methods for embassies</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>    <span class="k">def</span> <span class="nf">tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds or removes a tag to the current region.</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">        Args:</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">            action (str): The action to take. Must be &quot;add&quot; or &quot;remove&quot;.</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">            tag (str): The tag to add or remove.</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">        Raises:</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">            ValueError: If action is not &quot;add&quot; or &quot;remove&quot;, or if tag is not a valid tag.</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="sd">        Returns:</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a><span class="sd">            bool: Whether the tag was successfully added or removed</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;remove&quot;</span><span class="p">}:</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;action must be &#39;add&#39; or &#39;remove&#39;&quot;</span><span class="p">)</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="k">if</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid</span><span class="o">.</span><span class="n">REGION_TAGS</span><span class="p">:</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2"> is not a valid tag&quot;</span><span class="p">)</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">action</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">ing tag </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">_tag&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">tag</span><span class="p">),</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>            <span class="s2">&quot;updatetagsbutton&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>        <span class="p">}</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>        <span class="k">return</span> <span class="s2">&quot;Region Tags updated!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>    <span class="k">def</span> <span class="nf">eject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Ejects a nation from the current region. Note that a 1 second delay is required before ejecting another nation.</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a><span class="sd">        Args:</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a><span class="sd">            nation (str): The nation to eject.</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a><span class="sd">        Returns:</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a><span class="sd">            bool: Whether the nation was successfully ejected or not</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ejecting </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation_name&quot;</span><span class="p">:</span> <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;eject&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>        <span class="k">return</span> <span class="s2">&quot;has been ejected from &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>    <span class="k">def</span> <span class="nf">banject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Bans a nation from the current region. Note that a 1 second delay is required before banjecting another nation.</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a><span class="sd">        Args:</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a><span class="sd">            nation (str): The nation to banject.</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a><span class="sd">        Returns:</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a><span class="sd">            bool: Whether the nation was successfully banjected or not</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Banjecting </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation_name&quot;</span><span class="p">:</span> <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;ban&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>        <span class="k">return</span> <span class="s2">&quot;has been ejected and banned from &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>    <span class="c1"># end methods for region control</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>    <span class="k">def</span> <span class="nf">junk_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Junks a card from the current nation&#39;s deck.</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="sd">        Args:</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">            id (str): ID of the card to junk</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">            season (str): Season of the card to junk</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="sd">        Returns:</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">            bool: Whether the card was successfully junked or not</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Junking card </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2"> from season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;ajax3&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;junkcard&quot;</span><span class="p">,</span> <span class="s2">&quot;card&quot;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">:</span> <span class="n">season</span><span class="p">}</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>        <span class="k">return</span> <span class="s2">&quot;Your Deck&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>    <span class="k">def</span> <span class="nf">open_pack</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Opens a card pack.</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">        Returns:</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a><span class="sd">            bool: Whether the bid was successfully removed or not</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Opening trading card pack&quot;</span><span class="p">)</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;open_loot_box&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>        <span class="k">return</span> <span class="s2">&quot;Tap cards to reveal...&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Puts an ask at price on a card in a season</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="sd">        Args:</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a><span class="sd">            price (str): Price to ask</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a><span class="sd">        Returns:</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a><span class="sd">            bool: Whether the ask was successfully lodged or not</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Asking for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;auction_ask&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;auction_submit&quot;</span><span class="p">:</span> <span class="s2">&quot;ask&quot;</span><span class="p">}</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Your ask of </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>    <span class="k">def</span> <span class="nf">bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Places a bid on a card in a season</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">        Args:</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">            price (str): Amount of bank to bid</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">        Returns:</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">            bool: Whether the bid was successfully lodged or not</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Putting a bid for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;auction_bid&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;auction_submit&quot;</span><span class="p">:</span> <span class="s2">&quot;bid&quot;</span><span class="p">}</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Your bid of </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>    <span class="k">def</span> <span class="nf">remove_ask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes an ask on card_id in season at price</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">        Args:</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">            price (str): Price of the ask to remove</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">        Returns:</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">            bool: Whether the ask was successfully removed or not</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;removing an ask for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;new_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;remove_ask_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">}</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Removed your ask for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>    <span class="k">def</span> <span class="nf">remove_bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes a bid on a card</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        Args:</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a><span class="sd">            price (str): Price of the bid to remove</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a><span class="sd">        Returns:</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a><span class="sd">            bool: Whether the bid was successfully removed or not</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing a bid for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;new_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;remove_bid_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">}</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Removed your bid for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>    <span class="k">def</span> <span class="nf">expand_deck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Upgrades deck capacity</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a><span class="sd">        Args:</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a><span class="sd">            price (str): Price of the Upgrade</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a><span class="sd">        Returns:</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a><span class="sd">            bool: Whether the upgrade was successfully removed or not</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upgrading your deck at a cost of </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;embiggen_deck&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">}</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>        <span class="k">return</span> <span class="s2">&quot;Increased deck capacity from&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>    <span class="k">def</span> <span class="nf">add_to_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_season</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collection_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a card to collection_id</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">        Args:</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="sd">            card_id (str): Card ID</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">            card_season (str): Cards season</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a><span class="sd">            collection_id (str): The ID of the collection you want to add to</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">        Returns:</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a><span class="sd">            bool: Whether the adding was successfully added or not</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> of season </span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>            <span class="s2">&quot;manage_collections&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>            <span class="s2">&quot;modify_card_in_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>            <span class="sa">f</span><span class="s2">&quot;collection_</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>            <span class="s2">&quot;save_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>        <span class="p">}</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>        <span class="k">return</span> <span class="s2">&quot;Updated collections.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>    <span class="k">def</span> <span class="nf">remove_from_collection</span><span class="p">(</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_season</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collection_id</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>    <span class="p">):</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes a card from collection_id</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a><span class="sd">        Args:</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a><span class="sd">            card_id (str): Card ID</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a><span class="sd">            card_season (str): Cards season</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a><span class="sd">            collection_id (str): The ID of the collection you want to remove from</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a><span class="sd">        Returns:</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a><span class="sd">            bool: Whether the removal was successfully added or not</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>            <span class="sa">f</span><span class="s2">&quot;Removing </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> of season </span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>        <span class="p">)</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>            <span class="s2">&quot;manage_collections&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>            <span class="s2">&quot;modify_card_in_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>            <span class="sa">f</span><span class="s2">&quot;collection_</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>            <span class="s2">&quot;save_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>        <span class="p">}</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>        <span class="k">return</span> <span class="s2">&quot;Updated collections.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>    <span class="k">def</span> <span class="nf">create_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a collection named name</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a><span class="sd">        Args:</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a><span class="sd">            name (str): The name of the collection you want to create</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a><span class="sd">        Returns:</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a><span class="sd">            bool: Whether the creating was successfully added or not</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> collection&quot;</span><span class="p">)</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;edit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;collection_name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;save_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>        <span class="k">return</span> <span class="s2">&quot;Created collection!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>    <span class="k">def</span> <span class="nf">delete_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes a collection named name</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a><span class="sd">        Args:</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">            name (str): The name of the collection you want to delete</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a><span class="sd">        Returns:</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a><span class="sd">            bool: Whether the deleting was successfully added or not</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleting </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> collection&quot;</span><span class="p">)</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;edit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;collection_name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;delete_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>        <span class="k">return</span> <span class="s2">&quot;Created collection!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>    <span class="k">def</span> <span class="nf">can_nation_be_founded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if a nation can be founded</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a><span class="sd">        Args:</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a><span class="sd">            name (str): The name of the nation you want to check</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a><span class="sd">        Returns:</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a><span class="sd">            bool: Whether the nation can be founded or not</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> in boneyard&quot;</span><span class="p">)</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=boneyard&quot;</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;submit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>            <span class="s2">&quot;Available! This name may be used to found a new nation.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>        <span class="p">)</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>    <span class="k">def</span> <span class="nf">join_nday_faction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Joins a faction in the N-Day event</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a><span class="sd">        Args:</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a><span class="sd">            id (str): The ID of the faction you want to join</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a><span class="sd">        Returns:</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">            bool: Whether the joining was successful or not</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joining faction </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>            <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=faction/fid=</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>        <span class="p">)</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;join_faction&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>        <span class="k">return</span> <span class="s2">&quot; has joined &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>    <span class="k">def</span> <span class="nf">leave_nday_faction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Leaves a faction in the N-Day event</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">        Args:</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">            id (str): The ID of the faction you want to leave</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">        Returns:</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">            bool: Whether the leaving was successful or not</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Leaving faction </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>            <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=faction/fid=</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>        <span class="p">)</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;leave_faction&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>        <span class="k">return</span> <span class="s2">&quot; has left &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;this is a module/library, not a script&quot;</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="canonicalize">
                            <input id="canonicalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">canonicalize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">string</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="canonicalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#canonicalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="canonicalize-34"><a href="#canonicalize-34"><span class="linenos">34</span></a><span class="k">def</span> <span class="nf">canonicalize</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="canonicalize-35"><a href="#canonicalize-35"><span class="linenos">35</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a string to its canonical form used by the nationstates api.</span>
</span><span id="canonicalize-36"><a href="#canonicalize-36"><span class="linenos">36</span></a>
</span><span id="canonicalize-37"><a href="#canonicalize-37"><span class="linenos">37</span></a><span class="sd">    Args:</span>
</span><span id="canonicalize-38"><a href="#canonicalize-38"><span class="linenos">38</span></a><span class="sd">        string (str): The string to convert</span>
</span><span id="canonicalize-39"><a href="#canonicalize-39"><span class="linenos">39</span></a>
</span><span id="canonicalize-40"><a href="#canonicalize-40"><span class="linenos">40</span></a><span class="sd">    Returns:</span>
</span><span id="canonicalize-41"><a href="#canonicalize-41"><span class="linenos">41</span></a><span class="sd">        str: The canonical form of the string</span>
</span><span id="canonicalize-42"><a href="#canonicalize-42"><span class="linenos">42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="canonicalize-43"><a href="#canonicalize-43"><span class="linenos">43</span></a>    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Converts a string to its canonical form used by the nationstates api.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>string (str):</strong>  The string to convert</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>str: The canonical form of the string</p>
</blockquote>
</div>


                </section>
                <section id="uncanonicalize">
                            <input id="uncanonicalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">uncanonicalize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">string</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="uncanonicalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#uncanonicalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="uncanonicalize-46"><a href="#uncanonicalize-46"><span class="linenos">46</span></a><span class="k">def</span> <span class="nf">uncanonicalize</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="uncanonicalize-47"><a href="#uncanonicalize-47"><span class="linenos">47</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a string into a user friendly form from it&#39;s canonical nationstates api form.</span>
</span><span id="uncanonicalize-48"><a href="#uncanonicalize-48"><span class="linenos">48</span></a>
</span><span id="uncanonicalize-49"><a href="#uncanonicalize-49"><span class="linenos">49</span></a><span class="sd">    Args:</span>
</span><span id="uncanonicalize-50"><a href="#uncanonicalize-50"><span class="linenos">50</span></a><span class="sd">        string (str): The string to convert</span>
</span><span id="uncanonicalize-51"><a href="#uncanonicalize-51"><span class="linenos">51</span></a>
</span><span id="uncanonicalize-52"><a href="#uncanonicalize-52"><span class="linenos">52</span></a><span class="sd">    Returns:</span>
</span><span id="uncanonicalize-53"><a href="#uncanonicalize-53"><span class="linenos">53</span></a><span class="sd">        str: The uncanonicale form of the string</span>
</span><span id="uncanonicalize-54"><a href="#uncanonicalize-54"><span class="linenos">54</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="uncanonicalize-55"><a href="#uncanonicalize-55"><span class="linenos">55</span></a>    <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Converts a string into a user friendly form from it's canonical nationstates api form.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>string (str):</strong>  The string to convert</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>str: The uncanonicale form of the string</p>
</blockquote>
</div>


                </section>
                <section id="NSSession">
                            <input id="NSSession-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">NSSession</span>:

                <label class="view-source-button" for="NSSession-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession-58"><a href="#NSSession-58"><span class="linenos">  58</span></a><span class="k">class</span> <span class="nc">NSSession</span><span class="p">:</span>
</span><span id="NSSession-59"><a href="#NSSession-59"><span class="linenos">  59</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="NSSession-60"><a href="#NSSession-60"><span class="linenos">  60</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-61"><a href="#NSSession-61"><span class="linenos">  61</span></a>        <span class="n">script_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-62"><a href="#NSSession-62"><span class="linenos">  62</span></a>        <span class="n">script_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-63"><a href="#NSSession-63"><span class="linenos">  63</span></a>        <span class="n">script_author</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-64"><a href="#NSSession-64"><span class="linenos">  64</span></a>        <span class="n">script_user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-65"><a href="#NSSession-65"><span class="linenos">  65</span></a>        <span class="n">keybind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;space&quot;</span><span class="p">,</span>
</span><span id="NSSession-66"><a href="#NSSession-66"><span class="linenos">  66</span></a>        <span class="n">link_to_src</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-67"><a href="#NSSession-67"><span class="linenos">  67</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="NSSession-68"><a href="#NSSession-68"><span class="linenos">  68</span></a>    <span class="p">):</span>
</span><span id="NSSession-69"><a href="#NSSession-69"><span class="linenos">  69</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A wrapper around httpx that abstracts away</span>
</span><span id="NSSession-70"><a href="#NSSession-70"><span class="linenos">  70</span></a><span class="sd">        interacting with the HTML nationstates.net site.</span>
</span><span id="NSSession-71"><a href="#NSSession-71"><span class="linenos">  71</span></a><span class="sd">        Focused on legality, correctness, and ease of use.</span>
</span><span id="NSSession-72"><a href="#NSSession-72"><span class="linenos">  72</span></a>
</span><span id="NSSession-73"><a href="#NSSession-73"><span class="linenos">  73</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-74"><a href="#NSSession-74"><span class="linenos">  74</span></a><span class="sd">            script_name (str): Name of your script</span>
</span><span id="NSSession-75"><a href="#NSSession-75"><span class="linenos">  75</span></a><span class="sd">            script_version (str): Version number of your script</span>
</span><span id="NSSession-76"><a href="#NSSession-76"><span class="linenos">  76</span></a><span class="sd">            script_author (str): Author of your script</span>
</span><span id="NSSession-77"><a href="#NSSession-77"><span class="linenos">  77</span></a><span class="sd">            script_user (str): Nation name of the user running your script</span>
</span><span id="NSSession-78"><a href="#NSSession-78"><span class="linenos">  78</span></a><span class="sd">            keybind (str, optional): Keybind to count as a user click. Defaults to &quot;space&quot;.</span>
</span><span id="NSSession-79"><a href="#NSSession-79"><span class="linenos">  79</span></a><span class="sd">            link_to_src (str, optional): Link to the source code of your script.</span>
</span><span id="NSSession-80"><a href="#NSSession-80"><span class="linenos">  80</span></a><span class="sd">            logger (logging.Logger | None, optional): Logger to use. Will create its own with name &quot;NSDotPy&quot; if none is specified. Defaults to None.</span>
</span><span id="NSSession-81"><a href="#NSSession-81"><span class="linenos">  81</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-82"><a href="#NSSession-82"><span class="linenos">  82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">=</span> <span class="s2">&quot;2.3.0&quot;</span>
</span><span id="NSSession-83"><a href="#NSSession-83"><span class="linenos">  83</span></a>        <span class="c1"># Initialize logger</span>
</span><span id="NSSession-84"><a href="#NSSession-84"><span class="linenos">  84</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="p">:</span>
</span><span id="NSSession-85"><a href="#NSSession-85"><span class="linenos">  85</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_init_logger</span><span class="p">()</span>
</span><span id="NSSession-86"><a href="#NSSession-86"><span class="linenos">  86</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NSSession-87"><a href="#NSSession-87"><span class="linenos">  87</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
</span><span id="NSSession-88"><a href="#NSSession-88"><span class="linenos">  88</span></a>        <span class="c1"># Create a new httpx session</span>
</span><span id="NSSession-89"><a href="#NSSession-89"><span class="linenos">  89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_session</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span>
</span><span id="NSSession-90"><a href="#NSSession-90"><span class="linenos">  90</span></a>            <span class="n">http2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span>
</span><span id="NSSession-91"><a href="#NSSession-91"><span class="linenos">  91</span></a>        <span class="p">)</span>  <span class="c1"># ns can b slow, 30 seconds is hopefully a good sweet spot</span>
</span><span id="NSSession-92"><a href="#NSSession-92"><span class="linenos">  92</span></a>        <span class="c1"># Set the user agent to the script name, version, author, and user as recommended in the script rules thread:</span>
</span><span id="NSSession-93"><a href="#NSSession-93"><span class="linenos">  93</span></a>        <span class="c1"># https://forum.nationstates.net/viewtopic.php?p=16394966&amp;sid=be37623536dbc8cee42d8d043945b887#p16394966</span>
</span><span id="NSSession-94"><a href="#NSSession-94"><span class="linenos">  94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="NSSession-95"><a href="#NSSession-95"><span class="linenos">  95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_user_agent</span><span class="p">(</span>
</span><span id="NSSession-96"><a href="#NSSession-96"><span class="linenos">  96</span></a>            <span class="n">script_name</span><span class="p">,</span> <span class="n">script_version</span><span class="p">,</span> <span class="n">script_author</span><span class="p">,</span> <span class="n">script_user</span><span class="p">,</span> <span class="n">link_to_src</span>
</span><span id="NSSession-97"><a href="#NSSession-97"><span class="linenos">  97</span></a>        <span class="p">)</span>
</span><span id="NSSession-98"><a href="#NSSession-98"><span class="linenos">  98</span></a>        <span class="c1"># Initialize nationstates specific stuff</span>
</span><span id="NSSession-99"><a href="#NSSession-99"><span class="linenos">  99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_auth_region</span> <span class="o">=</span> <span class="s2">&quot;rwby&quot;</span>
</span><span id="NSSession-100"><a href="#NSSession-100"><span class="linenos"> 100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chk</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession-101"><a href="#NSSession-101"><span class="linenos"> 101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">localid</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession-102"><a href="#NSSession-102"><span class="linenos"> 102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession-103"><a href="#NSSession-103"><span class="linenos"> 103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession-104"><a href="#NSSession-104"><span class="linenos"> 104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession-105"><a href="#NSSession-105"><span class="linenos"> 105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">keybind</span> <span class="o">=</span> <span class="n">keybind</span>
</span><span id="NSSession-106"><a href="#NSSession-106"><span class="linenos"> 106</span></a>        <span class="c1"># Make sure the nations in the user agent actually exist</span>
</span><span id="NSSession-107"><a href="#NSSession-107"><span class="linenos"> 107</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_nations</span><span class="p">({</span><span class="n">script_author</span><span class="p">,</span> <span class="n">script_user</span><span class="p">}):</span>
</span><span id="NSSession-108"><a href="#NSSession-108"><span class="linenos"> 108</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="NSSession-109"><a href="#NSSession-109"><span class="linenos"> 109</span></a>                <span class="s2">&quot;One of, or both, of the nations in the user agent do not exist. Make sure you&#39;re only including the nation name in the constructor, e.g. &#39;Thorn1000&#39; instead of &#39;Devved by Thorn1000&#39;&quot;</span>
</span><span id="NSSession-110"><a href="#NSSession-110"><span class="linenos"> 110</span></a>            <span class="p">)</span>
</span><span id="NSSession-111"><a href="#NSSession-111"><span class="linenos"> 111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initialized. Keybind to continue is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">keybind</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="NSSession-112"><a href="#NSSession-112"><span class="linenos"> 112</span></a>
</span><span id="NSSession-113"><a href="#NSSession-113"><span class="linenos"> 113</span></a>    <span class="k">def</span> <span class="nf">_validate_shard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shard</span><span class="p">,</span> <span class="n">valid_shards</span><span class="p">,</span> <span class="n">api</span><span class="p">):</span>
</span><span id="NSSession-114"><a href="#NSSession-114"><span class="linenos"> 114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Helper function to validate a single shard.&quot;&quot;&quot;</span>
</span><span id="NSSession-115"><a href="#NSSession-115"><span class="linenos"> 115</span></a>        <span class="k">if</span> <span class="n">shard</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_shards</span><span class="p">:</span>
</span><span id="NSSession-116"><a href="#NSSession-116"><span class="linenos"> 116</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">shard</span><span class="si">}</span><span class="s2"> is not a valid shard for </span><span class="si">{</span><span class="n">api</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-117"><a href="#NSSession-117"><span class="linenos"> 117</span></a>
</span><span id="NSSession-118"><a href="#NSSession-118"><span class="linenos"> 118</span></a>    <span class="k">def</span> <span class="nf">_validate_shards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">api</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">shards</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="NSSession-119"><a href="#NSSession-119"><span class="linenos"> 119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Validates shards for a given API.&quot;&quot;&quot;</span>
</span><span id="NSSession-120"><a href="#NSSession-120"><span class="linenos"> 120</span></a>        <span class="n">api_to_shard_set</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-121"><a href="#NSSession-121"><span class="linenos"> 121</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">NATION_SHARDS</span>
</span><span id="NSSession-122"><a href="#NSSession-122"><span class="linenos"> 122</span></a>            <span class="o">|</span> <span class="n">valid</span><span class="o">.</span><span class="n">PRIVATE_NATION_SHARDS</span>
</span><span id="NSSession-123"><a href="#NSSession-123"><span class="linenos"> 123</span></a>            <span class="o">|</span> <span class="n">valid</span><span class="o">.</span><span class="n">PRIVATE_NATION_SHARDS</span><span class="p">,</span>
</span><span id="NSSession-124"><a href="#NSSession-124"><span class="linenos"> 124</span></a>            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">REGION_SHARDS</span><span class="p">,</span>
</span><span id="NSSession-125"><a href="#NSSession-125"><span class="linenos"> 125</span></a>            <span class="s2">&quot;world&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">WORLD_SHARDS</span><span class="p">,</span>
</span><span id="NSSession-126"><a href="#NSSession-126"><span class="linenos"> 126</span></a>            <span class="s2">&quot;wa&quot;</span><span class="p">:</span> <span class="n">valid</span><span class="o">.</span><span class="n">WA_SHARDS</span><span class="p">,</span>
</span><span id="NSSession-127"><a href="#NSSession-127"><span class="linenos"> 127</span></a>        <span class="p">}</span>
</span><span id="NSSession-128"><a href="#NSSession-128"><span class="linenos"> 128</span></a>
</span><span id="NSSession-129"><a href="#NSSession-129"><span class="linenos"> 129</span></a>        <span class="n">valid_shards</span> <span class="o">=</span> <span class="n">api_to_shard_set</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">api</span><span class="p">)</span>
</span><span id="NSSession-130"><a href="#NSSession-130"><span class="linenos"> 130</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_shards</span><span class="p">:</span>
</span><span id="NSSession-131"><a href="#NSSession-131"><span class="linenos"> 131</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid API type: </span><span class="si">{</span><span class="n">api</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-132"><a href="#NSSession-132"><span class="linenos"> 132</span></a>
</span><span id="NSSession-133"><a href="#NSSession-133"><span class="linenos"> 133</span></a>        <span class="k">for</span> <span class="n">shard</span> <span class="ow">in</span> <span class="n">shards</span><span class="p">:</span>
</span><span id="NSSession-134"><a href="#NSSession-134"><span class="linenos"> 134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_shard</span><span class="p">(</span><span class="n">shard</span><span class="p">,</span> <span class="n">valid_shards</span><span class="p">,</span> <span class="n">api</span><span class="p">)</span>
</span><span id="NSSession-135"><a href="#NSSession-135"><span class="linenos"> 135</span></a>
</span><span id="NSSession-136"><a href="#NSSession-136"><span class="linenos"> 136</span></a>    <span class="k">def</span> <span class="nf">_set_user_agent</span><span class="p">(</span>
</span><span id="NSSession-137"><a href="#NSSession-137"><span class="linenos"> 137</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-138"><a href="#NSSession-138"><span class="linenos"> 138</span></a>        <span class="n">script_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-139"><a href="#NSSession-139"><span class="linenos"> 139</span></a>        <span class="n">script_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-140"><a href="#NSSession-140"><span class="linenos"> 140</span></a>        <span class="n">script_author</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-141"><a href="#NSSession-141"><span class="linenos"> 141</span></a>        <span class="n">script_user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-142"><a href="#NSSession-142"><span class="linenos"> 142</span></a>        <span class="n">link_to_src</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-143"><a href="#NSSession-143"><span class="linenos"> 143</span></a>    <span class="p">):</span>
</span><span id="NSSession-144"><a href="#NSSession-144"><span class="linenos"> 144</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="NSSession-145"><a href="#NSSession-145"><span class="linenos"> 145</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">script_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">script_version</span><span class="si">}</span><span class="s2"> (by:</span><span class="si">{</span><span class="n">script_author</span><span class="si">}</span><span class="s2">; usedBy:</span><span class="si">{</span><span class="n">script_user</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="NSSession-146"><a href="#NSSession-146"><span class="linenos"> 146</span></a>        <span class="p">)</span>
</span><span id="NSSession-147"><a href="#NSSession-147"><span class="linenos"> 147</span></a>        <span class="k">if</span> <span class="n">link_to_src</span><span class="p">:</span>
</span><span id="NSSession-148"><a href="#NSSession-148"><span class="linenos"> 148</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="si">}</span><span class="s2">; src:</span><span class="si">{</span><span class="n">link_to_src</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-149"><a href="#NSSession-149"><span class="linenos"> 149</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="si">}</span><span class="s2">; Written with NSDotPy/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span><span class="si">}</span><span class="s2"> (by:Sweeze; src:github.com/sw33ze/NSDotPy)&quot;</span>
</span><span id="NSSession-150"><a href="#NSSession-150"><span class="linenos"> 150</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">user_agent</span><span class="p">})</span>
</span><span id="NSSession-151"><a href="#NSSession-151"><span class="linenos"> 151</span></a>
</span><span id="NSSession-152"><a href="#NSSession-152"><span class="linenos"> 152</span></a>    <span class="k">def</span> <span class="nf">_validate_nations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nations</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-153"><a href="#NSSession-153"><span class="linenos"> 153</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if a list of nations exist using the NationStates API.</span>
</span><span id="NSSession-154"><a href="#NSSession-154"><span class="linenos"> 154</span></a>
</span><span id="NSSession-155"><a href="#NSSession-155"><span class="linenos"> 155</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-156"><a href="#NSSession-156"><span class="linenos"> 156</span></a><span class="sd">            nations (set[str]): List of nations to check</span>
</span><span id="NSSession-157"><a href="#NSSession-157"><span class="linenos"> 157</span></a>
</span><span id="NSSession-158"><a href="#NSSession-158"><span class="linenos"> 158</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-159"><a href="#NSSession-159"><span class="linenos"> 159</span></a><span class="sd">            bool: True if all nations in the set exist, False otherwise.</span>
</span><span id="NSSession-160"><a href="#NSSession-160"><span class="linenos"> 160</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-161"><a href="#NSSession-161"><span class="linenos"> 161</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_request</span><span class="p">(</span><span class="s2">&quot;world&quot;</span><span class="p">,</span> <span class="n">shard</span><span class="o">=</span><span class="s2">&quot;nations&quot;</span><span class="p">)</span>
</span><span id="NSSession-162"><a href="#NSSession-162"><span class="linenos"> 162</span></a>        <span class="n">world_nations</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">nations</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
</span><span id="NSSession-163"><a href="#NSSession-163"><span class="linenos"> 163</span></a>        <span class="c1"># check if all nations in the list exist in the world nations</span>
</span><span id="NSSession-164"><a href="#NSSession-164"><span class="linenos"> 164</span></a>        <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span> <span class="ow">in</span> <span class="n">world_nations</span> <span class="k">for</span> <span class="n">nation</span> <span class="ow">in</span> <span class="n">nations</span><span class="p">)</span>
</span><span id="NSSession-165"><a href="#NSSession-165"><span class="linenos"> 165</span></a>
</span><span id="NSSession-166"><a href="#NSSession-166"><span class="linenos"> 166</span></a>    <span class="k">def</span> <span class="nf">_init_logger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NSSession-167"><a href="#NSSession-167"><span class="linenos"> 167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;NSDotPy&quot;</span><span class="p">)</span>
</span><span id="NSSession-168"><a href="#NSSession-168"><span class="linenos"> 168</span></a>        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-169"><a href="#NSSession-169"><span class="linenos"> 169</span></a>            <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="NSSession-170"><a href="#NSSession-170"><span class="linenos"> 170</span></a>            <span class="s2">&quot;disable_existing_loggers&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-171"><a href="#NSSession-171"><span class="linenos"> 171</span></a>            <span class="s2">&quot;formatters&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="NSSession-172"><a href="#NSSession-172"><span class="linenos"> 172</span></a>                <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="NSSession-173"><a href="#NSSession-173"><span class="linenos"> 173</span></a>                    <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%(asctime)s</span><span class="s2"> </span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="NSSession-174"><a href="#NSSession-174"><span class="linenos"> 174</span></a>                    <span class="s2">&quot;datefmt&quot;</span><span class="p">:</span> <span class="s2">&quot;%I:%M:%S %p&quot;</span><span class="p">,</span>
</span><span id="NSSession-175"><a href="#NSSession-175"><span class="linenos"> 175</span></a>                <span class="p">}</span>
</span><span id="NSSession-176"><a href="#NSSession-176"><span class="linenos"> 176</span></a>            <span class="p">},</span>
</span><span id="NSSession-177"><a href="#NSSession-177"><span class="linenos"> 177</span></a>            <span class="s2">&quot;handlers&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="NSSession-178"><a href="#NSSession-178"><span class="linenos"> 178</span></a>                <span class="s2">&quot;console&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="NSSession-179"><a href="#NSSession-179"><span class="linenos"> 179</span></a>                    <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;logging.StreamHandler&quot;</span><span class="p">,</span>
</span><span id="NSSession-180"><a href="#NSSession-180"><span class="linenos"> 180</span></a>                    <span class="s2">&quot;formatter&quot;</span><span class="p">:</span> <span class="s2">&quot;f&quot;</span><span class="p">,</span>
</span><span id="NSSession-181"><a href="#NSSession-181"><span class="linenos"> 181</span></a>                <span class="p">}</span>
</span><span id="NSSession-182"><a href="#NSSession-182"><span class="linenos"> 182</span></a>            <span class="p">},</span>
</span><span id="NSSession-183"><a href="#NSSession-183"><span class="linenos"> 183</span></a>            <span class="s2">&quot;loggers&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="NSSession-184"><a href="#NSSession-184"><span class="linenos"> 184</span></a>                <span class="s2">&quot;NSDotPy&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;handlers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;console&quot;</span><span class="p">],</span> <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;INFO&quot;</span><span class="p">},</span>
</span><span id="NSSession-185"><a href="#NSSession-185"><span class="linenos"> 185</span></a>                <span class="s2">&quot;httpx&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;handlers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;console&quot;</span><span class="p">],</span> <span class="s2">&quot;level&quot;</span><span class="p">:</span> <span class="s2">&quot;ERROR&quot;</span><span class="p">},</span>
</span><span id="NSSession-186"><a href="#NSSession-186"><span class="linenos"> 186</span></a>            <span class="p">},</span>
</span><span id="NSSession-187"><a href="#NSSession-187"><span class="linenos"> 187</span></a>        <span class="p">}</span>
</span><span id="NSSession-188"><a href="#NSSession-188"><span class="linenos"> 188</span></a>        <span class="n">logging</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">dictConfig</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</span><span id="NSSession-189"><a href="#NSSession-189"><span class="linenos"> 189</span></a>
</span><span id="NSSession-190"><a href="#NSSession-190"><span class="linenos"> 190</span></a>    <span class="k">def</span> <span class="nf">_get_auth_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">:</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Response</span><span class="p">):</span>
</span><span id="NSSession-191"><a href="#NSSession-191"><span class="linenos"> 191</span></a>        <span class="c1"># make sure it&#39;s actually html first</span>
</span><span id="NSSession-192"><a href="#NSSession-192"><span class="linenos"> 192</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;text/html&quot;</span><span class="p">):</span>
</span><span id="NSSession-193"><a href="#NSSession-193"><span class="linenos"> 193</span></a>            <span class="k">return</span>
</span><span id="NSSession-194"><a href="#NSSession-194"><span class="linenos"> 194</span></a>        <span class="c1"># parse the html</span>
</span><span id="NSSession-195"><a href="#NSSession-195"><span class="linenos"> 195</span></a>        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
</span><span id="NSSession-196"><a href="#NSSession-196"><span class="linenos"> 196</span></a>        <span class="c1"># gathering chk and localid so i dont have to worry about authenticating l8r</span>
</span><span id="NSSession-197"><a href="#NSSession-197"><span class="linenos"> 197</span></a>        <span class="k">if</span> <span class="n">chk</span> <span class="o">:=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;chk&quot;</span><span class="p">}):</span>
</span><span id="NSSession-198"><a href="#NSSession-198"><span class="linenos"> 198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">chk</span> <span class="o">=</span> <span class="n">chk</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession-199"><a href="#NSSession-199"><span class="linenos"> 199</span></a>        <span class="k">if</span> <span class="n">localid</span> <span class="o">:=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;localid&quot;</span><span class="p">}):</span>
</span><span id="NSSession-200"><a href="#NSSession-200"><span class="linenos"> 200</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">localid</span> <span class="o">=</span> <span class="n">localid</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession-201"><a href="#NSSession-201"><span class="linenos"> 201</span></a>        <span class="k">if</span> <span class="n">pin</span> <span class="o">:=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pin&quot;</span><span class="p">):</span>
</span><span id="NSSession-202"><a href="#NSSession-202"><span class="linenos"> 202</span></a>            <span class="c1"># you should never really need the pin but just in case i&#39;ll store it</span>
</span><span id="NSSession-203"><a href="#NSSession-203"><span class="linenos"> 203</span></a>            <span class="c1"># PAST ME WAS RIGHT, I NEEDED IT FOR THE PRIVATE API!!</span>
</span><span id="NSSession-204"><a href="#NSSession-204"><span class="linenos"> 204</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pin</span> <span class="o">=</span> <span class="n">pin</span>
</span><span id="NSSession-205"><a href="#NSSession-205"><span class="linenos"> 205</span></a>        <span class="k">if</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;STANDOUT&quot;</span><span class="p">}):</span>
</span><span id="NSSession-206"><a href="#NSSession-206"><span class="linenos"> 206</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span>
</span><span id="NSSession-207"><a href="#NSSession-207"><span class="linenos"> 207</span></a>                <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;STANDOUT&quot;</span><span class="p">})[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="NSSession-208"><a href="#NSSession-208"><span class="linenos"> 208</span></a>            <span class="p">)</span>
</span><span id="NSSession-209"><a href="#NSSession-209"><span class="linenos"> 209</span></a>
</span><span id="NSSession-210"><a href="#NSSession-210"><span class="linenos"> 210</span></a>    <span class="k">def</span> <span class="nf">_wait_for_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span><span id="NSSession-211"><a href="#NSSession-211"><span class="linenos"> 211</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Blocks execution until the user presses a key. Used as the one click = one request action.</span>
</span><span id="NSSession-212"><a href="#NSSession-212"><span class="linenos"> 212</span></a>
</span><span id="NSSession-213"><a href="#NSSession-213"><span class="linenos"> 213</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-214"><a href="#NSSession-214"><span class="linenos"> 214</span></a><span class="sd">            key (str): The key to wait for</span>
</span><span id="NSSession-215"><a href="#NSSession-215"><span class="linenos"> 215</span></a>
</span><span id="NSSession-216"><a href="#NSSession-216"><span class="linenos"> 216</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-217"><a href="#NSSession-217"><span class="linenos"> 217</span></a><span class="sd">            int: Userclick parameter, milliseconds since the epoch&quot;&quot;&quot;</span>
</span><span id="NSSession-218"><a href="#NSSession-218"><span class="linenos"> 218</span></a>        <span class="n">keyboard</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="NSSession-219"><a href="#NSSession-219"><span class="linenos"> 219</span></a>        <span class="c1"># the trigger_on_release parameter is broken on windows</span>
</span><span id="NSSession-220"><a href="#NSSession-220"><span class="linenos"> 220</span></a>        <span class="c1"># because of a bug in keyboard so we have to do this</span>
</span><span id="NSSession-221"><a href="#NSSession-221"><span class="linenos"> 221</span></a>        <span class="k">while</span> <span class="n">keyboard</span><span class="o">.</span><span class="n">is_pressed</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
</span><span id="NSSession-222"><a href="#NSSession-222"><span class="linenos"> 222</span></a>            <span class="k">pass</span>
</span><span id="NSSession-223"><a href="#NSSession-223"><span class="linenos"> 223</span></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
</span><span id="NSSession-224"><a href="#NSSession-224"><span class="linenos"> 224</span></a>
</span><span id="NSSession-225"><a href="#NSSession-225"><span class="linenos"> 225</span></a>    <span class="k">def</span> <span class="nf">_get_detag_wfe</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="NSSession-226"><a href="#NSSession-226"><span class="linenos"> 226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the detagged WFE of the region you&#39;re in.</span>
</span><span id="NSSession-227"><a href="#NSSession-227"><span class="linenos"> 227</span></a>
</span><span id="NSSession-228"><a href="#NSSession-228"><span class="linenos"> 228</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-229"><a href="#NSSession-229"><span class="linenos"> 229</span></a><span class="sd">            str: The detagged WFE&quot;&quot;&quot;</span>
</span><span id="NSSession-230"><a href="#NSSession-230"><span class="linenos"> 230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Getting detag WFE for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</span><span id="NSSession-231"><a href="#NSSession-231"><span class="linenos"> 231</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
</span><span id="NSSession-232"><a href="#NSSession-232"><span class="linenos"> 232</span></a>            <span class="sa">f</span><span class="s2">&quot;https://greywardens.xyz/tools/wfe_index/region=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="NSSession-233"><a href="#NSSession-233"><span class="linenos"> 233</span></a>        <span class="p">)</span>
</span><span id="NSSession-234"><a href="#NSSession-234"><span class="linenos"> 234</span></a>        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
</span><span id="NSSession-235"><a href="#NSSession-235"><span class="linenos"> 235</span></a>        <span class="c1"># the safest bet for a detag wfe is the first wfe of the region</span>
</span><span id="NSSession-236"><a href="#NSSession-236"><span class="linenos"> 236</span></a>        <span class="k">return</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;pre&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-237"><a href="#NSSession-237"><span class="linenos"> 237</span></a>
</span><span id="NSSession-238"><a href="#NSSession-238"><span class="linenos"> 238</span></a>    <span class="k">def</span> <span class="nf">_validate_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="NSSession-239"><a href="#NSSession-239"><span class="linenos"> 239</span></a>        <span class="n">max_lengths</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-240"><a href="#NSSession-240"><span class="linenos"> 240</span></a>            <span class="s2">&quot;pretitle&quot;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span>
</span><span id="NSSession-241"><a href="#NSSession-241"><span class="linenos"> 241</span></a>            <span class="s2">&quot;slogan&quot;</span><span class="p">:</span> <span class="mi">55</span><span class="p">,</span>
</span><span id="NSSession-242"><a href="#NSSession-242"><span class="linenos"> 242</span></a>            <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="NSSession-243"><a href="#NSSession-243"><span class="linenos"> 243</span></a>            <span class="s2">&quot;animal&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
</span><span id="NSSession-244"><a href="#NSSession-244"><span class="linenos"> 244</span></a>            <span class="s2">&quot;demonym_noun&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
</span><span id="NSSession-245"><a href="#NSSession-245"><span class="linenos"> 245</span></a>            <span class="s2">&quot;demonym_adjective&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
</span><span id="NSSession-246"><a href="#NSSession-246"><span class="linenos"> 246</span></a>            <span class="s2">&quot;demonym_plural&quot;</span><span class="p">:</span> <span class="mi">44</span><span class="p">,</span>
</span><span id="NSSession-247"><a href="#NSSession-247"><span class="linenos"> 247</span></a>        <span class="p">}</span>
</span><span id="NSSession-248"><a href="#NSSession-248"><span class="linenos"> 248</span></a>
</span><span id="NSSession-249"><a href="#NSSession-249"><span class="linenos"> 249</span></a>        <span class="c1"># go through each key in the data dict and make sure they&#39;re below the max length</span>
</span><span id="NSSession-250"><a href="#NSSession-250"><span class="linenos"> 250</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="NSSession-251"><a href="#NSSession-251"><span class="linenos"> 251</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">max_lengths</span><span class="p">:</span>
</span><span id="NSSession-252"><a href="#NSSession-252"><span class="linenos"> 252</span></a>                <span class="k">continue</span>
</span><span id="NSSession-253"><a href="#NSSession-253"><span class="linenos"> 253</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_lengths</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
</span><span id="NSSession-254"><a href="#NSSession-254"><span class="linenos"> 254</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> is too long, max length is </span><span class="si">{</span><span class="n">max_lengths</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-255"><a href="#NSSession-255"><span class="linenos"> 255</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;slogan&quot;</span><span class="p">:</span>
</span><span id="NSSession-256"><a href="#NSSession-256"><span class="linenos"> 256</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> should have a minimum length of 2 characters.&quot;</span><span class="p">)</span>
</span><span id="NSSession-257"><a href="#NSSession-257"><span class="linenos"> 257</span></a>            <span class="c1"># check if pretitle contains any non-alphanumeric characters (except spaces)</span>
</span><span id="NSSession-258"><a href="#NSSession-258"><span class="linenos"> 258</span></a>            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;pretitle&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">value</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">isalnum</span><span class="p">():</span>
</span><span id="NSSession-259"><a href="#NSSession-259"><span class="linenos"> 259</span></a>                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="NSSession-260"><a href="#NSSession-260"><span class="linenos"> 260</span></a>                    <span class="s2">&quot;Pretitle should only contain alphanumeric characters or spaces.&quot;</span>
</span><span id="NSSession-261"><a href="#NSSession-261"><span class="linenos"> 261</span></a>                <span class="p">)</span>
</span><span id="NSSession-262"><a href="#NSSession-262"><span class="linenos"> 262</span></a>
</span><span id="NSSession-263"><a href="#NSSession-263"><span class="linenos"> 263</span></a>    <span class="k">def</span> <span class="nf">_wait_for_ratelimit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">head</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
</span><span id="NSSession-264"><a href="#NSSession-264"><span class="linenos"> 264</span></a>        <span class="k">if</span> <span class="s2">&quot;X-Pin&quot;</span> <span class="ow">in</span> <span class="n">head</span><span class="p">:</span>
</span><span id="NSSession-265"><a href="#NSSession-265"><span class="linenos"> 265</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">pin</span> <span class="o">=</span> <span class="n">head</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span>
</span><span id="NSSession-266"><a href="#NSSession-266"><span class="linenos"> 266</span></a>        <span class="k">if</span> <span class="n">waiting_time</span> <span class="o">:=</span> <span class="n">head</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Retry-After&quot;</span><span class="p">):</span>
</span><span id="NSSession-267"><a href="#NSSession-267"><span class="linenos"> 267</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rate limited. Waiting </span><span class="si">{</span><span class="n">waiting_time</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
</span><span id="NSSession-268"><a href="#NSSession-268"><span class="linenos"> 268</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">waiting_time</span><span class="p">))</span>
</span><span id="NSSession-269"><a href="#NSSession-269"><span class="linenos"> 269</span></a>        <span class="c1"># slow down requests so we dont hit the rate limit in the first place</span>
</span><span id="NSSession-270"><a href="#NSSession-270"><span class="linenos"> 270</span></a>        <span class="n">requests_left</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="s2">&quot;RateLimit-Remaining&quot;</span><span class="p">])</span>
</span><span id="NSSession-271"><a href="#NSSession-271"><span class="linenos"> 271</span></a>        <span class="k">if</span> <span class="n">requests_left</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="ow">or</span> <span class="n">constant_rate_limit</span><span class="p">:</span>
</span><span id="NSSession-272"><a href="#NSSession-272"><span class="linenos"> 272</span></a>            <span class="n">seconds_until_reset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">head</span><span class="p">[</span><span class="s2">&quot;RateLimit-Reset&quot;</span><span class="p">])</span>
</span><span id="NSSession-273"><a href="#NSSession-273"><span class="linenos"> 273</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">seconds_until_reset</span> <span class="o">/</span> <span class="n">requests_left</span><span class="p">)</span>
</span><span id="NSSession-274"><a href="#NSSession-274"><span class="linenos"> 274</span></a>
</span><span id="NSSession-275"><a href="#NSSession-275"><span class="linenos"> 275</span></a>    <span class="k">def</span> <span class="nf">_html_request</span><span class="p">(</span>
</span><span id="NSSession-276"><a href="#NSSession-276"><span class="linenos"> 276</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{},</span> <span class="n">files</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="kc">False</span>
</span><span id="NSSession-277"><a href="#NSSession-277"><span class="linenos"> 277</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Response</span><span class="p">:</span>
</span><span id="NSSession-278"><a href="#NSSession-278"><span class="linenos"> 278</span></a>        <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;chk&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">chk</span><span class="p">,</span> <span class="s2">&quot;localid&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">localid</span><span class="p">}</span>
</span><span id="NSSession-279"><a href="#NSSession-279"><span class="linenos"> 279</span></a>        <span class="n">userclick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_input</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keybind</span><span class="p">)</span>
</span><span id="NSSession-280"><a href="#NSSession-280"><span class="linenos"> 280</span></a>        <span class="c1"># userclick is the number of milliseconds since the epoch, admin uses this for help enforcing the simultaneity rule</span>
</span><span id="NSSession-281"><a href="#NSSession-281"><span class="linenos"> 281</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="NSSession-282"><a href="#NSSession-282"><span class="linenos"> 282</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">/userclick=</span><span class="si">{</span><span class="n">userclick</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="NSSession-283"><a href="#NSSession-283"><span class="linenos"> 283</span></a>            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="NSSession-284"><a href="#NSSession-284"><span class="linenos"> 284</span></a>            <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
</span><span id="NSSession-285"><a href="#NSSession-285"><span class="linenos"> 285</span></a>            <span class="n">follow_redirects</span><span class="o">=</span><span class="n">follow_redirects</span><span class="p">,</span>
</span><span id="NSSession-286"><a href="#NSSession-286"><span class="linenos"> 286</span></a>        <span class="p">)</span>
</span><span id="NSSession-287"><a href="#NSSession-287"><span class="linenos"> 287</span></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">&gt;=</span> <span class="mi">400</span><span class="p">:</span>
</span><span id="NSSession-288"><a href="#NSSession-288"><span class="linenos"> 288</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;error.html&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="NSSession-289"><a href="#NSSession-289"><span class="linenos"> 289</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span><span id="NSSession-290"><a href="#NSSession-290"><span class="linenos"> 290</span></a>            <span class="k">raise</span> <span class="n">httpx</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span>
</span><span id="NSSession-291"><a href="#NSSession-291"><span class="linenos"> 291</span></a>                <span class="sa">f</span><span class="s2">&quot;Received status code </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">url</span><span class="si">}</span><span class="s2">. Error page saved to error.html.&quot;</span>
</span><span id="NSSession-292"><a href="#NSSession-292"><span class="linenos"> 292</span></a>            <span class="p">)</span>
</span><span id="NSSession-293"><a href="#NSSession-293"><span class="linenos"> 293</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_auth_values</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span><span id="NSSession-294"><a href="#NSSession-294"><span class="linenos"> 294</span></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="NSSession-295"><a href="#NSSession-295"><span class="linenos"> 295</span></a>
</span><span id="NSSession-296"><a href="#NSSession-296"><span class="linenos"> 296</span></a>    <span class="c1"># --- end private methods --- #</span>
</span><span id="NSSession-297"><a href="#NSSession-297"><span class="linenos"> 297</span></a>
</span><span id="NSSession-298"><a href="#NSSession-298"><span class="linenos"> 298</span></a>    <span class="k">def</span> <span class="nf">refresh_auth_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NSSession-299"><a href="#NSSession-299"><span class="linenos"> 299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Refreshing authentication values...&quot;</span><span class="p">)</span>
</span><span id="NSSession-300"><a href="#NSSession-300"><span class="linenos"> 300</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
</span><span id="NSSession-301"><a href="#NSSession-301"><span class="linenos"> 301</span></a>            <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/page=display_region/region=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth_region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="NSSession-302"><a href="#NSSession-302"><span class="linenos"> 302</span></a>            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="s2">&quot;century&quot;</span><span class="p">},</span>
</span><span id="NSSession-303"><a href="#NSSession-303"><span class="linenos"> 303</span></a>        <span class="p">)</span>
</span><span id="NSSession-304"><a href="#NSSession-304"><span class="linenos"> 304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_auth_values</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span><span id="NSSession-305"><a href="#NSSession-305"><span class="linenos"> 305</span></a>
</span><span id="NSSession-306"><a href="#NSSession-306"><span class="linenos"> 306</span></a>    <span class="k">def</span> <span class="nf">request</span><span class="p">(</span>
</span><span id="NSSession-307"><a href="#NSSession-307"><span class="linenos"> 307</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-308"><a href="#NSSession-308"><span class="linenos"> 308</span></a>        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-309"><a href="#NSSession-309"><span class="linenos"> 309</span></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="NSSession-310"><a href="#NSSession-310"><span class="linenos"> 310</span></a>        <span class="n">files</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="NSSession-311"><a href="#NSSession-311"><span class="linenos"> 311</span></a>        <span class="n">follow_redirects</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-312"><a href="#NSSession-312"><span class="linenos"> 312</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Response</span><span class="p">:</span>
</span><span id="NSSession-313"><a href="#NSSession-313"><span class="linenos"> 313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends a request to the given url with the given data and files.</span>
</span><span id="NSSession-314"><a href="#NSSession-314"><span class="linenos"> 314</span></a>
</span><span id="NSSession-315"><a href="#NSSession-315"><span class="linenos"> 315</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-316"><a href="#NSSession-316"><span class="linenos"> 316</span></a><span class="sd">            url (str): URL to send the request to</span>
</span><span id="NSSession-317"><a href="#NSSession-317"><span class="linenos"> 317</span></a><span class="sd">            data (dict, optional): Payload to send with the request</span>
</span><span id="NSSession-318"><a href="#NSSession-318"><span class="linenos"> 318</span></a><span class="sd">            files (dict, optional): Payload to send with requests that upload files</span>
</span><span id="NSSession-319"><a href="#NSSession-319"><span class="linenos"> 319</span></a>
</span><span id="NSSession-320"><a href="#NSSession-320"><span class="linenos"> 320</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-321"><a href="#NSSession-321"><span class="linenos"> 321</span></a><span class="sd">            httpx.Response: The response from the server</span>
</span><span id="NSSession-322"><a href="#NSSession-322"><span class="linenos"> 322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-323"><a href="#NSSession-323"><span class="linenos"> 323</span></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="NSSession-324"><a href="#NSSession-324"><span class="linenos"> 324</span></a>            <span class="n">banned_page</span> <span class="ow">in</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span><span id="NSSession-325"><a href="#NSSession-325"><span class="linenos"> 325</span></a>            <span class="k">for</span> <span class="n">banned_page</span> <span class="ow">in</span> <span class="p">{</span>
</span><span id="NSSession-326"><a href="#NSSession-326"><span class="linenos"> 326</span></a>                <span class="s2">&quot;page=telegrams&quot;</span><span class="p">,</span>
</span><span id="NSSession-327"><a href="#NSSession-327"><span class="linenos"> 327</span></a>                <span class="s2">&quot;page=dilemmas&quot;</span><span class="p">,</span>
</span><span id="NSSession-328"><a href="#NSSession-328"><span class="linenos"> 328</span></a>                <span class="s2">&quot;page=compose_telegram&quot;</span><span class="p">,</span>
</span><span id="NSSession-329"><a href="#NSSession-329"><span class="linenos"> 329</span></a>                <span class="s2">&quot;page=store&quot;</span><span class="p">,</span>
</span><span id="NSSession-330"><a href="#NSSession-330"><span class="linenos"> 330</span></a>                <span class="s2">&quot;page=help&quot;</span><span class="p">,</span>
</span><span id="NSSession-331"><a href="#NSSession-331"><span class="linenos"> 331</span></a>            <span class="p">}</span>
</span><span id="NSSession-332"><a href="#NSSession-332"><span class="linenos"> 332</span></a>        <span class="p">):</span>
</span><span id="NSSession-333"><a href="#NSSession-333"><span class="linenos"> 333</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="NSSession-334"><a href="#NSSession-334"><span class="linenos"> 334</span></a>                <span class="s2">&quot;You cannot use a tool to interact with telegrams, issues, getting help, or the store. Read up on the script rules: https://forum.nationstates.net/viewtopic.php?p=16394966#p16394966&quot;</span>
</span><span id="NSSession-335"><a href="#NSSession-335"><span class="linenos"> 335</span></a>            <span class="p">)</span>
</span><span id="NSSession-336"><a href="#NSSession-336"><span class="linenos"> 336</span></a>        <span class="k">if</span> <span class="s2">&quot;api.cgi&quot;</span> <span class="ow">in</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span><span id="NSSession-337"><a href="#NSSession-337"><span class="linenos"> 337</span></a>            <span class="c1"># you should be using api_request for api requests</span>
</span><span id="NSSession-338"><a href="#NSSession-338"><span class="linenos"> 338</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You should be using api_request() for api requests.&quot;</span><span class="p">)</span>
</span><span id="NSSession-339"><a href="#NSSession-339"><span class="linenos"> 339</span></a>        <span class="k">elif</span> <span class="s2">&quot;nationstates&quot;</span> <span class="ow">in</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span><span id="NSSession-340"><a href="#NSSession-340"><span class="linenos"> 340</span></a>            <span class="c1"># do all the things that need to be done for html requests</span>
</span><span id="NSSession-341"><a href="#NSSession-341"><span class="linenos"> 341</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
</span><span id="NSSession-342"><a href="#NSSession-342"><span class="linenos"> 342</span></a>                <span class="c1"># if lock is true then we&#39;re already in the middle of a</span>
</span><span id="NSSession-343"><a href="#NSSession-343"><span class="linenos"> 343</span></a>                <span class="c1"># request and we&#39;re in danger of breaking the simultaneity rule</span>
</span><span id="NSSession-344"><a href="#NSSession-344"><span class="linenos"> 344</span></a>                <span class="c1"># so raise an error</span>
</span><span id="NSSession-345"><a href="#NSSession-345"><span class="linenos"> 345</span></a>                <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span>
</span><span id="NSSession-346"><a href="#NSSession-346"><span class="linenos"> 346</span></a>                    <span class="s2">&quot;You&#39;re already in the middle of a request. Stop trying to violate simultaneity.&quot;</span>
</span><span id="NSSession-347"><a href="#NSSession-347"><span class="linenos"> 347</span></a>                <span class="p">)</span>
</span><span id="NSSession-348"><a href="#NSSession-348"><span class="linenos"> 348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="NSSession-349"><a href="#NSSession-349"><span class="linenos"> 349</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html_request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="p">)</span>
</span><span id="NSSession-350"><a href="#NSSession-350"><span class="linenos"> 350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="NSSession-351"><a href="#NSSession-351"><span class="linenos"> 351</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NSSession-352"><a href="#NSSession-352"><span class="linenos"> 352</span></a>            <span class="c1"># if its not nationstates then just pass the request through</span>
</span><span id="NSSession-353"><a href="#NSSession-353"><span class="linenos"> 353</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="NSSession-354"><a href="#NSSession-354"><span class="linenos"> 354</span></a>                <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="n">follow_redirects</span>
</span><span id="NSSession-355"><a href="#NSSession-355"><span class="linenos"> 355</span></a>            <span class="p">)</span>
</span><span id="NSSession-356"><a href="#NSSession-356"><span class="linenos"> 356</span></a>        <span class="k">return</span> <span class="n">response</span>
</span><span id="NSSession-357"><a href="#NSSession-357"><span class="linenos"> 357</span></a>
</span><span id="NSSession-358"><a href="#NSSession-358"><span class="linenos"> 358</span></a>    <span class="k">def</span> <span class="nf">api_request</span><span class="p">(</span>
</span><span id="NSSession-359"><a href="#NSSession-359"><span class="linenos"> 359</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-360"><a href="#NSSession-360"><span class="linenos"> 360</span></a>        <span class="n">api</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-361"><a href="#NSSession-361"><span class="linenos"> 361</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="NSSession-362"><a href="#NSSession-362"><span class="linenos"> 362</span></a>        <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-363"><a href="#NSSession-363"><span class="linenos"> 363</span></a>        <span class="n">shard</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-364"><a href="#NSSession-364"><span class="linenos"> 364</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-365"><a href="#NSSession-365"><span class="linenos"> 365</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-366"><a href="#NSSession-366"><span class="linenos"> 366</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession-367"><a href="#NSSession-367"><span class="linenos"> 367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends a request to the nationstates api with the given data.</span>
</span><span id="NSSession-368"><a href="#NSSession-368"><span class="linenos"> 368</span></a>
</span><span id="NSSession-369"><a href="#NSSession-369"><span class="linenos"> 369</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-370"><a href="#NSSession-370"><span class="linenos"> 370</span></a><span class="sd">            api (str): The api to send the request to. Must be &quot;nation&quot;, &quot;region&quot;, &quot;world&quot;, or &quot;wa&quot;</span>
</span><span id="NSSession-371"><a href="#NSSession-371"><span class="linenos"> 371</span></a><span class="sd">            target (str, optional): The nation, region, or wa council to target. Required for non-world api requests.</span>
</span><span id="NSSession-372"><a href="#NSSession-372"><span class="linenos"> 372</span></a><span class="sd">            shard (str, optional): The shard, or shards, you&#39;re requesting for. Must be a valid shard for the given api. Only required for world and wa api requests.</span>
</span><span id="NSSession-373"><a href="#NSSession-373"><span class="linenos"> 373</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession-374"><a href="#NSSession-374"><span class="linenos"> 374</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession-375"><a href="#NSSession-375"><span class="linenos"> 375</span></a>
</span><span id="NSSession-376"><a href="#NSSession-376"><span class="linenos"> 376</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-377"><a href="#NSSession-377"><span class="linenos"> 377</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession-378"><a href="#NSSession-378"><span class="linenos"> 378</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-379"><a href="#NSSession-379"><span class="linenos"> 379</span></a>        <span class="c1"># TODO: probably move this responsibility to a third party api library to avoid reinventing the wheel</span>
</span><span id="NSSession-380"><a href="#NSSession-380"><span class="linenos"> 380</span></a>        <span class="c1"># if one exists of sufficient quality thats AGPLv3 compatible</span>
</span><span id="NSSession-381"><a href="#NSSession-381"><span class="linenos"> 381</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;nation&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">,</span> <span class="s2">&quot;wa&quot;</span><span class="p">}:</span>
</span><span id="NSSession-382"><a href="#NSSession-382"><span class="linenos"> 382</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;api must be &#39;nation&#39;, &#39;region&#39;, &#39;world&#39;, or &#39;wa&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession-383"><a href="#NSSession-383"><span class="linenos"> 383</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="o">!=</span> <span class="s2">&quot;world&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">target</span><span class="p">:</span>
</span><span id="NSSession-384"><a href="#NSSession-384"><span class="linenos"> 384</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;target must be specified for non-world api requests&quot;</span><span class="p">)</span>
</span><span id="NSSession-385"><a href="#NSSession-385"><span class="linenos"> 385</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;wa&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">}</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">shard</span><span class="p">:</span>
</span><span id="NSSession-386"><a href="#NSSession-386"><span class="linenos"> 386</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;shard must be specified for world and wa api requests&quot;</span><span class="p">)</span>
</span><span id="NSSession-387"><a href="#NSSession-387"><span class="linenos"> 387</span></a>        <span class="c1"># end argument validation</span>
</span><span id="NSSession-388"><a href="#NSSession-388"><span class="linenos"> 388</span></a>        <span class="c1"># shard validation</span>
</span><span id="NSSession-389"><a href="#NSSession-389"><span class="linenos"> 389</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">shard</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="NSSession-390"><a href="#NSSession-390"><span class="linenos"> 390</span></a>            <span class="n">shard</span> <span class="o">=</span> <span class="p">{</span><span class="n">shard</span><span class="p">}</span>
</span><span id="NSSession-391"><a href="#NSSession-391"><span class="linenos"> 391</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_shards</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="n">shard</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession-392"><a href="#NSSession-392"><span class="linenos"> 392</span></a>        <span class="c1"># end shard validation</span>
</span><span id="NSSession-393"><a href="#NSSession-393"><span class="linenos"> 393</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-394"><a href="#NSSession-394"><span class="linenos"> 394</span></a>            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
</span><span id="NSSession-395"><a href="#NSSession-395"><span class="linenos"> 395</span></a>        <span class="p">}</span>
</span><span id="NSSession-396"><a href="#NSSession-396"><span class="linenos"> 396</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="o">!=</span> <span class="s2">&quot;world&quot;</span><span class="p">:</span>
</span><span id="NSSession-397"><a href="#NSSession-397"><span class="linenos"> 397</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">api</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="NSSession-398"><a href="#NSSession-398"><span class="linenos"> 398</span></a>        <span class="k">if</span> <span class="n">shard</span><span class="p">:</span>
</span><span id="NSSession-399"><a href="#NSSession-399"><span class="linenos"> 399</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">shard</span><span class="p">)</span>
</span><span id="NSSession-400"><a href="#NSSession-400"><span class="linenos"> 400</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/api.cgi&quot;</span>
</span><span id="NSSession-401"><a href="#NSSession-401"><span class="linenos"> 401</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession-402"><a href="#NSSession-402"><span class="linenos"> 402</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="NSSession-403"><a href="#NSSession-403"><span class="linenos"> 403</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span>
</span><span id="NSSession-404"><a href="#NSSession-404"><span class="linenos"> 404</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span>
</span><span id="NSSession-405"><a href="#NSSession-405"><span class="linenos"> 405</span></a>        <span class="c1"># rate limiting section</span>
</span><span id="NSSession-406"><a href="#NSSession-406"><span class="linenos"> 406</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-407"><a href="#NSSession-407"><span class="linenos"> 407</span></a>        <span class="c1"># if the server tells us to wait, wait</span>
</span><span id="NSSession-408"><a href="#NSSession-408"><span class="linenos"> 408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ratelimit</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">)</span>
</span><span id="NSSession-409"><a href="#NSSession-409"><span class="linenos"> 409</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="NSSession-410"><a href="#NSSession-410"><span class="linenos"> 410</span></a>        <span class="n">parsed_response</span> <span class="o">=</span> <span class="n">benedict</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">keyattr_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NSSession-411"><a href="#NSSession-411"><span class="linenos"> 411</span></a>        <span class="n">parsed_response</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</span><span id="NSSession-412"><a href="#NSSession-412"><span class="linenos"> 412</span></a>        <span class="n">parsed_response</span><span class="p">:</span> <span class="n">benedict</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="n">api</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession-413"><a href="#NSSession-413"><span class="linenos"> 413</span></a>        <span class="k">return</span> <span class="n">parsed_response</span>
</span><span id="NSSession-414"><a href="#NSSession-414"><span class="linenos"> 414</span></a>
</span><span id="NSSession-415"><a href="#NSSession-415"><span class="linenos"> 415</span></a>    <span class="k">def</span> <span class="nf">api_issue</span><span class="p">(</span>
</span><span id="NSSession-416"><a href="#NSSession-416"><span class="linenos"> 416</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-417"><a href="#NSSession-417"><span class="linenos"> 417</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-418"><a href="#NSSession-418"><span class="linenos"> 418</span></a>        <span class="n">issue</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="NSSession-419"><a href="#NSSession-419"><span class="linenos"> 419</span></a>        <span class="n">option</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="NSSession-420"><a href="#NSSession-420"><span class="linenos"> 420</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-421"><a href="#NSSession-421"><span class="linenos"> 421</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-422"><a href="#NSSession-422"><span class="linenos"> 422</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession-423"><a href="#NSSession-423"><span class="linenos"> 423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Answers an issue via the API.</span>
</span><span id="NSSession-424"><a href="#NSSession-424"><span class="linenos"> 424</span></a>
</span><span id="NSSession-425"><a href="#NSSession-425"><span class="linenos"> 425</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-426"><a href="#NSSession-426"><span class="linenos"> 426</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession-427"><a href="#NSSession-427"><span class="linenos"> 427</span></a><span class="sd">            issue (int): the ID of the issue.</span>
</span><span id="NSSession-428"><a href="#NSSession-428"><span class="linenos"> 428</span></a><span class="sd">            option (int): the issue option to choose.</span>
</span><span id="NSSession-429"><a href="#NSSession-429"><span class="linenos"> 429</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession-430"><a href="#NSSession-430"><span class="linenos"> 430</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession-431"><a href="#NSSession-431"><span class="linenos"> 431</span></a>
</span><span id="NSSession-432"><a href="#NSSession-432"><span class="linenos"> 432</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-433"><a href="#NSSession-433"><span class="linenos"> 433</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession-434"><a href="#NSSession-434"><span class="linenos"> 434</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-435"><a href="#NSSession-435"><span class="linenos"> 435</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">password</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">):</span>
</span><span id="NSSession-436"><a href="#NSSession-436"><span class="linenos"> 436</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify authentication&quot;</span><span class="p">)</span>
</span><span id="NSSession-437"><a href="#NSSession-437"><span class="linenos"> 437</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-438"><a href="#NSSession-438"><span class="linenos"> 438</span></a>            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
</span><span id="NSSession-439"><a href="#NSSession-439"><span class="linenos"> 439</span></a>            <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;issue&quot;</span><span class="p">,</span>
</span><span id="NSSession-440"><a href="#NSSession-440"><span class="linenos"> 440</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span>
</span><span id="NSSession-441"><a href="#NSSession-441"><span class="linenos"> 441</span></a>            <span class="s2">&quot;issue&quot;</span><span class="p">:</span> <span class="n">issue</span><span class="p">,</span>
</span><span id="NSSession-442"><a href="#NSSession-442"><span class="linenos"> 442</span></a>            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="n">option</span><span class="p">,</span>
</span><span id="NSSession-443"><a href="#NSSession-443"><span class="linenos"> 443</span></a>        <span class="p">}</span>
</span><span id="NSSession-444"><a href="#NSSession-444"><span class="linenos"> 444</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/api.cgi&quot;</span>
</span><span id="NSSession-445"><a href="#NSSession-445"><span class="linenos"> 445</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession-446"><a href="#NSSession-446"><span class="linenos"> 446</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="NSSession-447"><a href="#NSSession-447"><span class="linenos"> 447</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span>
</span><span id="NSSession-448"><a href="#NSSession-448"><span class="linenos"> 448</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span>
</span><span id="NSSession-449"><a href="#NSSession-449"><span class="linenos"> 449</span></a>        <span class="c1"># rate limiting section</span>
</span><span id="NSSession-450"><a href="#NSSession-450"><span class="linenos"> 450</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-451"><a href="#NSSession-451"><span class="linenos"> 451</span></a>        <span class="c1"># if the server tells us to wait, wait</span>
</span><span id="NSSession-452"><a href="#NSSession-452"><span class="linenos"> 452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ratelimit</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">)</span>
</span><span id="NSSession-453"><a href="#NSSession-453"><span class="linenos"> 453</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="NSSession-454"><a href="#NSSession-454"><span class="linenos"> 454</span></a>        <span class="n">parsed_response</span> <span class="o">=</span> <span class="n">benedict</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">keyattr_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NSSession-455"><a href="#NSSession-455"><span class="linenos"> 455</span></a>        <span class="n">parsed_response</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</span><span id="NSSession-456"><a href="#NSSession-456"><span class="linenos"> 456</span></a>        <span class="n">parsed_response</span><span class="p">:</span> <span class="n">benedict</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="s2">&quot;nation&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession-457"><a href="#NSSession-457"><span class="linenos"> 457</span></a>        <span class="k">return</span> <span class="n">parsed_response</span>
</span><span id="NSSession-458"><a href="#NSSession-458"><span class="linenos"> 458</span></a>
</span><span id="NSSession-459"><a href="#NSSession-459"><span class="linenos"> 459</span></a>    <span class="k">def</span> <span class="nf">api_command</span><span class="p">(</span>
</span><span id="NSSession-460"><a href="#NSSession-460"><span class="linenos"> 460</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-461"><a href="#NSSession-461"><span class="linenos"> 461</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-462"><a href="#NSSession-462"><span class="linenos"> 462</span></a>        <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-463"><a href="#NSSession-463"><span class="linenos"> 463</span></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="NSSession-464"><a href="#NSSession-464"><span class="linenos"> 464</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-465"><a href="#NSSession-465"><span class="linenos"> 465</span></a>        <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-466"><a href="#NSSession-466"><span class="linenos"> 466</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-467"><a href="#NSSession-467"><span class="linenos"> 467</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession-468"><a href="#NSSession-468"><span class="linenos"> 468</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends a non-issue command to the nationstates api with the given data and password.</span>
</span><span id="NSSession-469"><a href="#NSSession-469"><span class="linenos"> 469</span></a>
</span><span id="NSSession-470"><a href="#NSSession-470"><span class="linenos"> 470</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-471"><a href="#NSSession-471"><span class="linenos"> 471</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession-472"><a href="#NSSession-472"><span class="linenos"> 472</span></a><span class="sd">            command (str): The command to perform. Must be &quot;giftcard&quot;, &quot;dispatch&quot;, &quot;rmbpost&quot;</span>
</span><span id="NSSession-473"><a href="#NSSession-473"><span class="linenos"> 473</span></a><span class="sd">            data (str, optional): The unique data to send with the parameters of the command; consult the API docs for more information.</span>
</span><span id="NSSession-474"><a href="#NSSession-474"><span class="linenos"> 474</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession-475"><a href="#NSSession-475"><span class="linenos"> 475</span></a><span class="sd">            mode (str, optional): Whether to prepare or to execute the command. If value is given, does one of the two and returns result, if no value is given, does both and returns result of execute.</span>
</span><span id="NSSession-476"><a href="#NSSession-476"><span class="linenos"> 476</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession-477"><a href="#NSSession-477"><span class="linenos"> 477</span></a>
</span><span id="NSSession-478"><a href="#NSSession-478"><span class="linenos"> 478</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-479"><a href="#NSSession-479"><span class="linenos"> 479</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession-480"><a href="#NSSession-480"><span class="linenos"> 480</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-481"><a href="#NSSession-481"><span class="linenos"> 481</span></a>        <span class="k">if</span> <span class="n">command</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;giftcard&quot;</span><span class="p">,</span> <span class="s2">&quot;dispatch&quot;</span><span class="p">,</span> <span class="s2">&quot;rmbpost&quot;</span><span class="p">}:</span>
</span><span id="NSSession-482"><a href="#NSSession-482"><span class="linenos"> 482</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;command must be &#39;giftcard&#39;, &#39;dispatch&#39;, or &#39;rmbpost&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession-483"><a href="#NSSession-483"><span class="linenos"> 483</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">password</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">):</span>
</span><span id="NSSession-484"><a href="#NSSession-484"><span class="linenos"> 484</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify authentication&quot;</span><span class="p">)</span>
</span><span id="NSSession-485"><a href="#NSSession-485"><span class="linenos"> 485</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;prepare&quot;</span><span class="p">,</span> <span class="s2">&quot;execute&quot;</span><span class="p">}:</span>
</span><span id="NSSession-486"><a href="#NSSession-486"><span class="linenos"> 486</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be prepare or execute&quot;</span><span class="p">)</span>
</span><span id="NSSession-487"><a href="#NSSession-487"><span class="linenos"> 487</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;12&quot;</span>
</span><span id="NSSession-488"><a href="#NSSession-488"><span class="linenos"> 488</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;nation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span>
</span><span id="NSSession-489"><a href="#NSSession-489"><span class="linenos"> 489</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="NSSession-490"><a href="#NSSession-490"><span class="linenos"> 490</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span> <span class="k">if</span> <span class="n">mode</span> <span class="k">else</span> <span class="s2">&quot;prepare&quot;</span>  <span class="c1"># if no mode than first prepare</span>
</span><span id="NSSession-491"><a href="#NSSession-491"><span class="linenos"> 491</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/api.cgi&quot;</span>
</span><span id="NSSession-492"><a href="#NSSession-492"><span class="linenos"> 492</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession-493"><a href="#NSSession-493"><span class="linenos"> 493</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="NSSession-494"><a href="#NSSession-494"><span class="linenos"> 494</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span>
</span><span id="NSSession-495"><a href="#NSSession-495"><span class="linenos"> 495</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span>
</span><span id="NSSession-496"><a href="#NSSession-496"><span class="linenos"> 496</span></a>        <span class="c1"># rate limiting section</span>
</span><span id="NSSession-497"><a href="#NSSession-497"><span class="linenos"> 497</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-498"><a href="#NSSession-498"><span class="linenos"> 498</span></a>        <span class="c1"># if the server tells us to wait, wait</span>
</span><span id="NSSession-499"><a href="#NSSession-499"><span class="linenos"> 499</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ratelimit</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">)</span>
</span><span id="NSSession-500"><a href="#NSSession-500"><span class="linenos"> 500</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="NSSession-501"><a href="#NSSession-501"><span class="linenos"> 501</span></a>        <span class="n">parsed_response</span> <span class="o">=</span> <span class="n">benedict</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">keyattr_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NSSession-502"><a href="#NSSession-502"><span class="linenos"> 502</span></a>        <span class="n">parsed_response</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</span><span id="NSSession-503"><a href="#NSSession-503"><span class="linenos"> 503</span></a>        <span class="n">parsed_response</span><span class="p">:</span> <span class="n">benedict</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="s2">&quot;nation&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession-504"><a href="#NSSession-504"><span class="linenos"> 504</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="NSSession-505"><a href="#NSSession-505"><span class="linenos"> 505</span></a>            <span class="c1"># if no mode was specified earlier, repeat command with execute and token</span>
</span><span id="NSSession-506"><a href="#NSSession-506"><span class="linenos"> 506</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]</span>
</span><span id="NSSession-507"><a href="#NSSession-507"><span class="linenos"> 507</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">nation</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;execute&quot;</span><span class="p">)</span>
</span><span id="NSSession-508"><a href="#NSSession-508"><span class="linenos"> 508</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NSSession-509"><a href="#NSSession-509"><span class="linenos"> 509</span></a>            <span class="k">return</span> <span class="n">parsed_response</span>
</span><span id="NSSession-510"><a href="#NSSession-510"><span class="linenos"> 510</span></a>
</span><span id="NSSession-511"><a href="#NSSession-511"><span class="linenos"> 511</span></a>    <span class="k">def</span> <span class="nf">api_giftcard</span><span class="p">(</span>
</span><span id="NSSession-512"><a href="#NSSession-512"><span class="linenos"> 512</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-513"><a href="#NSSession-513"><span class="linenos"> 513</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-514"><a href="#NSSession-514"><span class="linenos"> 514</span></a>        <span class="n">card_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="NSSession-515"><a href="#NSSession-515"><span class="linenos"> 515</span></a>        <span class="n">season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="NSSession-516"><a href="#NSSession-516"><span class="linenos"> 516</span></a>        <span class="n">recipient</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-517"><a href="#NSSession-517"><span class="linenos"> 517</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-518"><a href="#NSSession-518"><span class="linenos"> 518</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-519"><a href="#NSSession-519"><span class="linenos"> 519</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession-520"><a href="#NSSession-520"><span class="linenos"> 520</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gifts a card using the API.</span>
</span><span id="NSSession-521"><a href="#NSSession-521"><span class="linenos"> 521</span></a>
</span><span id="NSSession-522"><a href="#NSSession-522"><span class="linenos"> 522</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-523"><a href="#NSSession-523"><span class="linenos"> 523</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession-524"><a href="#NSSession-524"><span class="linenos"> 524</span></a><span class="sd">            card_id (int): The ID of the card to gift.</span>
</span><span id="NSSession-525"><a href="#NSSession-525"><span class="linenos"> 525</span></a><span class="sd">            season (int): The season of the card to gift.</span>
</span><span id="NSSession-526"><a href="#NSSession-526"><span class="linenos"> 526</span></a><span class="sd">            recipient (str): The nation to gift the card to.</span>
</span><span id="NSSession-527"><a href="#NSSession-527"><span class="linenos"> 527</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession-528"><a href="#NSSession-528"><span class="linenos"> 528</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession-529"><a href="#NSSession-529"><span class="linenos"> 529</span></a>
</span><span id="NSSession-530"><a href="#NSSession-530"><span class="linenos"> 530</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-531"><a href="#NSSession-531"><span class="linenos"> 531</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession-532"><a href="#NSSession-532"><span class="linenos"> 532</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-533"><a href="#NSSession-533"><span class="linenos"> 533</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cardid&quot;</span><span class="p">:</span> <span class="n">card_id</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">:</span> <span class="n">season</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">recipient</span><span class="p">)}</span>
</span><span id="NSSession-534"><a href="#NSSession-534"><span class="linenos"> 534</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span>
</span><span id="NSSession-535"><a href="#NSSession-535"><span class="linenos"> 535</span></a>            <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;giftcard&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="o">=</span><span class="n">constant_rate_limit</span>
</span><span id="NSSession-536"><a href="#NSSession-536"><span class="linenos"> 536</span></a>        <span class="p">)</span>
</span><span id="NSSession-537"><a href="#NSSession-537"><span class="linenos"> 537</span></a>
</span><span id="NSSession-538"><a href="#NSSession-538"><span class="linenos"> 538</span></a>    <span class="k">def</span> <span class="nf">api_dispatch</span><span class="p">(</span>
</span><span id="NSSession-539"><a href="#NSSession-539"><span class="linenos"> 539</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-540"><a href="#NSSession-540"><span class="linenos"> 540</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-541"><a href="#NSSession-541"><span class="linenos"> 541</span></a>        <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-542"><a href="#NSSession-542"><span class="linenos"> 542</span></a>        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-543"><a href="#NSSession-543"><span class="linenos"> 543</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-544"><a href="#NSSession-544"><span class="linenos"> 544</span></a>        <span class="n">category</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="NSSession-545"><a href="#NSSession-545"><span class="linenos"> 545</span></a>        <span class="n">subcategory</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="NSSession-546"><a href="#NSSession-546"><span class="linenos"> 546</span></a>        <span class="n">dispatchid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="NSSession-547"><a href="#NSSession-547"><span class="linenos"> 547</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-548"><a href="#NSSession-548"><span class="linenos"> 548</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-549"><a href="#NSSession-549"><span class="linenos"> 549</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession-550"><a href="#NSSession-550"><span class="linenos"> 550</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add, edit, or remove a dispatch.</span>
</span><span id="NSSession-551"><a href="#NSSession-551"><span class="linenos"> 551</span></a>
</span><span id="NSSession-552"><a href="#NSSession-552"><span class="linenos"> 552</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-553"><a href="#NSSession-553"><span class="linenos"> 553</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession-554"><a href="#NSSession-554"><span class="linenos"> 554</span></a><span class="sd">            action (str): The action to take. Must be &quot;add&quot;, &quot;edit&quot;, &quot;remove&quot;</span>
</span><span id="NSSession-555"><a href="#NSSession-555"><span class="linenos"> 555</span></a><span class="sd">            title (str, optional): The dispatch title when adding or editing.</span>
</span><span id="NSSession-556"><a href="#NSSession-556"><span class="linenos"> 556</span></a><span class="sd">            text (str, optional): The dispatch text when adding or editing.</span>
</span><span id="NSSession-557"><a href="#NSSession-557"><span class="linenos"> 557</span></a><span class="sd">            category: (int, optional), The category ID when adding or editing.</span>
</span><span id="NSSession-558"><a href="#NSSession-558"><span class="linenos"> 558</span></a><span class="sd">            subcategory (int, optional): The subcategory ID when adding or editing.</span>
</span><span id="NSSession-559"><a href="#NSSession-559"><span class="linenos"> 559</span></a><span class="sd">            dispatchid (int, optional): The dispatch ID when editing or removing.</span>
</span><span id="NSSession-560"><a href="#NSSession-560"><span class="linenos"> 560</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession-561"><a href="#NSSession-561"><span class="linenos"> 561</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession-562"><a href="#NSSession-562"><span class="linenos"> 562</span></a>
</span><span id="NSSession-563"><a href="#NSSession-563"><span class="linenos"> 563</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-564"><a href="#NSSession-564"><span class="linenos"> 564</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession-565"><a href="#NSSession-565"><span class="linenos"> 565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-566"><a href="#NSSession-566"><span class="linenos"> 566</span></a>        <span class="c1"># TODO: maybe consider splitting these three functions?</span>
</span><span id="NSSession-567"><a href="#NSSession-567"><span class="linenos"> 567</span></a>        <span class="c1"># TODO: maybe create enums for category and subcategory</span>
</span><span id="NSSession-568"><a href="#NSSession-568"><span class="linenos"> 568</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="s2">&quot;remove&quot;</span><span class="p">}:</span>
</span><span id="NSSession-569"><a href="#NSSession-569"><span class="linenos"> 569</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;action must be &#39;add&#39;, &#39;edit&#39;, or &#39;remove&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession-570"><a href="#NSSession-570"><span class="linenos"> 570</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="o">!=</span> <span class="s2">&quot;remove&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">({</span><span class="n">title</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">subcategory</span><span class="p">}):</span>
</span><span id="NSSession-571"><a href="#NSSession-571"><span class="linenos"> 571</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify title, text, category, and subcategory&quot;</span><span class="p">)</span>
</span><span id="NSSession-572"><a href="#NSSession-572"><span class="linenos"> 572</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="o">!=</span> <span class="s2">&quot;add&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dispatchid</span><span class="p">:</span>
</span><span id="NSSession-573"><a href="#NSSession-573"><span class="linenos"> 573</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify a dispatch id&quot;</span><span class="p">)</span>
</span><span id="NSSession-574"><a href="#NSSession-574"><span class="linenos"> 574</span></a>
</span><span id="NSSession-575"><a href="#NSSession-575"><span class="linenos"> 575</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dispatch&quot;</span><span class="p">:</span> <span class="n">action</span><span class="p">}</span>
</span><span id="NSSession-576"><a href="#NSSession-576"><span class="linenos"> 576</span></a>        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
</span><span id="NSSession-577"><a href="#NSSession-577"><span class="linenos"> 577</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
</span><span id="NSSession-578"><a href="#NSSession-578"><span class="linenos"> 578</span></a>        <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
</span><span id="NSSession-579"><a href="#NSSession-579"><span class="linenos"> 579</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="NSSession-580"><a href="#NSSession-580"><span class="linenos"> 580</span></a>        <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
</span><span id="NSSession-581"><a href="#NSSession-581"><span class="linenos"> 581</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
</span><span id="NSSession-582"><a href="#NSSession-582"><span class="linenos"> 582</span></a>        <span class="k">if</span> <span class="n">subcategory</span><span class="p">:</span>
</span><span id="NSSession-583"><a href="#NSSession-583"><span class="linenos"> 583</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;subcategory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subcategory</span>
</span><span id="NSSession-584"><a href="#NSSession-584"><span class="linenos"> 584</span></a>        <span class="k">if</span> <span class="n">dispatchid</span><span class="p">:</span>
</span><span id="NSSession-585"><a href="#NSSession-585"><span class="linenos"> 585</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;dispatchid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dispatchid</span>
</span><span id="NSSession-586"><a href="#NSSession-586"><span class="linenos"> 586</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span>
</span><span id="NSSession-587"><a href="#NSSession-587"><span class="linenos"> 587</span></a>            <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;dispatch&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="o">=</span><span class="n">constant_rate_limit</span>
</span><span id="NSSession-588"><a href="#NSSession-588"><span class="linenos"> 588</span></a>        <span class="p">)</span>
</span><span id="NSSession-589"><a href="#NSSession-589"><span class="linenos"> 589</span></a>
</span><span id="NSSession-590"><a href="#NSSession-590"><span class="linenos"> 590</span></a>    <span class="k">def</span> <span class="nf">api_rmb</span><span class="p">(</span>
</span><span id="NSSession-591"><a href="#NSSession-591"><span class="linenos"> 591</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-592"><a href="#NSSession-592"><span class="linenos"> 592</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-593"><a href="#NSSession-593"><span class="linenos"> 593</span></a>        <span class="n">region</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-594"><a href="#NSSession-594"><span class="linenos"> 594</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-595"><a href="#NSSession-595"><span class="linenos"> 595</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-596"><a href="#NSSession-596"><span class="linenos"> 596</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-597"><a href="#NSSession-597"><span class="linenos"> 597</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession-598"><a href="#NSSession-598"><span class="linenos"> 598</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Post a message on the regional message board via the API.</span>
</span><span id="NSSession-599"><a href="#NSSession-599"><span class="linenos"> 599</span></a>
</span><span id="NSSession-600"><a href="#NSSession-600"><span class="linenos"> 600</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-601"><a href="#NSSession-601"><span class="linenos"> 601</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession-602"><a href="#NSSession-602"><span class="linenos"> 602</span></a><span class="sd">            region (str): the region to post the message in.</span>
</span><span id="NSSession-603"><a href="#NSSession-603"><span class="linenos"> 603</span></a><span class="sd">            text (str): the text to post.</span>
</span><span id="NSSession-604"><a href="#NSSession-604"><span class="linenos"> 604</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession-605"><a href="#NSSession-605"><span class="linenos"> 605</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession-606"><a href="#NSSession-606"><span class="linenos"> 606</span></a>
</span><span id="NSSession-607"><a href="#NSSession-607"><span class="linenos"> 607</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-608"><a href="#NSSession-608"><span class="linenos"> 608</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession-609"><a href="#NSSession-609"><span class="linenos"> 609</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-610"><a href="#NSSession-610"><span class="linenos"> 610</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">}</span>
</span><span id="NSSession-611"><a href="#NSSession-611"><span class="linenos"> 611</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span>
</span><span id="NSSession-612"><a href="#NSSession-612"><span class="linenos"> 612</span></a>            <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;rmbpost&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="o">=</span><span class="n">constant_rate_limit</span>
</span><span id="NSSession-613"><a href="#NSSession-613"><span class="linenos"> 613</span></a>        <span class="p">)</span>
</span><span id="NSSession-614"><a href="#NSSession-614"><span class="linenos"> 614</span></a>
</span><span id="NSSession-615"><a href="#NSSession-615"><span class="linenos"> 615</span></a>    <span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-616"><a href="#NSSession-616"><span class="linenos"> 616</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Logs in to the nationstates site.</span>
</span><span id="NSSession-617"><a href="#NSSession-617"><span class="linenos"> 617</span></a>
</span><span id="NSSession-618"><a href="#NSSession-618"><span class="linenos"> 618</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-619"><a href="#NSSession-619"><span class="linenos"> 619</span></a><span class="sd">            nation (str): Nation name</span>
</span><span id="NSSession-620"><a href="#NSSession-620"><span class="linenos"> 620</span></a><span class="sd">            password (str): Nation password</span>
</span><span id="NSSession-621"><a href="#NSSession-621"><span class="linenos"> 621</span></a>
</span><span id="NSSession-622"><a href="#NSSession-622"><span class="linenos"> 622</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-623"><a href="#NSSession-623"><span class="linenos"> 623</span></a><span class="sd">            bool: True if login was successful, False otherwise</span>
</span><span id="NSSession-624"><a href="#NSSession-624"><span class="linenos"> 624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-625"><a href="#NSSession-625"><span class="linenos"> 625</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logging in to </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-626"><a href="#NSSession-626"><span class="linenos"> 626</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/page=display_region/region=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth_region</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-627"><a href="#NSSession-627"><span class="linenos"> 627</span></a>        <span class="c1"># shoutouts to roavin for telling me i had to have page=display_region in the url so it&#39;d work with a userclick parameter</span>
</span><span id="NSSession-628"><a href="#NSSession-628"><span class="linenos"> 628</span></a>
</span><span id="NSSession-629"><a href="#NSSession-629"><span class="linenos"> 629</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-630"><a href="#NSSession-630"><span class="linenos"> 630</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span>
</span><span id="NSSession-631"><a href="#NSSession-631"><span class="linenos"> 631</span></a>            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="NSSession-632"><a href="#NSSession-632"><span class="linenos"> 632</span></a>            <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="s2">&quot;century&quot;</span><span class="p">,</span>
</span><span id="NSSession-633"><a href="#NSSession-633"><span class="linenos"> 633</span></a>            <span class="s2">&quot;logging_in&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-634"><a href="#NSSession-634"><span class="linenos"> 634</span></a>            <span class="s2">&quot;submit&quot;</span><span class="p">:</span> <span class="s2">&quot;Login&quot;</span><span class="p">,</span>
</span><span id="NSSession-635"><a href="#NSSession-635"><span class="linenos"> 635</span></a>        <span class="p">}</span>
</span><span id="NSSession-636"><a href="#NSSession-636"><span class="linenos"> 636</span></a>
</span><span id="NSSession-637"><a href="#NSSession-637"><span class="linenos"> 637</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-638"><a href="#NSSession-638"><span class="linenos"> 638</span></a>
</span><span id="NSSession-639"><a href="#NSSession-639"><span class="linenos"> 639</span></a>        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
</span><span id="NSSession-640"><a href="#NSSession-640"><span class="linenos"> 640</span></a>        <span class="c1"># checks if the body tag has your nation name in it; if it does, you&#39;re logged in</span>
</span><span id="NSSession-641"><a href="#NSSession-641"><span class="linenos"> 641</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;data-nname&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)}):</span>
</span><span id="NSSession-642"><a href="#NSSession-642"><span class="linenos"> 642</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="NSSession-643"><a href="#NSSession-643"><span class="linenos"> 643</span></a>
</span><span id="NSSession-644"><a href="#NSSession-644"><span class="linenos"> 644</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nation</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span>
</span><span id="NSSession-645"><a href="#NSSession-645"><span class="linenos"> 645</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="NSSession-646"><a href="#NSSession-646"><span class="linenos"> 646</span></a>
</span><span id="NSSession-647"><a href="#NSSession-647"><span class="linenos"> 647</span></a>    <span class="k">def</span> <span class="nf">change_nation_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-648"><a href="#NSSession-648"><span class="linenos"> 648</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the nation flag to the given image.</span>
</span><span id="NSSession-649"><a href="#NSSession-649"><span class="linenos"> 649</span></a>
</span><span id="NSSession-650"><a href="#NSSession-650"><span class="linenos"> 650</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-651"><a href="#NSSession-651"><span class="linenos"> 651</span></a><span class="sd">            flag_filename (str): Filename of the flag to change to</span>
</span><span id="NSSession-652"><a href="#NSSession-652"><span class="linenos"> 652</span></a>
</span><span id="NSSession-653"><a href="#NSSession-653"><span class="linenos"> 653</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-654"><a href="#NSSession-654"><span class="linenos"> 654</span></a><span class="sd">            bool: True if the flag was changed, False otherwise</span>
</span><span id="NSSession-655"><a href="#NSSession-655"><span class="linenos"> 655</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-656"><a href="#NSSession-656"><span class="linenos"> 656</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changing flag on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-657"><a href="#NSSession-657"><span class="linenos"> 657</span></a>        <span class="c1"># THIS WAS SO FUCKING FRUSTRATING BUT IT WORKS NOW AND IM NEVER TOUCHING THIS BULLSHIT UNLESS NS BREAKS IT AGAIN</span>
</span><span id="NSSession-658"><a href="#NSSession-658"><span class="linenos"> 658</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/upload.cgi&quot;</span>
</span><span id="NSSession-659"><a href="#NSSession-659"><span class="linenos"> 659</span></a>
</span><span id="NSSession-660"><a href="#NSSession-660"><span class="linenos"> 660</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-661"><a href="#NSSession-661"><span class="linenos"> 661</span></a>            <span class="s2">&quot;nationname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="p">,</span>
</span><span id="NSSession-662"><a href="#NSSession-662"><span class="linenos"> 662</span></a>        <span class="p">}</span>
</span><span id="NSSession-663"><a href="#NSSession-663"><span class="linenos"> 663</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-664"><a href="#NSSession-664"><span class="linenos"> 664</span></a>            <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="NSSession-665"><a href="#NSSession-665"><span class="linenos"> 665</span></a>                <span class="n">flag_filename</span><span class="p">,</span>
</span><span id="NSSession-666"><a href="#NSSession-666"><span class="linenos"> 666</span></a>                <span class="nb">open</span><span class="p">(</span><span class="n">flag_filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">),</span>
</span><span id="NSSession-667"><a href="#NSSession-667"><span class="linenos"> 667</span></a>                <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">flag_filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="NSSession-668"><a href="#NSSession-668"><span class="linenos"> 668</span></a>            <span class="p">)</span>
</span><span id="NSSession-669"><a href="#NSSession-669"><span class="linenos"> 669</span></a>        <span class="p">}</span>
</span><span id="NSSession-670"><a href="#NSSession-670"><span class="linenos"> 670</span></a>
</span><span id="NSSession-671"><a href="#NSSession-671"><span class="linenos"> 671</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="NSSession-672"><a href="#NSSession-672"><span class="linenos"> 672</span></a>
</span><span id="NSSession-673"><a href="#NSSession-673"><span class="linenos"> 673</span></a>        <span class="k">if</span> <span class="s2">&quot;page=settings&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]:</span>
</span><span id="NSSession-674"><a href="#NSSession-674"><span class="linenos"> 674</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="NSSession-675"><a href="#NSSession-675"><span class="linenos"> 675</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="NSSession-676"><a href="#NSSession-676"><span class="linenos"> 676</span></a>        <span class="k">elif</span> <span class="s2">&quot;Just a moment...&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span><span id="NSSession-677"><a href="#NSSession-677"><span class="linenos"> 677</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="NSSession-678"><a href="#NSSession-678"><span class="linenos"> 678</span></a>                <span class="s2">&quot;Cloudflare blocked you idiot get fucked have fun with that like I had to lmaoooooooooo&quot;</span>
</span><span id="NSSession-679"><a href="#NSSession-679"><span class="linenos"> 679</span></a>            <span class="p">)</span>
</span><span id="NSSession-680"><a href="#NSSession-680"><span class="linenos"> 680</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="NSSession-681"><a href="#NSSession-681"><span class="linenos"> 681</span></a>
</span><span id="NSSession-682"><a href="#NSSession-682"><span class="linenos"> 682</span></a>    <span class="k">def</span> <span class="nf">change_nation_settings</span><span class="p">(</span>
</span><span id="NSSession-683"><a href="#NSSession-683"><span class="linenos"> 683</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-684"><a href="#NSSession-684"><span class="linenos"> 684</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="NSSession-685"><a href="#NSSession-685"><span class="linenos"> 685</span></a>        <span class="n">email</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-686"><a href="#NSSession-686"><span class="linenos"> 686</span></a>        <span class="n">pretitle</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-687"><a href="#NSSession-687"><span class="linenos"> 687</span></a>        <span class="n">slogan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-688"><a href="#NSSession-688"><span class="linenos"> 688</span></a>        <span class="n">currency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-689"><a href="#NSSession-689"><span class="linenos"> 689</span></a>        <span class="n">animal</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-690"><a href="#NSSession-690"><span class="linenos"> 690</span></a>        <span class="n">demonym_noun</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-691"><a href="#NSSession-691"><span class="linenos"> 691</span></a>        <span class="n">demonym_adjective</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-692"><a href="#NSSession-692"><span class="linenos"> 692</span></a>        <span class="n">demonym_plural</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-693"><a href="#NSSession-693"><span class="linenos"> 693</span></a>        <span class="n">new_password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-694"><a href="#NSSession-694"><span class="linenos"> 694</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-695"><a href="#NSSession-695"><span class="linenos"> 695</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a logged in session, changes customizable fields and settings of the logged in nation.</span>
</span><span id="NSSession-696"><a href="#NSSession-696"><span class="linenos"> 696</span></a><span class="sd">        Variables must be explicitly named in the call to the function, e.g. &quot;session.change_nation_settings(pretitle=&#39;Join Lily&#39;, currency=&#39;Join Lily&#39;)&quot;</span>
</span><span id="NSSession-697"><a href="#NSSession-697"><span class="linenos"> 697</span></a>
</span><span id="NSSession-698"><a href="#NSSession-698"><span class="linenos"> 698</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-699"><a href="#NSSession-699"><span class="linenos"> 699</span></a><span class="sd">            email (str, optional): New email for WA apps.</span>
</span><span id="NSSession-700"><a href="#NSSession-700"><span class="linenos"> 700</span></a><span class="sd">            pretitle (str, optional): New pretitle of the nation. Max length of 28. Nation must have minimum population of 250 million.</span>
</span><span id="NSSession-701"><a href="#NSSession-701"><span class="linenos"> 701</span></a><span class="sd">            slogan (str, optional): New Slogan/Motto of the nation. Max length of 55.</span>
</span><span id="NSSession-702"><a href="#NSSession-702"><span class="linenos"> 702</span></a><span class="sd">            currency (str, optional): New currency of the nation. Max length of 40.</span>
</span><span id="NSSession-703"><a href="#NSSession-703"><span class="linenos"> 703</span></a><span class="sd">            animal (str, optional): New national animal of the nation. Max length of 40.</span>
</span><span id="NSSession-704"><a href="#NSSession-704"><span class="linenos"> 704</span></a><span class="sd">            demonym_noun (str, optional): Noun the nation will refer to its citizens as. Max length of 44.</span>
</span><span id="NSSession-705"><a href="#NSSession-705"><span class="linenos"> 705</span></a><span class="sd">            demonym_adjective (str, optional): Adjective the nation will refer to its citizens as. Max length of 44.</span>
</span><span id="NSSession-706"><a href="#NSSession-706"><span class="linenos"> 706</span></a><span class="sd">            demonym_plural (str, optional): Plural form of &quot;demonym_noun&quot;. Max length of 44.</span>
</span><span id="NSSession-707"><a href="#NSSession-707"><span class="linenos"> 707</span></a><span class="sd">            new_password (str, optional): New password to assign to the nation.</span>
</span><span id="NSSession-708"><a href="#NSSession-708"><span class="linenos"> 708</span></a>
</span><span id="NSSession-709"><a href="#NSSession-709"><span class="linenos"> 709</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-710"><a href="#NSSession-710"><span class="linenos"> 710</span></a><span class="sd">            bool: True if changes were successful, False otherwise.</span>
</span><span id="NSSession-711"><a href="#NSSession-711"><span class="linenos"> 711</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-712"><a href="#NSSession-712"><span class="linenos"> 712</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changing settings on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-713"><a href="#NSSession-713"><span class="linenos"> 713</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=settings&quot;</span>
</span><span id="NSSession-714"><a href="#NSSession-714"><span class="linenos"> 714</span></a>
</span><span id="NSSession-715"><a href="#NSSession-715"><span class="linenos"> 715</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-716"><a href="#NSSession-716"><span class="linenos"> 716</span></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pretitle</span><span class="p">,</span>
</span><span id="NSSession-717"><a href="#NSSession-717"><span class="linenos"> 717</span></a>            <span class="s2">&quot;slogan&quot;</span><span class="p">:</span> <span class="n">slogan</span><span class="p">,</span>
</span><span id="NSSession-718"><a href="#NSSession-718"><span class="linenos"> 718</span></a>            <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="n">currency</span><span class="p">,</span>
</span><span id="NSSession-719"><a href="#NSSession-719"><span class="linenos"> 719</span></a>            <span class="s2">&quot;animal&quot;</span><span class="p">:</span> <span class="n">animal</span><span class="p">,</span>
</span><span id="NSSession-720"><a href="#NSSession-720"><span class="linenos"> 720</span></a>            <span class="s2">&quot;demonym2&quot;</span><span class="p">:</span> <span class="n">demonym_noun</span><span class="p">,</span>
</span><span id="NSSession-721"><a href="#NSSession-721"><span class="linenos"> 721</span></a>            <span class="s2">&quot;demonym&quot;</span><span class="p">:</span> <span class="n">demonym_adjective</span><span class="p">,</span>
</span><span id="NSSession-722"><a href="#NSSession-722"><span class="linenos"> 722</span></a>            <span class="s2">&quot;demonym2pl&quot;</span><span class="p">:</span> <span class="n">demonym_plural</span><span class="p">,</span>
</span><span id="NSSession-723"><a href="#NSSession-723"><span class="linenos"> 723</span></a>            <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="n">email</span><span class="p">,</span>
</span><span id="NSSession-724"><a href="#NSSession-724"><span class="linenos"> 724</span></a>            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">new_password</span><span class="p">,</span>
</span><span id="NSSession-725"><a href="#NSSession-725"><span class="linenos"> 725</span></a>            <span class="s2">&quot;confirm_password&quot;</span><span class="p">:</span> <span class="n">new_password</span><span class="p">,</span>
</span><span id="NSSession-726"><a href="#NSSession-726"><span class="linenos"> 726</span></a>            <span class="s2">&quot;update&quot;</span><span class="p">:</span> <span class="s2">&quot; Update &quot;</span><span class="p">,</span>
</span><span id="NSSession-727"><a href="#NSSession-727"><span class="linenos"> 727</span></a>        <span class="p">}</span>
</span><span id="NSSession-728"><a href="#NSSession-728"><span class="linenos"> 728</span></a>        <span class="c1"># remove keys that have empty values</span>
</span><span id="NSSession-729"><a href="#NSSession-729"><span class="linenos"> 729</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">}</span>
</span><span id="NSSession-730"><a href="#NSSession-730"><span class="linenos"> 730</span></a>        <span class="c1"># make sure everything is following the proper length limits and only contains acceptable characters</span>
</span><span id="NSSession-731"><a href="#NSSession-731"><span class="linenos"> 731</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_fields</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-732"><a href="#NSSession-732"><span class="linenos"> 732</span></a>
</span><span id="NSSession-733"><a href="#NSSession-733"><span class="linenos"> 733</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-734"><a href="#NSSession-734"><span class="linenos"> 734</span></a>        <span class="k">return</span> <span class="s2">&quot;Your settings have been successfully updated.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-735"><a href="#NSSession-735"><span class="linenos"> 735</span></a>
</span><span id="NSSession-736"><a href="#NSSession-736"><span class="linenos"> 736</span></a>    <span class="k">def</span> <span class="nf">move_to_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-737"><a href="#NSSession-737"><span class="linenos"> 737</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Moves the nation to the given region.</span>
</span><span id="NSSession-738"><a href="#NSSession-738"><span class="linenos"> 738</span></a>
</span><span id="NSSession-739"><a href="#NSSession-739"><span class="linenos"> 739</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-740"><a href="#NSSession-740"><span class="linenos"> 740</span></a><span class="sd">            region (str): Region to move to</span>
</span><span id="NSSession-741"><a href="#NSSession-741"><span class="linenos"> 741</span></a><span class="sd">            password (str, optional): Region password, if the region is passworded</span>
</span><span id="NSSession-742"><a href="#NSSession-742"><span class="linenos"> 742</span></a>
</span><span id="NSSession-743"><a href="#NSSession-743"><span class="linenos"> 743</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-744"><a href="#NSSession-744"><span class="linenos"> 744</span></a><span class="sd">            bool: True if the move was successful, False otherwise</span>
</span><span id="NSSession-745"><a href="#NSSession-745"><span class="linenos"> 745</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-746"><a href="#NSSession-746"><span class="linenos"> 746</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-747"><a href="#NSSession-747"><span class="linenos"> 747</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=change_region&quot;</span>
</span><span id="NSSession-748"><a href="#NSSession-748"><span class="linenos"> 748</span></a>
</span><span id="NSSession-749"><a href="#NSSession-749"><span class="linenos"> 749</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;region_name&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span> <span class="s2">&quot;move_region&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-750"><a href="#NSSession-750"><span class="linenos"> 750</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession-751"><a href="#NSSession-751"><span class="linenos"> 751</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="NSSession-752"><a href="#NSSession-752"><span class="linenos"> 752</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-753"><a href="#NSSession-753"><span class="linenos"> 753</span></a>
</span><span id="NSSession-754"><a href="#NSSession-754"><span class="linenos"> 754</span></a>        <span class="k">if</span> <span class="s2">&quot;Success!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span><span id="NSSession-755"><a href="#NSSession-755"><span class="linenos"> 755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
</span><span id="NSSession-756"><a href="#NSSession-756"><span class="linenos"> 756</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="NSSession-757"><a href="#NSSession-757"><span class="linenos"> 757</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="NSSession-758"><a href="#NSSession-758"><span class="linenos"> 758</span></a>
</span><span id="NSSession-759"><a href="#NSSession-759"><span class="linenos"> 759</span></a>    <span class="k">def</span> <span class="nf">vote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pollid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-760"><a href="#NSSession-760"><span class="linenos"> 760</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Votes on a poll.</span>
</span><span id="NSSession-761"><a href="#NSSession-761"><span class="linenos"> 761</span></a>
</span><span id="NSSession-762"><a href="#NSSession-762"><span class="linenos"> 762</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-763"><a href="#NSSession-763"><span class="linenos"> 763</span></a><span class="sd">            pollid (str): ID of the poll to vote on, e.g. &quot;199747&quot;</span>
</span><span id="NSSession-764"><a href="#NSSession-764"><span class="linenos"> 764</span></a><span class="sd">            option (str): Option to vote for (starts at 0)</span>
</span><span id="NSSession-765"><a href="#NSSession-765"><span class="linenos"> 765</span></a>
</span><span id="NSSession-766"><a href="#NSSession-766"><span class="linenos"> 766</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-767"><a href="#NSSession-767"><span class="linenos"> 767</span></a><span class="sd">            bool: True if the vote was successful, False otherwise</span>
</span><span id="NSSession-768"><a href="#NSSession-768"><span class="linenos"> 768</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-769"><a href="#NSSession-769"><span class="linenos"> 769</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Voting on poll </span><span class="si">{</span><span class="n">pollid</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-770"><a href="#NSSession-770"><span class="linenos"> 770</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=poll/p=</span><span class="si">{</span><span class="n">pollid</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-771"><a href="#NSSession-771"><span class="linenos"> 771</span></a>
</span><span id="NSSession-772"><a href="#NSSession-772"><span class="linenos"> 772</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;pollid&quot;</span><span class="p">:</span> <span class="n">pollid</span><span class="p">,</span> <span class="s2">&quot;q1&quot;</span><span class="p">:</span> <span class="n">option</span><span class="p">,</span> <span class="s2">&quot;poll_submit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-773"><a href="#NSSession-773"><span class="linenos"> 773</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-774"><a href="#NSSession-774"><span class="linenos"> 774</span></a>
</span><span id="NSSession-775"><a href="#NSSession-775"><span class="linenos"> 775</span></a>        <span class="k">return</span> <span class="s2">&quot;Your vote has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-776"><a href="#NSSession-776"><span class="linenos"> 776</span></a>
</span><span id="NSSession-777"><a href="#NSSession-777"><span class="linenos"> 777</span></a>    <span class="c1"># below are functions that are related to the WA</span>
</span><span id="NSSession-778"><a href="#NSSession-778"><span class="linenos"> 778</span></a>
</span><span id="NSSession-779"><a href="#NSSession-779"><span class="linenos"> 779</span></a>    <span class="k">def</span> <span class="nf">join_wa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-780"><a href="#NSSession-780"><span class="linenos"> 780</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Joins the WA with the given nation.</span>
</span><span id="NSSession-781"><a href="#NSSession-781"><span class="linenos"> 781</span></a>
</span><span id="NSSession-782"><a href="#NSSession-782"><span class="linenos"> 782</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-783"><a href="#NSSession-783"><span class="linenos"> 783</span></a><span class="sd">            nation (str): Nation to join the WA with</span>
</span><span id="NSSession-784"><a href="#NSSession-784"><span class="linenos"> 784</span></a><span class="sd">            app_id (str): ID of the WA application to use</span>
</span><span id="NSSession-785"><a href="#NSSession-785"><span class="linenos"> 785</span></a>
</span><span id="NSSession-786"><a href="#NSSession-786"><span class="linenos"> 786</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-787"><a href="#NSSession-787"><span class="linenos"> 787</span></a><span class="sd">            bool: True if the join was successful, False otherwise</span>
</span><span id="NSSession-788"><a href="#NSSession-788"><span class="linenos"> 788</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-789"><a href="#NSSession-789"><span class="linenos"> 789</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joining WA with </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-790"><a href="#NSSession-790"><span class="linenos"> 790</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/join_un.cgi&quot;</span>
</span><span id="NSSession-791"><a href="#NSSession-791"><span class="linenos"> 791</span></a>
</span><span id="NSSession-792"><a href="#NSSession-792"><span class="linenos"> 792</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span> <span class="s2">&quot;appid&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="o">.</span><span class="n">strip</span><span class="p">()}</span>
</span><span id="NSSession-793"><a href="#NSSession-793"><span class="linenos"> 793</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-794"><a href="#NSSession-794"><span class="linenos"> 794</span></a>
</span><span id="NSSession-795"><a href="#NSSession-795"><span class="linenos"> 795</span></a>        <span class="k">if</span> <span class="s2">&quot;?welcome=1&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]:</span>
</span><span id="NSSession-796"><a href="#NSSession-796"><span class="linenos"> 796</span></a>            <span class="c1"># since we&#39;re just getting thrown into a cgi script, we&#39;ll have to manually grab authentication values</span>
</span><span id="NSSession-797"><a href="#NSSession-797"><span class="linenos"> 797</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="NSSession-798"><a href="#NSSession-798"><span class="linenos"> 798</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="NSSession-799"><a href="#NSSession-799"><span class="linenos"> 799</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="NSSession-800"><a href="#NSSession-800"><span class="linenos"> 800</span></a>
</span><span id="NSSession-801"><a href="#NSSession-801"><span class="linenos"> 801</span></a>    <span class="k">def</span> <span class="nf">resign_wa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NSSession-802"><a href="#NSSession-802"><span class="linenos"> 802</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Resigns from the WA.</span>
</span><span id="NSSession-803"><a href="#NSSession-803"><span class="linenos"> 803</span></a>
</span><span id="NSSession-804"><a href="#NSSession-804"><span class="linenos"> 804</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-805"><a href="#NSSession-805"><span class="linenos"> 805</span></a><span class="sd">            bool: True if the resignation was successful, False otherwise</span>
</span><span id="NSSession-806"><a href="#NSSession-806"><span class="linenos"> 806</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-807"><a href="#NSSession-807"><span class="linenos"> 807</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Resigning from WA&quot;</span><span class="p">)</span>
</span><span id="NSSession-808"><a href="#NSSession-808"><span class="linenos"> 808</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=UN_status&quot;</span>
</span><span id="NSSession-809"><a href="#NSSession-809"><span class="linenos"> 809</span></a>
</span><span id="NSSession-810"><a href="#NSSession-810"><span class="linenos"> 810</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;leave_UN&quot;</span><span class="p">,</span> <span class="s2">&quot;submit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-811"><a href="#NSSession-811"><span class="linenos"> 811</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-812"><a href="#NSSession-812"><span class="linenos"> 812</span></a>
</span><span id="NSSession-813"><a href="#NSSession-813"><span class="linenos"> 813</span></a>        <span class="k">return</span> <span class="s2">&quot;From this moment forward, your nation is on its own.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-814"><a href="#NSSession-814"><span class="linenos"> 814</span></a>
</span><span id="NSSession-815"><a href="#NSSession-815"><span class="linenos"> 815</span></a>    <span class="k">def</span> <span class="nf">apply_wa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reapply</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-816"><a href="#NSSession-816"><span class="linenos"> 816</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies to the WA.</span>
</span><span id="NSSession-817"><a href="#NSSession-817"><span class="linenos"> 817</span></a>
</span><span id="NSSession-818"><a href="#NSSession-818"><span class="linenos"> 818</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-819"><a href="#NSSession-819"><span class="linenos"> 819</span></a><span class="sd">            reapply (bool, optional): Whether to reapply if you&#39;ve been sent an application that&#39;s still valid. Defaults to True.</span>
</span><span id="NSSession-820"><a href="#NSSession-820"><span class="linenos"> 820</span></a>
</span><span id="NSSession-821"><a href="#NSSession-821"><span class="linenos"> 821</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-822"><a href="#NSSession-822"><span class="linenos"> 822</span></a><span class="sd">            bool: True if the application was successful, False otherwise</span>
</span><span id="NSSession-823"><a href="#NSSession-823"><span class="linenos"> 823</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-824"><a href="#NSSession-824"><span class="linenos"> 824</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying to WA with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-825"><a href="#NSSession-825"><span class="linenos"> 825</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=UN_status&quot;</span>
</span><span id="NSSession-826"><a href="#NSSession-826"><span class="linenos"> 826</span></a>
</span><span id="NSSession-827"><a href="#NSSession-827"><span class="linenos"> 827</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;join_UN&quot;</span><span class="p">}</span>
</span><span id="NSSession-828"><a href="#NSSession-828"><span class="linenos"> 828</span></a>        <span class="k">if</span> <span class="n">reapply</span><span class="p">:</span>
</span><span id="NSSession-829"><a href="#NSSession-829"><span class="linenos"> 829</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;resend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</span><span id="NSSession-830"><a href="#NSSession-830"><span class="linenos"> 830</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NSSession-831"><a href="#NSSession-831"><span class="linenos"> 831</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;submit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</span><span id="NSSession-832"><a href="#NSSession-832"><span class="linenos"> 832</span></a>
</span><span id="NSSession-833"><a href="#NSSession-833"><span class="linenos"> 833</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-834"><a href="#NSSession-834"><span class="linenos"> 834</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="NSSession-835"><a href="#NSSession-835"><span class="linenos"> 835</span></a>            <span class="s2">&quot;Your application to join the World Assembly has been received!&quot;</span>
</span><span id="NSSession-836"><a href="#NSSession-836"><span class="linenos"> 836</span></a>            <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-837"><a href="#NSSession-837"><span class="linenos"> 837</span></a>        <span class="p">)</span>
</span><span id="NSSession-838"><a href="#NSSession-838"><span class="linenos"> 838</span></a>
</span><span id="NSSession-839"><a href="#NSSession-839"><span class="linenos"> 839</span></a>    <span class="k">def</span> <span class="nf">endorse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endorse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-840"><a href="#NSSession-840"><span class="linenos"> 840</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Endorses the given nation.</span>
</span><span id="NSSession-841"><a href="#NSSession-841"><span class="linenos"> 841</span></a>
</span><span id="NSSession-842"><a href="#NSSession-842"><span class="linenos"> 842</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-843"><a href="#NSSession-843"><span class="linenos"> 843</span></a><span class="sd">            nation (str): Nation to endorse</span>
</span><span id="NSSession-844"><a href="#NSSession-844"><span class="linenos"> 844</span></a><span class="sd">            endorse (bool, optional): True=endorse, False=unendorse. Defaults to True.</span>
</span><span id="NSSession-845"><a href="#NSSession-845"><span class="linenos"> 845</span></a>
</span><span id="NSSession-846"><a href="#NSSession-846"><span class="linenos"> 846</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-847"><a href="#NSSession-847"><span class="linenos"> 847</span></a><span class="sd">            bool: True if the endorsement was successful, False otherwise</span>
</span><span id="NSSession-848"><a href="#NSSession-848"><span class="linenos"> 848</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-849"><a href="#NSSession-849"><span class="linenos"> 849</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="NSSession-850"><a href="#NSSession-850"><span class="linenos"> 850</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="s1">&#39;Unendorsing&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Endorsing&#39;</span><span class="p">)[</span><span class="n">endorse</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-851"><a href="#NSSession-851"><span class="linenos"> 851</span></a>        <span class="p">)</span>
</span><span id="NSSession-852"><a href="#NSSession-852"><span class="linenos"> 852</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/endorse.cgi&quot;</span>
</span><span id="NSSession-853"><a href="#NSSession-853"><span class="linenos"> 853</span></a>
</span><span id="NSSession-854"><a href="#NSSession-854"><span class="linenos"> 854</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-855"><a href="#NSSession-855"><span class="linenos"> 855</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span>
</span><span id="NSSession-856"><a href="#NSSession-856"><span class="linenos"> 856</span></a>            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;endorse&quot;</span> <span class="k">if</span> <span class="n">endorse</span> <span class="k">else</span> <span class="s2">&quot;unendorse&quot;</span><span class="p">,</span>
</span><span id="NSSession-857"><a href="#NSSession-857"><span class="linenos"> 857</span></a>        <span class="p">}</span>
</span><span id="NSSession-858"><a href="#NSSession-858"><span class="linenos"> 858</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-859"><a href="#NSSession-859"><span class="linenos"> 859</span></a>
</span><span id="NSSession-860"><a href="#NSSession-860"><span class="linenos"> 860</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;nation=</span><span class="si">{</span><span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>
</span><span id="NSSession-861"><a href="#NSSession-861"><span class="linenos"> 861</span></a>
</span><span id="NSSession-862"><a href="#NSSession-862"><span class="linenos"> 862</span></a>    <span class="k">def</span> <span class="nf">clear_dossier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-863"><a href="#NSSession-863"><span class="linenos"> 863</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clears a logged in nation&#39;s dossier.</span>
</span><span id="NSSession-864"><a href="#NSSession-864"><span class="linenos"> 864</span></a>
</span><span id="NSSession-865"><a href="#NSSession-865"><span class="linenos"> 865</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-866"><a href="#NSSession-866"><span class="linenos"> 866</span></a><span class="sd">            bool: Whether it was successful or not</span>
</span><span id="NSSession-867"><a href="#NSSession-867"><span class="linenos"> 867</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-868"><a href="#NSSession-868"><span class="linenos"> 868</span></a>
</span><span id="NSSession-869"><a href="#NSSession-869"><span class="linenos"> 869</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Clearing dossier on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-870"><a href="#NSSession-870"><span class="linenos"> 870</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=dossier&quot;</span>
</span><span id="NSSession-871"><a href="#NSSession-871"><span class="linenos"> 871</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;clear_dossier&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-872"><a href="#NSSession-872"><span class="linenos"> 872</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-873"><a href="#NSSession-873"><span class="linenos"> 873</span></a>
</span><span id="NSSession-874"><a href="#NSSession-874"><span class="linenos"> 874</span></a>        <span class="k">return</span> <span class="s2">&quot;Dossier cleared of nations.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-875"><a href="#NSSession-875"><span class="linenos"> 875</span></a>
</span><span id="NSSession-876"><a href="#NSSession-876"><span class="linenos"> 876</span></a>    <span class="k">def</span> <span class="nf">add_to_dossier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-877"><a href="#NSSession-877"><span class="linenos"> 877</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds nations to the logged in nation&#39;s dossier.</span>
</span><span id="NSSession-878"><a href="#NSSession-878"><span class="linenos"> 878</span></a>
</span><span id="NSSession-879"><a href="#NSSession-879"><span class="linenos"> 879</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-880"><a href="#NSSession-880"><span class="linenos"> 880</span></a><span class="sd">            nations (list[str] | str): List of nations to add, or a single nation</span>
</span><span id="NSSession-881"><a href="#NSSession-881"><span class="linenos"> 881</span></a>
</span><span id="NSSession-882"><a href="#NSSession-882"><span class="linenos"> 882</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-883"><a href="#NSSession-883"><span class="linenos"> 883</span></a><span class="sd">            bool: Whether it was successful or not</span>
</span><span id="NSSession-884"><a href="#NSSession-884"><span class="linenos"> 884</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-885"><a href="#NSSession-885"><span class="linenos"> 885</span></a>
</span><span id="NSSession-886"><a href="#NSSession-886"><span class="linenos"> 886</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">nations</span><span class="si">}</span><span class="s2"> to dossier on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-887"><a href="#NSSession-887"><span class="linenos"> 887</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/dossier.cgi&quot;</span>
</span><span id="NSSession-888"><a href="#NSSession-888"><span class="linenos"> 888</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-889"><a href="#NSSession-889"><span class="linenos"> 889</span></a>            <span class="s2">&quot;currentnation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="p">),</span>
</span><span id="NSSession-890"><a href="#NSSession-890"><span class="linenos"> 890</span></a>            <span class="s2">&quot;action_append&quot;</span><span class="p">:</span> <span class="s2">&quot;Upload Nation Dossier File&quot;</span><span class="p">,</span>
</span><span id="NSSession-891"><a href="#NSSession-891"><span class="linenos"> 891</span></a>        <span class="p">}</span>
</span><span id="NSSession-892"><a href="#NSSession-892"><span class="linenos"> 892</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-893"><a href="#NSSession-893"><span class="linenos"> 893</span></a>            <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="NSSession-894"><a href="#NSSession-894"><span class="linenos"> 894</span></a>                <span class="s2">&quot;dossier.txt&quot;</span><span class="p">,</span>
</span><span id="NSSession-895"><a href="#NSSession-895"><span class="linenos"> 895</span></a>                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nations</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">nations</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">nations</span><span class="p">,</span>
</span><span id="NSSession-896"><a href="#NSSession-896"><span class="linenos"> 896</span></a>                <span class="s2">&quot;text/plain&quot;</span><span class="p">,</span>
</span><span id="NSSession-897"><a href="#NSSession-897"><span class="linenos"> 897</span></a>            <span class="p">),</span>
</span><span id="NSSession-898"><a href="#NSSession-898"><span class="linenos"> 898</span></a>        <span class="p">}</span>
</span><span id="NSSession-899"><a href="#NSSession-899"><span class="linenos"> 899</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="NSSession-900"><a href="#NSSession-900"><span class="linenos"> 900</span></a>
</span><span id="NSSession-901"><a href="#NSSession-901"><span class="linenos"> 901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="NSSession-902"><a href="#NSSession-902"><span class="linenos"> 902</span></a>        <span class="k">return</span> <span class="s2">&quot;appended=&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>
</span><span id="NSSession-903"><a href="#NSSession-903"><span class="linenos"> 903</span></a>
</span><span id="NSSession-904"><a href="#NSSession-904"><span class="linenos"> 904</span></a>    <span class="k">def</span> <span class="nf">wa_vote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">council</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">vote</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-905"><a href="#NSSession-905"><span class="linenos"> 905</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Votes on the current WA resolution.</span>
</span><span id="NSSession-906"><a href="#NSSession-906"><span class="linenos"> 906</span></a>
</span><span id="NSSession-907"><a href="#NSSession-907"><span class="linenos"> 907</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-908"><a href="#NSSession-908"><span class="linenos"> 908</span></a><span class="sd">            council (str): Must be &quot;ga&quot; for general assembly, &quot;sc&quot; for security council.</span>
</span><span id="NSSession-909"><a href="#NSSession-909"><span class="linenos"> 909</span></a><span class="sd">            vote (str): Must be &quot;for&quot; or &quot;against&quot;.</span>
</span><span id="NSSession-910"><a href="#NSSession-910"><span class="linenos"> 910</span></a>
</span><span id="NSSession-911"><a href="#NSSession-911"><span class="linenos"> 911</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-912"><a href="#NSSession-912"><span class="linenos"> 912</span></a><span class="sd">            bool: Whether the vote was successful or not</span>
</span><span id="NSSession-913"><a href="#NSSession-913"><span class="linenos"> 913</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-914"><a href="#NSSession-914"><span class="linenos"> 914</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="NSSession-915"><a href="#NSSession-915"><span class="linenos"> 915</span></a>            <span class="sa">f</span><span class="s2">&quot;Voting </span><span class="si">{</span><span class="n">vote</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">council</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> resolution with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-916"><a href="#NSSession-916"><span class="linenos"> 916</span></a>        <span class="p">)</span>
</span><span id="NSSession-917"><a href="#NSSession-917"><span class="linenos"> 917</span></a>        <span class="k">if</span> <span class="n">council</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;ga&quot;</span><span class="p">,</span> <span class="s2">&quot;sc&quot;</span><span class="p">}:</span>
</span><span id="NSSession-918"><a href="#NSSession-918"><span class="linenos"> 918</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;council must be &#39;ga&#39; or &#39;sc&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession-919"><a href="#NSSession-919"><span class="linenos"> 919</span></a>        <span class="k">if</span> <span class="n">vote</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;for&quot;</span><span class="p">,</span> <span class="s2">&quot;against&quot;</span><span class="p">}:</span>
</span><span id="NSSession-920"><a href="#NSSession-920"><span class="linenos"> 920</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;vote must be &#39;for&#39; or &#39;against&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession-921"><a href="#NSSession-921"><span class="linenos"> 921</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Voting on WA resolution&quot;</span><span class="p">)</span>
</span><span id="NSSession-922"><a href="#NSSession-922"><span class="linenos"> 922</span></a>
</span><span id="NSSession-923"><a href="#NSSession-923"><span class="linenos"> 923</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=</span><span class="si">{</span><span class="n">council</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-924"><a href="#NSSession-924"><span class="linenos"> 924</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-925"><a href="#NSSession-925"><span class="linenos"> 925</span></a>            <span class="s2">&quot;vote&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Vote </span><span class="si">{</span><span class="n">vote</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="NSSession-926"><a href="#NSSession-926"><span class="linenos"> 926</span></a>        <span class="p">}</span>
</span><span id="NSSession-927"><a href="#NSSession-927"><span class="linenos"> 927</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-928"><a href="#NSSession-928"><span class="linenos"> 928</span></a>
</span><span id="NSSession-929"><a href="#NSSession-929"><span class="linenos"> 929</span></a>        <span class="k">return</span> <span class="s2">&quot;Your vote has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-930"><a href="#NSSession-930"><span class="linenos"> 930</span></a>
</span><span id="NSSession-931"><a href="#NSSession-931"><span class="linenos"> 931</span></a>    <span class="k">def</span> <span class="nf">refound_nation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-932"><a href="#NSSession-932"><span class="linenos"> 932</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Refounds a nation.</span>
</span><span id="NSSession-933"><a href="#NSSession-933"><span class="linenos"> 933</span></a>
</span><span id="NSSession-934"><a href="#NSSession-934"><span class="linenos"> 934</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-935"><a href="#NSSession-935"><span class="linenos"> 935</span></a><span class="sd">            nation (str): Name of the nation to refound</span>
</span><span id="NSSession-936"><a href="#NSSession-936"><span class="linenos"> 936</span></a><span class="sd">            password (str): Password to the nation</span>
</span><span id="NSSession-937"><a href="#NSSession-937"><span class="linenos"> 937</span></a>
</span><span id="NSSession-938"><a href="#NSSession-938"><span class="linenos"> 938</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-939"><a href="#NSSession-939"><span class="linenos"> 939</span></a><span class="sd">            bool: Whether the nation was successfully refounded or not</span>
</span><span id="NSSession-940"><a href="#NSSession-940"><span class="linenos"> 940</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-941"><a href="#NSSession-941"><span class="linenos"> 941</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/&quot;</span>
</span><span id="NSSession-942"><a href="#NSSession-942"><span class="linenos"> 942</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-943"><a href="#NSSession-943"><span class="linenos"> 943</span></a>            <span class="s2">&quot;logging_in&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-944"><a href="#NSSession-944"><span class="linenos"> 944</span></a>            <span class="s2">&quot;restore_password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="NSSession-945"><a href="#NSSession-945"><span class="linenos"> 945</span></a>            <span class="s2">&quot;restore_nation&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-946"><a href="#NSSession-946"><span class="linenos"> 946</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">nation</span><span class="p">,</span>
</span><span id="NSSession-947"><a href="#NSSession-947"><span class="linenos"> 947</span></a>        <span class="p">}</span>
</span><span id="NSSession-948"><a href="#NSSession-948"><span class="linenos"> 948</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-949"><a href="#NSSession-949"><span class="linenos"> 949</span></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">302</span><span class="p">:</span>
</span><span id="NSSession-950"><a href="#NSSession-950"><span class="linenos"> 950</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nation</span> <span class="o">=</span> <span class="n">nation</span>
</span><span id="NSSession-951"><a href="#NSSession-951"><span class="linenos"> 951</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="NSSession-952"><a href="#NSSession-952"><span class="linenos"> 952</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="NSSession-953"><a href="#NSSession-953"><span class="linenos"> 953</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="NSSession-954"><a href="#NSSession-954"><span class="linenos"> 954</span></a>
</span><span id="NSSession-955"><a href="#NSSession-955"><span class="linenos"> 955</span></a>    <span class="c1"># methods for region control</span>
</span><span id="NSSession-956"><a href="#NSSession-956"><span class="linenos"> 956</span></a>
</span><span id="NSSession-957"><a href="#NSSession-957"><span class="linenos"> 957</span></a>    <span class="k">def</span> <span class="nf">create_region</span><span class="p">(</span>
</span><span id="NSSession-958"><a href="#NSSession-958"><span class="linenos"> 958</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession-959"><a href="#NSSession-959"><span class="linenos"> 959</span></a>        <span class="n">region_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-960"><a href="#NSSession-960"><span class="linenos"> 960</span></a>        <span class="n">wfe</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession-961"><a href="#NSSession-961"><span class="linenos"> 961</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="NSSession-962"><a href="#NSSession-962"><span class="linenos"> 962</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession-963"><a href="#NSSession-963"><span class="linenos"> 963</span></a>        <span class="n">frontier</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-964"><a href="#NSSession-964"><span class="linenos"> 964</span></a>        <span class="n">executive_delegacy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession-965"><a href="#NSSession-965"><span class="linenos"> 965</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-966"><a href="#NSSession-966"><span class="linenos"> 966</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a new region.</span>
</span><span id="NSSession-967"><a href="#NSSession-967"><span class="linenos"> 967</span></a>
</span><span id="NSSession-968"><a href="#NSSession-968"><span class="linenos"> 968</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-969"><a href="#NSSession-969"><span class="linenos"> 969</span></a><span class="sd">            region_name (str): Name of the region</span>
</span><span id="NSSession-970"><a href="#NSSession-970"><span class="linenos"> 970</span></a><span class="sd">            wfe (str): WFE of the region</span>
</span><span id="NSSession-971"><a href="#NSSession-971"><span class="linenos"> 971</span></a><span class="sd">            password (str, optional): Password to the region. Defaults to &quot;&quot;.</span>
</span><span id="NSSession-972"><a href="#NSSession-972"><span class="linenos"> 972</span></a><span class="sd">            frontier (bool, optional): Whether or not the region is a frontier. Defaults to False.</span>
</span><span id="NSSession-973"><a href="#NSSession-973"><span class="linenos"> 973</span></a><span class="sd">            executive_delegacy (bool, optional): Whether or not the region has an executive WA delegacy. Defaults to False. Ignored if frontier is True.</span>
</span><span id="NSSession-974"><a href="#NSSession-974"><span class="linenos"> 974</span></a>
</span><span id="NSSession-975"><a href="#NSSession-975"><span class="linenos"> 975</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-976"><a href="#NSSession-976"><span class="linenos"> 976</span></a><span class="sd">            bool: Whether the region was successfully created or not</span>
</span><span id="NSSession-977"><a href="#NSSession-977"><span class="linenos"> 977</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-978"><a href="#NSSession-978"><span class="linenos"> 978</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating new region </span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-979"><a href="#NSSession-979"><span class="linenos"> 979</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=create_region&quot;</span>
</span><span id="NSSession-980"><a href="#NSSession-980"><span class="linenos"> 980</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-981"><a href="#NSSession-981"><span class="linenos"> 981</span></a>            <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;create_region&quot;</span><span class="p">,</span>
</span><span id="NSSession-982"><a href="#NSSession-982"><span class="linenos"> 982</span></a>            <span class="s2">&quot;region_name&quot;</span><span class="p">:</span> <span class="n">region_name</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="NSSession-983"><a href="#NSSession-983"><span class="linenos"> 983</span></a>            <span class="s2">&quot;desc&quot;</span><span class="p">:</span> <span class="n">wfe</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="NSSession-984"><a href="#NSSession-984"><span class="linenos"> 984</span></a>            <span class="s2">&quot;create_region&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-985"><a href="#NSSession-985"><span class="linenos"> 985</span></a>        <span class="p">}</span>
</span><span id="NSSession-986"><a href="#NSSession-986"><span class="linenos"> 986</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession-987"><a href="#NSSession-987"><span class="linenos"> 987</span></a>            <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;pw&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;rpassword&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">}</span>
</span><span id="NSSession-988"><a href="#NSSession-988"><span class="linenos"> 988</span></a>        <span class="k">if</span> <span class="n">frontier</span><span class="p">:</span>
</span><span id="NSSession-989"><a href="#NSSession-989"><span class="linenos"> 989</span></a>            <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;is_frontier&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-990"><a href="#NSSession-990"><span class="linenos"> 990</span></a>        <span class="k">elif</span> <span class="n">executive_delegacy</span><span class="p">:</span>
</span><span id="NSSession-991"><a href="#NSSession-991"><span class="linenos"> 991</span></a>            <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;delegate_control&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-992"><a href="#NSSession-992"><span class="linenos"> 992</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-993"><a href="#NSSession-993"><span class="linenos"> 993</span></a>        <span class="k">return</span> <span class="s2">&quot;Success! You have founded &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-994"><a href="#NSSession-994"><span class="linenos"> 994</span></a>
</span><span id="NSSession-995"><a href="#NSSession-995"><span class="linenos"> 995</span></a>    <span class="k">def</span> <span class="nf">upload_to_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="NSSession-996"><a href="#NSSession-996"><span class="linenos"> 996</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Uploads a file to the current region.</span>
</span><span id="NSSession-997"><a href="#NSSession-997"><span class="linenos"> 997</span></a>
</span><span id="NSSession-998"><a href="#NSSession-998"><span class="linenos"> 998</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-999"><a href="#NSSession-999"><span class="linenos"> 999</span></a><span class="sd">            type (str): Type of file to upload. Must be &quot;flag&quot; or &quot;banner&quot;.</span>
</span><span id="NSSession-1000"><a href="#NSSession-1000"><span class="linenos">1000</span></a><span class="sd">            filename (str): Name of the file to upload. e.g. &quot;myflag.png&quot;</span>
</span><span id="NSSession-1001"><a href="#NSSession-1001"><span class="linenos">1001</span></a>
</span><span id="NSSession-1002"><a href="#NSSession-1002"><span class="linenos">1002</span></a><span class="sd">        Raises:</span>
</span><span id="NSSession-1003"><a href="#NSSession-1003"><span class="linenos">1003</span></a><span class="sd">            ValueError: If type is not &quot;flag&quot; or &quot;banner&quot;</span>
</span><span id="NSSession-1004"><a href="#NSSession-1004"><span class="linenos">1004</span></a>
</span><span id="NSSession-1005"><a href="#NSSession-1005"><span class="linenos">1005</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1006"><a href="#NSSession-1006"><span class="linenos">1006</span></a><span class="sd">            str: Empty string if the upload failed, otherwise the ID of the uploaded file</span>
</span><span id="NSSession-1007"><a href="#NSSession-1007"><span class="linenos">1007</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1008"><a href="#NSSession-1008"><span class="linenos">1008</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploading </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1009"><a href="#NSSession-1009"><span class="linenos">1009</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="s2">&quot;banner&quot;</span><span class="p">}:</span>
</span><span id="NSSession-1010"><a href="#NSSession-1010"><span class="linenos">1010</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type must be &#39;flag&#39; or &#39;banner&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession-1011"><a href="#NSSession-1011"><span class="linenos">1011</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/upload.cgi&quot;</span>
</span><span id="NSSession-1012"><a href="#NSSession-1012"><span class="linenos">1012</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-1013"><a href="#NSSession-1013"><span class="linenos">1013</span></a>            <span class="s2">&quot;uploadtype&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;r</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="NSSession-1014"><a href="#NSSession-1014"><span class="linenos">1014</span></a>            <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;region_control&quot;</span><span class="p">,</span>
</span><span id="NSSession-1015"><a href="#NSSession-1015"><span class="linenos">1015</span></a>            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
</span><span id="NSSession-1016"><a href="#NSSession-1016"><span class="linenos">1016</span></a>            <span class="s2">&quot;expect&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
</span><span id="NSSession-1017"><a href="#NSSession-1017"><span class="linenos">1017</span></a>        <span class="p">}</span>
</span><span id="NSSession-1018"><a href="#NSSession-1018"><span class="linenos">1018</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-1019"><a href="#NSSession-1019"><span class="linenos">1019</span></a>            <span class="sa">f</span><span class="s2">&quot;file_upload_r</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="NSSession-1020"><a href="#NSSession-1020"><span class="linenos">1020</span></a>                <span class="n">filename</span><span class="p">,</span>
</span><span id="NSSession-1021"><a href="#NSSession-1021"><span class="linenos">1021</span></a>                <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">),</span>
</span><span id="NSSession-1022"><a href="#NSSession-1022"><span class="linenos">1022</span></a>                <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="NSSession-1023"><a href="#NSSession-1023"><span class="linenos">1023</span></a>            <span class="p">)</span>
</span><span id="NSSession-1024"><a href="#NSSession-1024"><span class="linenos">1024</span></a>        <span class="p">}</span>
</span><span id="NSSession-1025"><a href="#NSSession-1025"><span class="linenos">1025</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="NSSession-1026"><a href="#NSSession-1026"><span class="linenos">1026</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">else</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span><span id="NSSession-1027"><a href="#NSSession-1027"><span class="linenos">1027</span></a>
</span><span id="NSSession-1028"><a href="#NSSession-1028"><span class="linenos">1028</span></a>    <span class="k">def</span> <span class="nf">set_flag_and_banner</span><span class="p">(</span>
</span><span id="NSSession-1029"><a href="#NSSession-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">flag_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">banner_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">flag_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession-1030"><a href="#NSSession-1030"><span class="linenos">1030</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1031"><a href="#NSSession-1031"><span class="linenos">1031</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the uploaded flag and/or banner for the current region.</span>
</span><span id="NSSession-1032"><a href="#NSSession-1032"><span class="linenos">1032</span></a>
</span><span id="NSSession-1033"><a href="#NSSession-1033"><span class="linenos">1033</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1034"><a href="#NSSession-1034"><span class="linenos">1034</span></a><span class="sd">            flag_id (str, optional): ID of the flag, uploaded with upload_to_region(). Defaults to &quot;&quot;.</span>
</span><span id="NSSession-1035"><a href="#NSSession-1035"><span class="linenos">1035</span></a><span class="sd">            banner_id (str, optional): ID of the banner, uploaded with upload_to_region(). Defaults to &quot;&quot;.</span>
</span><span id="NSSession-1036"><a href="#NSSession-1036"><span class="linenos">1036</span></a><span class="sd">            flagmode (str, optional): Must be &quot;flag&quot; which will have a shadow, or &quot;logo&quot; which will not, or &quot;&quot; to not change it. Defaults to &quot;&quot;.</span>
</span><span id="NSSession-1037"><a href="#NSSession-1037"><span class="linenos">1037</span></a>
</span><span id="NSSession-1038"><a href="#NSSession-1038"><span class="linenos">1038</span></a><span class="sd">        Raises:</span>
</span><span id="NSSession-1039"><a href="#NSSession-1039"><span class="linenos">1039</span></a><span class="sd">            ValueError: If flagmode is not &quot;flag&quot;, &quot;logo&quot;, or &quot;&quot;</span>
</span><span id="NSSession-1040"><a href="#NSSession-1040"><span class="linenos">1040</span></a>
</span><span id="NSSession-1041"><a href="#NSSession-1041"><span class="linenos">1041</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1042"><a href="#NSSession-1042"><span class="linenos">1042</span></a><span class="sd">            bool: Whether the change was successful or not</span>
</span><span id="NSSession-1043"><a href="#NSSession-1043"><span class="linenos">1043</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1044"><a href="#NSSession-1044"><span class="linenos">1044</span></a>        <span class="k">if</span> <span class="n">flag_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="s2">&quot;logo&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">}:</span>
</span><span id="NSSession-1045"><a href="#NSSession-1045"><span class="linenos">1045</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;flagmode must be &#39;flag&#39;, &#39;logo&#39;, or &#39;&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession-1046"><a href="#NSSession-1046"><span class="linenos">1046</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting flag and banner for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1047"><a href="#NSSession-1047"><span class="linenos">1047</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession-1048"><a href="#NSSession-1048"><span class="linenos">1048</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-1049"><a href="#NSSession-1049"><span class="linenos">1049</span></a>            <span class="s2">&quot;newflag&quot;</span><span class="p">:</span> <span class="n">flag_id</span><span class="p">,</span>
</span><span id="NSSession-1050"><a href="#NSSession-1050"><span class="linenos">1050</span></a>            <span class="s2">&quot;newbanner&quot;</span><span class="p">:</span> <span class="n">banner_id</span><span class="p">,</span>
</span><span id="NSSession-1051"><a href="#NSSession-1051"><span class="linenos">1051</span></a>            <span class="s2">&quot;saveflagandbannerchanges&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1052"><a href="#NSSession-1052"><span class="linenos">1052</span></a>            <span class="s2">&quot;flagmode&quot;</span><span class="p">:</span> <span class="n">flag_mode</span><span class="p">,</span>
</span><span id="NSSession-1053"><a href="#NSSession-1053"><span class="linenos">1053</span></a>        <span class="p">}</span>
</span><span id="NSSession-1054"><a href="#NSSession-1054"><span class="linenos">1054</span></a>        <span class="c1"># remove entries with empty values</span>
</span><span id="NSSession-1055"><a href="#NSSession-1055"><span class="linenos">1055</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">}</span>
</span><span id="NSSession-1056"><a href="#NSSession-1056"><span class="linenos">1056</span></a>
</span><span id="NSSession-1057"><a href="#NSSession-1057"><span class="linenos">1057</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1058"><a href="#NSSession-1058"><span class="linenos">1058</span></a>
</span><span id="NSSession-1059"><a href="#NSSession-1059"><span class="linenos">1059</span></a>        <span class="k">return</span> <span class="s2">&quot;Regional banner/flag updated!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1060"><a href="#NSSession-1060"><span class="linenos">1060</span></a>
</span><span id="NSSession-1061"><a href="#NSSession-1061"><span class="linenos">1061</span></a>    <span class="k">def</span> <span class="nf">change_wfe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wfe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1062"><a href="#NSSession-1062"><span class="linenos">1062</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the WFE of the current region.</span>
</span><span id="NSSession-1063"><a href="#NSSession-1063"><span class="linenos">1063</span></a>
</span><span id="NSSession-1064"><a href="#NSSession-1064"><span class="linenos">1064</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1065"><a href="#NSSession-1065"><span class="linenos">1065</span></a><span class="sd">            wfe (str, optional): World Factbook Entry to change to. Defaults to the oldest WFE the region has, for detags.</span>
</span><span id="NSSession-1066"><a href="#NSSession-1066"><span class="linenos">1066</span></a>
</span><span id="NSSession-1067"><a href="#NSSession-1067"><span class="linenos">1067</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1068"><a href="#NSSession-1068"><span class="linenos">1068</span></a><span class="sd">            bool: True if successful, False otherwise</span>
</span><span id="NSSession-1069"><a href="#NSSession-1069"><span class="linenos">1069</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1070"><a href="#NSSession-1070"><span class="linenos">1070</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changing WFE for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1071"><a href="#NSSession-1071"><span class="linenos">1071</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">wfe</span><span class="p">:</span>
</span><span id="NSSession-1072"><a href="#NSSession-1072"><span class="linenos">1072</span></a>            <span class="n">wfe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_detag_wfe</span><span class="p">()</span>  <span class="c1"># haku im sorry for hitting your site so much</span>
</span><span id="NSSession-1073"><a href="#NSSession-1073"><span class="linenos">1073</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession-1074"><a href="#NSSession-1074"><span class="linenos">1074</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-1075"><a href="#NSSession-1075"><span class="linenos">1075</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">wfe</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;iso-8859-1&quot;</span><span class="p">,</span> <span class="s2">&quot;xmlcharrefreplace&quot;</span><span class="p">)</span>
</span><span id="NSSession-1076"><a href="#NSSession-1076"><span class="linenos">1076</span></a>            <span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="NSSession-1077"><a href="#NSSession-1077"><span class="linenos">1077</span></a>            <span class="o">.</span><span class="n">strip</span><span class="p">(),</span>  <span class="c1"># lol.</span>
</span><span id="NSSession-1078"><a href="#NSSession-1078"><span class="linenos">1078</span></a>            <span class="s2">&quot;setwfebutton&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1079"><a href="#NSSession-1079"><span class="linenos">1079</span></a>        <span class="p">}</span>
</span><span id="NSSession-1080"><a href="#NSSession-1080"><span class="linenos">1080</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1081"><a href="#NSSession-1081"><span class="linenos">1081</span></a>        <span class="k">return</span> <span class="s2">&quot;World Factbook Entry updated!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1082"><a href="#NSSession-1082"><span class="linenos">1082</span></a>
</span><span id="NSSession-1083"><a href="#NSSession-1083"><span class="linenos">1083</span></a>    <span class="c1"># methods for embassies</span>
</span><span id="NSSession-1084"><a href="#NSSession-1084"><span class="linenos">1084</span></a>
</span><span id="NSSession-1085"><a href="#NSSession-1085"><span class="linenos">1085</span></a>    <span class="k">def</span> <span class="nf">request_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1086"><a href="#NSSession-1086"><span class="linenos">1086</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Requests an embassy with a region.</span>
</span><span id="NSSession-1087"><a href="#NSSession-1087"><span class="linenos">1087</span></a>
</span><span id="NSSession-1088"><a href="#NSSession-1088"><span class="linenos">1088</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1089"><a href="#NSSession-1089"><span class="linenos">1089</span></a><span class="sd">            target (str): The region to request the embassy with.</span>
</span><span id="NSSession-1090"><a href="#NSSession-1090"><span class="linenos">1090</span></a>
</span><span id="NSSession-1091"><a href="#NSSession-1091"><span class="linenos">1091</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1092"><a href="#NSSession-1092"><span class="linenos">1092</span></a><span class="sd">            bool: Whether the request was successfully sent or not</span>
</span><span id="NSSession-1093"><a href="#NSSession-1093"><span class="linenos">1093</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1094"><a href="#NSSession-1094"><span class="linenos">1094</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requesting embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1095"><a href="#NSSession-1095"><span class="linenos">1095</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession-1096"><a href="#NSSession-1096"><span class="linenos">1096</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-1097"><a href="#NSSession-1097"><span class="linenos">1097</span></a>            <span class="s2">&quot;requestembassyregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
</span><span id="NSSession-1098"><a href="#NSSession-1098"><span class="linenos">1098</span></a>            <span class="s2">&quot;requestembassy&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>  <span class="c1"># it&#39;s silly that requesting needs this but not closing, aborting, or cancelling</span>
</span><span id="NSSession-1099"><a href="#NSSession-1099"><span class="linenos">1099</span></a>        <span class="p">}</span>
</span><span id="NSSession-1100"><a href="#NSSession-1100"><span class="linenos">1100</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1101"><a href="#NSSession-1101"><span class="linenos">1101</span></a>        <span class="k">return</span> <span class="s2">&quot;Your proposal for the construction of embassies with&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1102"><a href="#NSSession-1102"><span class="linenos">1102</span></a>
</span><span id="NSSession-1103"><a href="#NSSession-1103"><span class="linenos">1103</span></a>    <span class="k">def</span> <span class="nf">close_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1104"><a href="#NSSession-1104"><span class="linenos">1104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Closes an embassy with a region.</span>
</span><span id="NSSession-1105"><a href="#NSSession-1105"><span class="linenos">1105</span></a>
</span><span id="NSSession-1106"><a href="#NSSession-1106"><span class="linenos">1106</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1107"><a href="#NSSession-1107"><span class="linenos">1107</span></a><span class="sd">            target (str): The region with which to close the embassy.</span>
</span><span id="NSSession-1108"><a href="#NSSession-1108"><span class="linenos">1108</span></a>
</span><span id="NSSession-1109"><a href="#NSSession-1109"><span class="linenos">1109</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1110"><a href="#NSSession-1110"><span class="linenos">1110</span></a><span class="sd">            bool: Whether the embassy was successfully closed or not</span>
</span><span id="NSSession-1111"><a href="#NSSession-1111"><span class="linenos">1111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1112"><a href="#NSSession-1112"><span class="linenos">1112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Closing embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1113"><a href="#NSSession-1113"><span class="linenos">1113</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession-1114"><a href="#NSSession-1114"><span class="linenos">1114</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cancelembassyregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
</span><span id="NSSession-1115"><a href="#NSSession-1115"><span class="linenos">1115</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1116"><a href="#NSSession-1116"><span class="linenos">1116</span></a>        <span class="k">return</span> <span class="s2">&quot; has been scheduled for demolition.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1117"><a href="#NSSession-1117"><span class="linenos">1117</span></a>
</span><span id="NSSession-1118"><a href="#NSSession-1118"><span class="linenos">1118</span></a>    <span class="k">def</span> <span class="nf">abort_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1119"><a href="#NSSession-1119"><span class="linenos">1119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Aborts an embassy with a region.</span>
</span><span id="NSSession-1120"><a href="#NSSession-1120"><span class="linenos">1120</span></a>
</span><span id="NSSession-1121"><a href="#NSSession-1121"><span class="linenos">1121</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1122"><a href="#NSSession-1122"><span class="linenos">1122</span></a><span class="sd">            target (str): The region with which to abort the embassy.</span>
</span><span id="NSSession-1123"><a href="#NSSession-1123"><span class="linenos">1123</span></a>
</span><span id="NSSession-1124"><a href="#NSSession-1124"><span class="linenos">1124</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1125"><a href="#NSSession-1125"><span class="linenos">1125</span></a><span class="sd">            bool: Whether the embassy was successfully aborted or not</span>
</span><span id="NSSession-1126"><a href="#NSSession-1126"><span class="linenos">1126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1127"><a href="#NSSession-1127"><span class="linenos">1127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Aborting embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1128"><a href="#NSSession-1128"><span class="linenos">1128</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession-1129"><a href="#NSSession-1129"><span class="linenos">1129</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abortembassyregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
</span><span id="NSSession-1130"><a href="#NSSession-1130"><span class="linenos">1130</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1131"><a href="#NSSession-1131"><span class="linenos">1131</span></a>        <span class="k">return</span> <span class="s2">&quot; aborted.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1132"><a href="#NSSession-1132"><span class="linenos">1132</span></a>
</span><span id="NSSession-1133"><a href="#NSSession-1133"><span class="linenos">1133</span></a>    <span class="k">def</span> <span class="nf">cancel_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1134"><a href="#NSSession-1134"><span class="linenos">1134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cancels an embassy with a region.</span>
</span><span id="NSSession-1135"><a href="#NSSession-1135"><span class="linenos">1135</span></a>
</span><span id="NSSession-1136"><a href="#NSSession-1136"><span class="linenos">1136</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1137"><a href="#NSSession-1137"><span class="linenos">1137</span></a><span class="sd">            target (str): The region with which to cancel the embassy.</span>
</span><span id="NSSession-1138"><a href="#NSSession-1138"><span class="linenos">1138</span></a>
</span><span id="NSSession-1139"><a href="#NSSession-1139"><span class="linenos">1139</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1140"><a href="#NSSession-1140"><span class="linenos">1140</span></a><span class="sd">            bool: Whether the embassy was successfully cancelled or not</span>
</span><span id="NSSession-1141"><a href="#NSSession-1141"><span class="linenos">1141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1142"><a href="#NSSession-1142"><span class="linenos">1142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cancelling embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1143"><a href="#NSSession-1143"><span class="linenos">1143</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession-1144"><a href="#NSSession-1144"><span class="linenos">1144</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cancelembassyclosureregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
</span><span id="NSSession-1145"><a href="#NSSession-1145"><span class="linenos">1145</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1146"><a href="#NSSession-1146"><span class="linenos">1146</span></a>        <span class="k">return</span> <span class="s2">&quot;Embassy closure order cancelled.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1147"><a href="#NSSession-1147"><span class="linenos">1147</span></a>
</span><span id="NSSession-1148"><a href="#NSSession-1148"><span class="linenos">1148</span></a>    <span class="c1"># end methods for embassies</span>
</span><span id="NSSession-1149"><a href="#NSSession-1149"><span class="linenos">1149</span></a>
</span><span id="NSSession-1150"><a href="#NSSession-1150"><span class="linenos">1150</span></a>    <span class="k">def</span> <span class="nf">tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1151"><a href="#NSSession-1151"><span class="linenos">1151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds or removes a tag to the current region.</span>
</span><span id="NSSession-1152"><a href="#NSSession-1152"><span class="linenos">1152</span></a>
</span><span id="NSSession-1153"><a href="#NSSession-1153"><span class="linenos">1153</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1154"><a href="#NSSession-1154"><span class="linenos">1154</span></a><span class="sd">            action (str): The action to take. Must be &quot;add&quot; or &quot;remove&quot;.</span>
</span><span id="NSSession-1155"><a href="#NSSession-1155"><span class="linenos">1155</span></a><span class="sd">            tag (str): The tag to add or remove.</span>
</span><span id="NSSession-1156"><a href="#NSSession-1156"><span class="linenos">1156</span></a>
</span><span id="NSSession-1157"><a href="#NSSession-1157"><span class="linenos">1157</span></a><span class="sd">        Raises:</span>
</span><span id="NSSession-1158"><a href="#NSSession-1158"><span class="linenos">1158</span></a><span class="sd">            ValueError: If action is not &quot;add&quot; or &quot;remove&quot;, or if tag is not a valid tag.</span>
</span><span id="NSSession-1159"><a href="#NSSession-1159"><span class="linenos">1159</span></a>
</span><span id="NSSession-1160"><a href="#NSSession-1160"><span class="linenos">1160</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1161"><a href="#NSSession-1161"><span class="linenos">1161</span></a><span class="sd">            bool: Whether the tag was successfully added or removed</span>
</span><span id="NSSession-1162"><a href="#NSSession-1162"><span class="linenos">1162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1163"><a href="#NSSession-1163"><span class="linenos">1163</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;remove&quot;</span><span class="p">}:</span>
</span><span id="NSSession-1164"><a href="#NSSession-1164"><span class="linenos">1164</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;action must be &#39;add&#39; or &#39;remove&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession-1165"><a href="#NSSession-1165"><span class="linenos">1165</span></a>        <span class="k">if</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid</span><span class="o">.</span><span class="n">REGION_TAGS</span><span class="p">:</span>
</span><span id="NSSession-1166"><a href="#NSSession-1166"><span class="linenos">1166</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2"> is not a valid tag&quot;</span><span class="p">)</span>
</span><span id="NSSession-1167"><a href="#NSSession-1167"><span class="linenos">1167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">action</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">ing tag </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1168"><a href="#NSSession-1168"><span class="linenos">1168</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession-1169"><a href="#NSSession-1169"><span class="linenos">1169</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-1170"><a href="#NSSession-1170"><span class="linenos">1170</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">_tag&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">tag</span><span class="p">),</span>
</span><span id="NSSession-1171"><a href="#NSSession-1171"><span class="linenos">1171</span></a>            <span class="s2">&quot;updatetagsbutton&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1172"><a href="#NSSession-1172"><span class="linenos">1172</span></a>        <span class="p">}</span>
</span><span id="NSSession-1173"><a href="#NSSession-1173"><span class="linenos">1173</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1174"><a href="#NSSession-1174"><span class="linenos">1174</span></a>        <span class="k">return</span> <span class="s2">&quot;Region Tags updated!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1175"><a href="#NSSession-1175"><span class="linenos">1175</span></a>
</span><span id="NSSession-1176"><a href="#NSSession-1176"><span class="linenos">1176</span></a>    <span class="k">def</span> <span class="nf">eject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1177"><a href="#NSSession-1177"><span class="linenos">1177</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Ejects a nation from the current region. Note that a 1 second delay is required before ejecting another nation.</span>
</span><span id="NSSession-1178"><a href="#NSSession-1178"><span class="linenos">1178</span></a>
</span><span id="NSSession-1179"><a href="#NSSession-1179"><span class="linenos">1179</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1180"><a href="#NSSession-1180"><span class="linenos">1180</span></a><span class="sd">            nation (str): The nation to eject.</span>
</span><span id="NSSession-1181"><a href="#NSSession-1181"><span class="linenos">1181</span></a>
</span><span id="NSSession-1182"><a href="#NSSession-1182"><span class="linenos">1182</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1183"><a href="#NSSession-1183"><span class="linenos">1183</span></a><span class="sd">            bool: Whether the nation was successfully ejected or not</span>
</span><span id="NSSession-1184"><a href="#NSSession-1184"><span class="linenos">1184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1185"><a href="#NSSession-1185"><span class="linenos">1185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ejecting </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1186"><a href="#NSSession-1186"><span class="linenos">1186</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession-1187"><a href="#NSSession-1187"><span class="linenos">1187</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation_name&quot;</span><span class="p">:</span> <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;eject&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-1188"><a href="#NSSession-1188"><span class="linenos">1188</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1189"><a href="#NSSession-1189"><span class="linenos">1189</span></a>        <span class="k">return</span> <span class="s2">&quot;has been ejected from &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1190"><a href="#NSSession-1190"><span class="linenos">1190</span></a>
</span><span id="NSSession-1191"><a href="#NSSession-1191"><span class="linenos">1191</span></a>    <span class="k">def</span> <span class="nf">banject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1192"><a href="#NSSession-1192"><span class="linenos">1192</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Bans a nation from the current region. Note that a 1 second delay is required before banjecting another nation.</span>
</span><span id="NSSession-1193"><a href="#NSSession-1193"><span class="linenos">1193</span></a>
</span><span id="NSSession-1194"><a href="#NSSession-1194"><span class="linenos">1194</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1195"><a href="#NSSession-1195"><span class="linenos">1195</span></a><span class="sd">            nation (str): The nation to banject.</span>
</span><span id="NSSession-1196"><a href="#NSSession-1196"><span class="linenos">1196</span></a>
</span><span id="NSSession-1197"><a href="#NSSession-1197"><span class="linenos">1197</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1198"><a href="#NSSession-1198"><span class="linenos">1198</span></a><span class="sd">            bool: Whether the nation was successfully banjected or not</span>
</span><span id="NSSession-1199"><a href="#NSSession-1199"><span class="linenos">1199</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1200"><a href="#NSSession-1200"><span class="linenos">1200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Banjecting </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1201"><a href="#NSSession-1201"><span class="linenos">1201</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession-1202"><a href="#NSSession-1202"><span class="linenos">1202</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation_name&quot;</span><span class="p">:</span> <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;ban&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-1203"><a href="#NSSession-1203"><span class="linenos">1203</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1204"><a href="#NSSession-1204"><span class="linenos">1204</span></a>        <span class="k">return</span> <span class="s2">&quot;has been ejected and banned from &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1205"><a href="#NSSession-1205"><span class="linenos">1205</span></a>
</span><span id="NSSession-1206"><a href="#NSSession-1206"><span class="linenos">1206</span></a>    <span class="c1"># end methods for region control</span>
</span><span id="NSSession-1207"><a href="#NSSession-1207"><span class="linenos">1207</span></a>
</span><span id="NSSession-1208"><a href="#NSSession-1208"><span class="linenos">1208</span></a>    <span class="k">def</span> <span class="nf">junk_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1209"><a href="#NSSession-1209"><span class="linenos">1209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Junks a card from the current nation&#39;s deck.</span>
</span><span id="NSSession-1210"><a href="#NSSession-1210"><span class="linenos">1210</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1211"><a href="#NSSession-1211"><span class="linenos">1211</span></a><span class="sd">            id (str): ID of the card to junk</span>
</span><span id="NSSession-1212"><a href="#NSSession-1212"><span class="linenos">1212</span></a><span class="sd">            season (str): Season of the card to junk</span>
</span><span id="NSSession-1213"><a href="#NSSession-1213"><span class="linenos">1213</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1214"><a href="#NSSession-1214"><span class="linenos">1214</span></a><span class="sd">            bool: Whether the card was successfully junked or not</span>
</span><span id="NSSession-1215"><a href="#NSSession-1215"><span class="linenos">1215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1216"><a href="#NSSession-1216"><span class="linenos">1216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Junking card </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2"> from season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1217"><a href="#NSSession-1217"><span class="linenos">1217</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession-1218"><a href="#NSSession-1218"><span class="linenos">1218</span></a>
</span><span id="NSSession-1219"><a href="#NSSession-1219"><span class="linenos">1219</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;ajax3&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;junkcard&quot;</span><span class="p">,</span> <span class="s2">&quot;card&quot;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">:</span> <span class="n">season</span><span class="p">}</span>
</span><span id="NSSession-1220"><a href="#NSSession-1220"><span class="linenos">1220</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1221"><a href="#NSSession-1221"><span class="linenos">1221</span></a>
</span><span id="NSSession-1222"><a href="#NSSession-1222"><span class="linenos">1222</span></a>        <span class="k">return</span> <span class="s2">&quot;Your Deck&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1223"><a href="#NSSession-1223"><span class="linenos">1223</span></a>
</span><span id="NSSession-1224"><a href="#NSSession-1224"><span class="linenos">1224</span></a>    <span class="k">def</span> <span class="nf">open_pack</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1225"><a href="#NSSession-1225"><span class="linenos">1225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Opens a card pack.</span>
</span><span id="NSSession-1226"><a href="#NSSession-1226"><span class="linenos">1226</span></a>
</span><span id="NSSession-1227"><a href="#NSSession-1227"><span class="linenos">1227</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1228"><a href="#NSSession-1228"><span class="linenos">1228</span></a><span class="sd">            bool: Whether the bid was successfully removed or not</span>
</span><span id="NSSession-1229"><a href="#NSSession-1229"><span class="linenos">1229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1230"><a href="#NSSession-1230"><span class="linenos">1230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Opening trading card pack&quot;</span><span class="p">)</span>
</span><span id="NSSession-1231"><a href="#NSSession-1231"><span class="linenos">1231</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession-1232"><a href="#NSSession-1232"><span class="linenos">1232</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;open_loot_box&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-1233"><a href="#NSSession-1233"><span class="linenos">1233</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1234"><a href="#NSSession-1234"><span class="linenos">1234</span></a>        <span class="k">return</span> <span class="s2">&quot;Tap cards to reveal...&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1235"><a href="#NSSession-1235"><span class="linenos">1235</span></a>
</span><span id="NSSession-1236"><a href="#NSSession-1236"><span class="linenos">1236</span></a>    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1237"><a href="#NSSession-1237"><span class="linenos">1237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Puts an ask at price on a card in a season</span>
</span><span id="NSSession-1238"><a href="#NSSession-1238"><span class="linenos">1238</span></a>
</span><span id="NSSession-1239"><a href="#NSSession-1239"><span class="linenos">1239</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1240"><a href="#NSSession-1240"><span class="linenos">1240</span></a><span class="sd">            price (str): Price to ask</span>
</span><span id="NSSession-1241"><a href="#NSSession-1241"><span class="linenos">1241</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="NSSession-1242"><a href="#NSSession-1242"><span class="linenos">1242</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="NSSession-1243"><a href="#NSSession-1243"><span class="linenos">1243</span></a>
</span><span id="NSSession-1244"><a href="#NSSession-1244"><span class="linenos">1244</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1245"><a href="#NSSession-1245"><span class="linenos">1245</span></a><span class="sd">            bool: Whether the ask was successfully lodged or not</span>
</span><span id="NSSession-1246"><a href="#NSSession-1246"><span class="linenos">1246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1247"><a href="#NSSession-1247"><span class="linenos">1247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Asking for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1248"><a href="#NSSession-1248"><span class="linenos">1248</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-1249"><a href="#NSSession-1249"><span class="linenos">1249</span></a>
</span><span id="NSSession-1250"><a href="#NSSession-1250"><span class="linenos">1250</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;auction_ask&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;auction_submit&quot;</span><span class="p">:</span> <span class="s2">&quot;ask&quot;</span><span class="p">}</span>
</span><span id="NSSession-1251"><a href="#NSSession-1251"><span class="linenos">1251</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1252"><a href="#NSSession-1252"><span class="linenos">1252</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Your ask of </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1253"><a href="#NSSession-1253"><span class="linenos">1253</span></a>
</span><span id="NSSession-1254"><a href="#NSSession-1254"><span class="linenos">1254</span></a>    <span class="k">def</span> <span class="nf">bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1255"><a href="#NSSession-1255"><span class="linenos">1255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Places a bid on a card in a season</span>
</span><span id="NSSession-1256"><a href="#NSSession-1256"><span class="linenos">1256</span></a>
</span><span id="NSSession-1257"><a href="#NSSession-1257"><span class="linenos">1257</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1258"><a href="#NSSession-1258"><span class="linenos">1258</span></a><span class="sd">            price (str): Amount of bank to bid</span>
</span><span id="NSSession-1259"><a href="#NSSession-1259"><span class="linenos">1259</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="NSSession-1260"><a href="#NSSession-1260"><span class="linenos">1260</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="NSSession-1261"><a href="#NSSession-1261"><span class="linenos">1261</span></a>
</span><span id="NSSession-1262"><a href="#NSSession-1262"><span class="linenos">1262</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1263"><a href="#NSSession-1263"><span class="linenos">1263</span></a><span class="sd">            bool: Whether the bid was successfully lodged or not</span>
</span><span id="NSSession-1264"><a href="#NSSession-1264"><span class="linenos">1264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1265"><a href="#NSSession-1265"><span class="linenos">1265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Putting a bid for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1266"><a href="#NSSession-1266"><span class="linenos">1266</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-1267"><a href="#NSSession-1267"><span class="linenos">1267</span></a>
</span><span id="NSSession-1268"><a href="#NSSession-1268"><span class="linenos">1268</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;auction_bid&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;auction_submit&quot;</span><span class="p">:</span> <span class="s2">&quot;bid&quot;</span><span class="p">}</span>
</span><span id="NSSession-1269"><a href="#NSSession-1269"><span class="linenos">1269</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1270"><a href="#NSSession-1270"><span class="linenos">1270</span></a>
</span><span id="NSSession-1271"><a href="#NSSession-1271"><span class="linenos">1271</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Your bid of </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1272"><a href="#NSSession-1272"><span class="linenos">1272</span></a>
</span><span id="NSSession-1273"><a href="#NSSession-1273"><span class="linenos">1273</span></a>    <span class="k">def</span> <span class="nf">remove_ask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1274"><a href="#NSSession-1274"><span class="linenos">1274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes an ask on card_id in season at price</span>
</span><span id="NSSession-1275"><a href="#NSSession-1275"><span class="linenos">1275</span></a>
</span><span id="NSSession-1276"><a href="#NSSession-1276"><span class="linenos">1276</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1277"><a href="#NSSession-1277"><span class="linenos">1277</span></a><span class="sd">            price (str): Price of the ask to remove</span>
</span><span id="NSSession-1278"><a href="#NSSession-1278"><span class="linenos">1278</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="NSSession-1279"><a href="#NSSession-1279"><span class="linenos">1279</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="NSSession-1280"><a href="#NSSession-1280"><span class="linenos">1280</span></a>
</span><span id="NSSession-1281"><a href="#NSSession-1281"><span class="linenos">1281</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1282"><a href="#NSSession-1282"><span class="linenos">1282</span></a><span class="sd">            bool: Whether the ask was successfully removed or not</span>
</span><span id="NSSession-1283"><a href="#NSSession-1283"><span class="linenos">1283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1284"><a href="#NSSession-1284"><span class="linenos">1284</span></a>
</span><span id="NSSession-1285"><a href="#NSSession-1285"><span class="linenos">1285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;removing an ask for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1286"><a href="#NSSession-1286"><span class="linenos">1286</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-1287"><a href="#NSSession-1287"><span class="linenos">1287</span></a>
</span><span id="NSSession-1288"><a href="#NSSession-1288"><span class="linenos">1288</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;new_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;remove_ask_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">}</span>
</span><span id="NSSession-1289"><a href="#NSSession-1289"><span class="linenos">1289</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1290"><a href="#NSSession-1290"><span class="linenos">1290</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Removed your ask for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1291"><a href="#NSSession-1291"><span class="linenos">1291</span></a>
</span><span id="NSSession-1292"><a href="#NSSession-1292"><span class="linenos">1292</span></a>    <span class="k">def</span> <span class="nf">remove_bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1293"><a href="#NSSession-1293"><span class="linenos">1293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes a bid on a card</span>
</span><span id="NSSession-1294"><a href="#NSSession-1294"><span class="linenos">1294</span></a>
</span><span id="NSSession-1295"><a href="#NSSession-1295"><span class="linenos">1295</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1296"><a href="#NSSession-1296"><span class="linenos">1296</span></a><span class="sd">            price (str): Price of the bid to remove</span>
</span><span id="NSSession-1297"><a href="#NSSession-1297"><span class="linenos">1297</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="NSSession-1298"><a href="#NSSession-1298"><span class="linenos">1298</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="NSSession-1299"><a href="#NSSession-1299"><span class="linenos">1299</span></a>
</span><span id="NSSession-1300"><a href="#NSSession-1300"><span class="linenos">1300</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1301"><a href="#NSSession-1301"><span class="linenos">1301</span></a><span class="sd">            bool: Whether the bid was successfully removed or not</span>
</span><span id="NSSession-1302"><a href="#NSSession-1302"><span class="linenos">1302</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1303"><a href="#NSSession-1303"><span class="linenos">1303</span></a>
</span><span id="NSSession-1304"><a href="#NSSession-1304"><span class="linenos">1304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing a bid for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1305"><a href="#NSSession-1305"><span class="linenos">1305</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-1306"><a href="#NSSession-1306"><span class="linenos">1306</span></a>
</span><span id="NSSession-1307"><a href="#NSSession-1307"><span class="linenos">1307</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;new_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;remove_bid_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">}</span>
</span><span id="NSSession-1308"><a href="#NSSession-1308"><span class="linenos">1308</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1309"><a href="#NSSession-1309"><span class="linenos">1309</span></a>
</span><span id="NSSession-1310"><a href="#NSSession-1310"><span class="linenos">1310</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Removed your bid for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1311"><a href="#NSSession-1311"><span class="linenos">1311</span></a>
</span><span id="NSSession-1312"><a href="#NSSession-1312"><span class="linenos">1312</span></a>    <span class="k">def</span> <span class="nf">expand_deck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession-1313"><a href="#NSSession-1313"><span class="linenos">1313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Upgrades deck capacity</span>
</span><span id="NSSession-1314"><a href="#NSSession-1314"><span class="linenos">1314</span></a>
</span><span id="NSSession-1315"><a href="#NSSession-1315"><span class="linenos">1315</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1316"><a href="#NSSession-1316"><span class="linenos">1316</span></a><span class="sd">            price (str): Price of the Upgrade</span>
</span><span id="NSSession-1317"><a href="#NSSession-1317"><span class="linenos">1317</span></a>
</span><span id="NSSession-1318"><a href="#NSSession-1318"><span class="linenos">1318</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1319"><a href="#NSSession-1319"><span class="linenos">1319</span></a><span class="sd">            bool: Whether the upgrade was successfully removed or not</span>
</span><span id="NSSession-1320"><a href="#NSSession-1320"><span class="linenos">1320</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1321"><a href="#NSSession-1321"><span class="linenos">1321</span></a>
</span><span id="NSSession-1322"><a href="#NSSession-1322"><span class="linenos">1322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upgrading your deck at a cost of </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1323"><a href="#NSSession-1323"><span class="linenos">1323</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession-1324"><a href="#NSSession-1324"><span class="linenos">1324</span></a>
</span><span id="NSSession-1325"><a href="#NSSession-1325"><span class="linenos">1325</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;embiggen_deck&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">}</span>
</span><span id="NSSession-1326"><a href="#NSSession-1326"><span class="linenos">1326</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1327"><a href="#NSSession-1327"><span class="linenos">1327</span></a>
</span><span id="NSSession-1328"><a href="#NSSession-1328"><span class="linenos">1328</span></a>        <span class="k">return</span> <span class="s2">&quot;Increased deck capacity from&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1329"><a href="#NSSession-1329"><span class="linenos">1329</span></a>
</span><span id="NSSession-1330"><a href="#NSSession-1330"><span class="linenos">1330</span></a>    <span class="k">def</span> <span class="nf">add_to_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_season</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collection_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession-1331"><a href="#NSSession-1331"><span class="linenos">1331</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a card to collection_id</span>
</span><span id="NSSession-1332"><a href="#NSSession-1332"><span class="linenos">1332</span></a>
</span><span id="NSSession-1333"><a href="#NSSession-1333"><span class="linenos">1333</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1334"><a href="#NSSession-1334"><span class="linenos">1334</span></a><span class="sd">            card_id (str): Card ID</span>
</span><span id="NSSession-1335"><a href="#NSSession-1335"><span class="linenos">1335</span></a><span class="sd">            card_season (str): Cards season</span>
</span><span id="NSSession-1336"><a href="#NSSession-1336"><span class="linenos">1336</span></a><span class="sd">            collection_id (str): The ID of the collection you want to add to</span>
</span><span id="NSSession-1337"><a href="#NSSession-1337"><span class="linenos">1337</span></a>
</span><span id="NSSession-1338"><a href="#NSSession-1338"><span class="linenos">1338</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1339"><a href="#NSSession-1339"><span class="linenos">1339</span></a><span class="sd">            bool: Whether the adding was successfully added or not</span>
</span><span id="NSSession-1340"><a href="#NSSession-1340"><span class="linenos">1340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1341"><a href="#NSSession-1341"><span class="linenos">1341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> of season </span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1342"><a href="#NSSession-1342"><span class="linenos">1342</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-1343"><a href="#NSSession-1343"><span class="linenos">1343</span></a>
</span><span id="NSSession-1344"><a href="#NSSession-1344"><span class="linenos">1344</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-1345"><a href="#NSSession-1345"><span class="linenos">1345</span></a>            <span class="s2">&quot;manage_collections&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1346"><a href="#NSSession-1346"><span class="linenos">1346</span></a>            <span class="s2">&quot;modify_card_in_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1347"><a href="#NSSession-1347"><span class="linenos">1347</span></a>            <span class="sa">f</span><span class="s2">&quot;collection_</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1348"><a href="#NSSession-1348"><span class="linenos">1348</span></a>            <span class="s2">&quot;save_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1349"><a href="#NSSession-1349"><span class="linenos">1349</span></a>        <span class="p">}</span>
</span><span id="NSSession-1350"><a href="#NSSession-1350"><span class="linenos">1350</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1351"><a href="#NSSession-1351"><span class="linenos">1351</span></a>
</span><span id="NSSession-1352"><a href="#NSSession-1352"><span class="linenos">1352</span></a>        <span class="k">return</span> <span class="s2">&quot;Updated collections.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1353"><a href="#NSSession-1353"><span class="linenos">1353</span></a>
</span><span id="NSSession-1354"><a href="#NSSession-1354"><span class="linenos">1354</span></a>    <span class="k">def</span> <span class="nf">remove_from_collection</span><span class="p">(</span>
</span><span id="NSSession-1355"><a href="#NSSession-1355"><span class="linenos">1355</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_season</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collection_id</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="NSSession-1356"><a href="#NSSession-1356"><span class="linenos">1356</span></a>    <span class="p">):</span>
</span><span id="NSSession-1357"><a href="#NSSession-1357"><span class="linenos">1357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes a card from collection_id</span>
</span><span id="NSSession-1358"><a href="#NSSession-1358"><span class="linenos">1358</span></a>
</span><span id="NSSession-1359"><a href="#NSSession-1359"><span class="linenos">1359</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1360"><a href="#NSSession-1360"><span class="linenos">1360</span></a><span class="sd">            card_id (str): Card ID</span>
</span><span id="NSSession-1361"><a href="#NSSession-1361"><span class="linenos">1361</span></a><span class="sd">            card_season (str): Cards season</span>
</span><span id="NSSession-1362"><a href="#NSSession-1362"><span class="linenos">1362</span></a><span class="sd">            collection_id (str): The ID of the collection you want to remove from</span>
</span><span id="NSSession-1363"><a href="#NSSession-1363"><span class="linenos">1363</span></a>
</span><span id="NSSession-1364"><a href="#NSSession-1364"><span class="linenos">1364</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1365"><a href="#NSSession-1365"><span class="linenos">1365</span></a><span class="sd">            bool: Whether the removal was successfully added or not</span>
</span><span id="NSSession-1366"><a href="#NSSession-1366"><span class="linenos">1366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1367"><a href="#NSSession-1367"><span class="linenos">1367</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="NSSession-1368"><a href="#NSSession-1368"><span class="linenos">1368</span></a>            <span class="sa">f</span><span class="s2">&quot;Removing </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> of season </span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-1369"><a href="#NSSession-1369"><span class="linenos">1369</span></a>        <span class="p">)</span>
</span><span id="NSSession-1370"><a href="#NSSession-1370"><span class="linenos">1370</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-1371"><a href="#NSSession-1371"><span class="linenos">1371</span></a>
</span><span id="NSSession-1372"><a href="#NSSession-1372"><span class="linenos">1372</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession-1373"><a href="#NSSession-1373"><span class="linenos">1373</span></a>            <span class="s2">&quot;manage_collections&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1374"><a href="#NSSession-1374"><span class="linenos">1374</span></a>            <span class="s2">&quot;modify_card_in_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1375"><a href="#NSSession-1375"><span class="linenos">1375</span></a>            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
</span><span id="NSSession-1376"><a href="#NSSession-1376"><span class="linenos">1376</span></a>            <span class="sa">f</span><span class="s2">&quot;collection_</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
</span><span id="NSSession-1377"><a href="#NSSession-1377"><span class="linenos">1377</span></a>            <span class="s2">&quot;save_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession-1378"><a href="#NSSession-1378"><span class="linenos">1378</span></a>        <span class="p">}</span>
</span><span id="NSSession-1379"><a href="#NSSession-1379"><span class="linenos">1379</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1380"><a href="#NSSession-1380"><span class="linenos">1380</span></a>
</span><span id="NSSession-1381"><a href="#NSSession-1381"><span class="linenos">1381</span></a>        <span class="k">return</span> <span class="s2">&quot;Updated collections.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1382"><a href="#NSSession-1382"><span class="linenos">1382</span></a>
</span><span id="NSSession-1383"><a href="#NSSession-1383"><span class="linenos">1383</span></a>    <span class="k">def</span> <span class="nf">create_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession-1384"><a href="#NSSession-1384"><span class="linenos">1384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a collection named name</span>
</span><span id="NSSession-1385"><a href="#NSSession-1385"><span class="linenos">1385</span></a>
</span><span id="NSSession-1386"><a href="#NSSession-1386"><span class="linenos">1386</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1387"><a href="#NSSession-1387"><span class="linenos">1387</span></a><span class="sd">            name (str): The name of the collection you want to create</span>
</span><span id="NSSession-1388"><a href="#NSSession-1388"><span class="linenos">1388</span></a>
</span><span id="NSSession-1389"><a href="#NSSession-1389"><span class="linenos">1389</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1390"><a href="#NSSession-1390"><span class="linenos">1390</span></a><span class="sd">            bool: Whether the creating was successfully added or not</span>
</span><span id="NSSession-1391"><a href="#NSSession-1391"><span class="linenos">1391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1392"><a href="#NSSession-1392"><span class="linenos">1392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> collection&quot;</span><span class="p">)</span>
</span><span id="NSSession-1393"><a href="#NSSession-1393"><span class="linenos">1393</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession-1394"><a href="#NSSession-1394"><span class="linenos">1394</span></a>
</span><span id="NSSession-1395"><a href="#NSSession-1395"><span class="linenos">1395</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;edit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;collection_name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;save_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-1396"><a href="#NSSession-1396"><span class="linenos">1396</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1397"><a href="#NSSession-1397"><span class="linenos">1397</span></a>
</span><span id="NSSession-1398"><a href="#NSSession-1398"><span class="linenos">1398</span></a>        <span class="k">return</span> <span class="s2">&quot;Created collection!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1399"><a href="#NSSession-1399"><span class="linenos">1399</span></a>
</span><span id="NSSession-1400"><a href="#NSSession-1400"><span class="linenos">1400</span></a>    <span class="k">def</span> <span class="nf">delete_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession-1401"><a href="#NSSession-1401"><span class="linenos">1401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes a collection named name</span>
</span><span id="NSSession-1402"><a href="#NSSession-1402"><span class="linenos">1402</span></a>
</span><span id="NSSession-1403"><a href="#NSSession-1403"><span class="linenos">1403</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1404"><a href="#NSSession-1404"><span class="linenos">1404</span></a><span class="sd">            name (str): The name of the collection you want to delete</span>
</span><span id="NSSession-1405"><a href="#NSSession-1405"><span class="linenos">1405</span></a>
</span><span id="NSSession-1406"><a href="#NSSession-1406"><span class="linenos">1406</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1407"><a href="#NSSession-1407"><span class="linenos">1407</span></a><span class="sd">            bool: Whether the deleting was successfully added or not</span>
</span><span id="NSSession-1408"><a href="#NSSession-1408"><span class="linenos">1408</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1409"><a href="#NSSession-1409"><span class="linenos">1409</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleting </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> collection&quot;</span><span class="p">)</span>
</span><span id="NSSession-1410"><a href="#NSSession-1410"><span class="linenos">1410</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession-1411"><a href="#NSSession-1411"><span class="linenos">1411</span></a>
</span><span id="NSSession-1412"><a href="#NSSession-1412"><span class="linenos">1412</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;edit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;collection_name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;delete_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-1413"><a href="#NSSession-1413"><span class="linenos">1413</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1414"><a href="#NSSession-1414"><span class="linenos">1414</span></a>
</span><span id="NSSession-1415"><a href="#NSSession-1415"><span class="linenos">1415</span></a>        <span class="k">return</span> <span class="s2">&quot;Created collection!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1416"><a href="#NSSession-1416"><span class="linenos">1416</span></a>
</span><span id="NSSession-1417"><a href="#NSSession-1417"><span class="linenos">1417</span></a>    <span class="k">def</span> <span class="nf">can_nation_be_founded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession-1418"><a href="#NSSession-1418"><span class="linenos">1418</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if a nation can be founded</span>
</span><span id="NSSession-1419"><a href="#NSSession-1419"><span class="linenos">1419</span></a>
</span><span id="NSSession-1420"><a href="#NSSession-1420"><span class="linenos">1420</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1421"><a href="#NSSession-1421"><span class="linenos">1421</span></a><span class="sd">            name (str): The name of the nation you want to check</span>
</span><span id="NSSession-1422"><a href="#NSSession-1422"><span class="linenos">1422</span></a>
</span><span id="NSSession-1423"><a href="#NSSession-1423"><span class="linenos">1423</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1424"><a href="#NSSession-1424"><span class="linenos">1424</span></a><span class="sd">            bool: Whether the nation can be founded or not</span>
</span><span id="NSSession-1425"><a href="#NSSession-1425"><span class="linenos">1425</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1426"><a href="#NSSession-1426"><span class="linenos">1426</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> in boneyard&quot;</span><span class="p">)</span>
</span><span id="NSSession-1427"><a href="#NSSession-1427"><span class="linenos">1427</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=boneyard&quot;</span>
</span><span id="NSSession-1428"><a href="#NSSession-1428"><span class="linenos">1428</span></a>
</span><span id="NSSession-1429"><a href="#NSSession-1429"><span class="linenos">1429</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;submit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-1430"><a href="#NSSession-1430"><span class="linenos">1430</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1431"><a href="#NSSession-1431"><span class="linenos">1431</span></a>
</span><span id="NSSession-1432"><a href="#NSSession-1432"><span class="linenos">1432</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="NSSession-1433"><a href="#NSSession-1433"><span class="linenos">1433</span></a>            <span class="s2">&quot;Available! This name may be used to found a new nation.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1434"><a href="#NSSession-1434"><span class="linenos">1434</span></a>        <span class="p">)</span>
</span><span id="NSSession-1435"><a href="#NSSession-1435"><span class="linenos">1435</span></a>
</span><span id="NSSession-1436"><a href="#NSSession-1436"><span class="linenos">1436</span></a>    <span class="k">def</span> <span class="nf">join_nday_faction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession-1437"><a href="#NSSession-1437"><span class="linenos">1437</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Joins a faction in the N-Day event</span>
</span><span id="NSSession-1438"><a href="#NSSession-1438"><span class="linenos">1438</span></a>
</span><span id="NSSession-1439"><a href="#NSSession-1439"><span class="linenos">1439</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1440"><a href="#NSSession-1440"><span class="linenos">1440</span></a><span class="sd">            id (str): The ID of the faction you want to join</span>
</span><span id="NSSession-1441"><a href="#NSSession-1441"><span class="linenos">1441</span></a>
</span><span id="NSSession-1442"><a href="#NSSession-1442"><span class="linenos">1442</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1443"><a href="#NSSession-1443"><span class="linenos">1443</span></a><span class="sd">            bool: Whether the joining was successful or not</span>
</span><span id="NSSession-1444"><a href="#NSSession-1444"><span class="linenos">1444</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1445"><a href="#NSSession-1445"><span class="linenos">1445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joining faction </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1446"><a href="#NSSession-1446"><span class="linenos">1446</span></a>
</span><span id="NSSession-1447"><a href="#NSSession-1447"><span class="linenos">1447</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="NSSession-1448"><a href="#NSSession-1448"><span class="linenos">1448</span></a>            <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=faction/fid=</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-1449"><a href="#NSSession-1449"><span class="linenos">1449</span></a>        <span class="p">)</span>
</span><span id="NSSession-1450"><a href="#NSSession-1450"><span class="linenos">1450</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;join_faction&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-1451"><a href="#NSSession-1451"><span class="linenos">1451</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1452"><a href="#NSSession-1452"><span class="linenos">1452</span></a>
</span><span id="NSSession-1453"><a href="#NSSession-1453"><span class="linenos">1453</span></a>        <span class="k">return</span> <span class="s2">&quot; has joined &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession-1454"><a href="#NSSession-1454"><span class="linenos">1454</span></a>
</span><span id="NSSession-1455"><a href="#NSSession-1455"><span class="linenos">1455</span></a>    <span class="k">def</span> <span class="nf">leave_nday_faction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession-1456"><a href="#NSSession-1456"><span class="linenos">1456</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Leaves a faction in the N-Day event</span>
</span><span id="NSSession-1457"><a href="#NSSession-1457"><span class="linenos">1457</span></a>
</span><span id="NSSession-1458"><a href="#NSSession-1458"><span class="linenos">1458</span></a><span class="sd">        Args:</span>
</span><span id="NSSession-1459"><a href="#NSSession-1459"><span class="linenos">1459</span></a><span class="sd">            id (str): The ID of the faction you want to leave</span>
</span><span id="NSSession-1460"><a href="#NSSession-1460"><span class="linenos">1460</span></a>
</span><span id="NSSession-1461"><a href="#NSSession-1461"><span class="linenos">1461</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession-1462"><a href="#NSSession-1462"><span class="linenos">1462</span></a><span class="sd">            bool: Whether the leaving was successful or not</span>
</span><span id="NSSession-1463"><a href="#NSSession-1463"><span class="linenos">1463</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession-1464"><a href="#NSSession-1464"><span class="linenos">1464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Leaving faction </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession-1465"><a href="#NSSession-1465"><span class="linenos">1465</span></a>
</span><span id="NSSession-1466"><a href="#NSSession-1466"><span class="linenos">1466</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="NSSession-1467"><a href="#NSSession-1467"><span class="linenos">1467</span></a>            <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=faction/fid=</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession-1468"><a href="#NSSession-1468"><span class="linenos">1468</span></a>        <span class="p">)</span>
</span><span id="NSSession-1469"><a href="#NSSession-1469"><span class="linenos">1469</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;leave_faction&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession-1470"><a href="#NSSession-1470"><span class="linenos">1470</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession-1471"><a href="#NSSession-1471"><span class="linenos">1471</span></a>
</span><span id="NSSession-1472"><a href="#NSSession-1472"><span class="linenos">1472</span></a>        <span class="k">return</span> <span class="s2">&quot; has left &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


    

                            <div id="NSSession.__init__" class="classattr">
                                        <input id="NSSession.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">NSSession</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">script_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">script_version</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">script_author</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">script_user</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">keybind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;space&#39;</span>,</span><span class="param">	<span class="n">link_to_src</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span></span>)</span>

                <label class="view-source-button" for="NSSession.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.__init__-59"><a href="#NSSession.__init__-59"><span class="linenos"> 59</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="NSSession.__init__-60"><a href="#NSSession.__init__-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.__init__-61"><a href="#NSSession.__init__-61"><span class="linenos"> 61</span></a>        <span class="n">script_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.__init__-62"><a href="#NSSession.__init__-62"><span class="linenos"> 62</span></a>        <span class="n">script_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.__init__-63"><a href="#NSSession.__init__-63"><span class="linenos"> 63</span></a>        <span class="n">script_author</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.__init__-64"><a href="#NSSession.__init__-64"><span class="linenos"> 64</span></a>        <span class="n">script_user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.__init__-65"><a href="#NSSession.__init__-65"><span class="linenos"> 65</span></a>        <span class="n">keybind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;space&quot;</span><span class="p">,</span>
</span><span id="NSSession.__init__-66"><a href="#NSSession.__init__-66"><span class="linenos"> 66</span></a>        <span class="n">link_to_src</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.__init__-67"><a href="#NSSession.__init__-67"><span class="linenos"> 67</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">logging</span><span class="o">.</span><span class="n">Logger</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="NSSession.__init__-68"><a href="#NSSession.__init__-68"><span class="linenos"> 68</span></a>    <span class="p">):</span>
</span><span id="NSSession.__init__-69"><a href="#NSSession.__init__-69"><span class="linenos"> 69</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;A wrapper around httpx that abstracts away</span>
</span><span id="NSSession.__init__-70"><a href="#NSSession.__init__-70"><span class="linenos"> 70</span></a><span class="sd">        interacting with the HTML nationstates.net site.</span>
</span><span id="NSSession.__init__-71"><a href="#NSSession.__init__-71"><span class="linenos"> 71</span></a><span class="sd">        Focused on legality, correctness, and ease of use.</span>
</span><span id="NSSession.__init__-72"><a href="#NSSession.__init__-72"><span class="linenos"> 72</span></a>
</span><span id="NSSession.__init__-73"><a href="#NSSession.__init__-73"><span class="linenos"> 73</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.__init__-74"><a href="#NSSession.__init__-74"><span class="linenos"> 74</span></a><span class="sd">            script_name (str): Name of your script</span>
</span><span id="NSSession.__init__-75"><a href="#NSSession.__init__-75"><span class="linenos"> 75</span></a><span class="sd">            script_version (str): Version number of your script</span>
</span><span id="NSSession.__init__-76"><a href="#NSSession.__init__-76"><span class="linenos"> 76</span></a><span class="sd">            script_author (str): Author of your script</span>
</span><span id="NSSession.__init__-77"><a href="#NSSession.__init__-77"><span class="linenos"> 77</span></a><span class="sd">            script_user (str): Nation name of the user running your script</span>
</span><span id="NSSession.__init__-78"><a href="#NSSession.__init__-78"><span class="linenos"> 78</span></a><span class="sd">            keybind (str, optional): Keybind to count as a user click. Defaults to &quot;space&quot;.</span>
</span><span id="NSSession.__init__-79"><a href="#NSSession.__init__-79"><span class="linenos"> 79</span></a><span class="sd">            link_to_src (str, optional): Link to the source code of your script.</span>
</span><span id="NSSession.__init__-80"><a href="#NSSession.__init__-80"><span class="linenos"> 80</span></a><span class="sd">            logger (logging.Logger | None, optional): Logger to use. Will create its own with name &quot;NSDotPy&quot; if none is specified. Defaults to None.</span>
</span><span id="NSSession.__init__-81"><a href="#NSSession.__init__-81"><span class="linenos"> 81</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.__init__-82"><a href="#NSSession.__init__-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">VERSION</span> <span class="o">=</span> <span class="s2">&quot;2.3.0&quot;</span>
</span><span id="NSSession.__init__-83"><a href="#NSSession.__init__-83"><span class="linenos"> 83</span></a>        <span class="c1"># Initialize logger</span>
</span><span id="NSSession.__init__-84"><a href="#NSSession.__init__-84"><span class="linenos"> 84</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">logger</span><span class="p">:</span>
</span><span id="NSSession.__init__-85"><a href="#NSSession.__init__-85"><span class="linenos"> 85</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_init_logger</span><span class="p">()</span>
</span><span id="NSSession.__init__-86"><a href="#NSSession.__init__-86"><span class="linenos"> 86</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NSSession.__init__-87"><a href="#NSSession.__init__-87"><span class="linenos"> 87</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logger</span>
</span><span id="NSSession.__init__-88"><a href="#NSSession.__init__-88"><span class="linenos"> 88</span></a>        <span class="c1"># Create a new httpx session</span>
</span><span id="NSSession.__init__-89"><a href="#NSSession.__init__-89"><span class="linenos"> 89</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_session</span> <span class="o">=</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span>
</span><span id="NSSession.__init__-90"><a href="#NSSession.__init__-90"><span class="linenos"> 90</span></a>            <span class="n">http2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span>
</span><span id="NSSession.__init__-91"><a href="#NSSession.__init__-91"><span class="linenos"> 91</span></a>        <span class="p">)</span>  <span class="c1"># ns can b slow, 30 seconds is hopefully a good sweet spot</span>
</span><span id="NSSession.__init__-92"><a href="#NSSession.__init__-92"><span class="linenos"> 92</span></a>        <span class="c1"># Set the user agent to the script name, version, author, and user as recommended in the script rules thread:</span>
</span><span id="NSSession.__init__-93"><a href="#NSSession.__init__-93"><span class="linenos"> 93</span></a>        <span class="c1"># https://forum.nationstates.net/viewtopic.php?p=16394966&amp;sid=be37623536dbc8cee42d8d043945b887#p16394966</span>
</span><span id="NSSession.__init__-94"><a href="#NSSession.__init__-94"><span class="linenos"> 94</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="NSSession.__init__-95"><a href="#NSSession.__init__-95"><span class="linenos"> 95</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_user_agent</span><span class="p">(</span>
</span><span id="NSSession.__init__-96"><a href="#NSSession.__init__-96"><span class="linenos"> 96</span></a>            <span class="n">script_name</span><span class="p">,</span> <span class="n">script_version</span><span class="p">,</span> <span class="n">script_author</span><span class="p">,</span> <span class="n">script_user</span><span class="p">,</span> <span class="n">link_to_src</span>
</span><span id="NSSession.__init__-97"><a href="#NSSession.__init__-97"><span class="linenos"> 97</span></a>        <span class="p">)</span>
</span><span id="NSSession.__init__-98"><a href="#NSSession.__init__-98"><span class="linenos"> 98</span></a>        <span class="c1"># Initialize nationstates specific stuff</span>
</span><span id="NSSession.__init__-99"><a href="#NSSession.__init__-99"><span class="linenos"> 99</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_auth_region</span> <span class="o">=</span> <span class="s2">&quot;rwby&quot;</span>
</span><span id="NSSession.__init__-100"><a href="#NSSession.__init__-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">chk</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession.__init__-101"><a href="#NSSession.__init__-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">localid</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession.__init__-102"><a href="#NSSession.__init__-102"><span class="linenos">102</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession.__init__-103"><a href="#NSSession.__init__-103"><span class="linenos">103</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession.__init__-104"><a href="#NSSession.__init__-104"><span class="linenos">104</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession.__init__-105"><a href="#NSSession.__init__-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">keybind</span> <span class="o">=</span> <span class="n">keybind</span>
</span><span id="NSSession.__init__-106"><a href="#NSSession.__init__-106"><span class="linenos">106</span></a>        <span class="c1"># Make sure the nations in the user agent actually exist</span>
</span><span id="NSSession.__init__-107"><a href="#NSSession.__init__-107"><span class="linenos">107</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_nations</span><span class="p">({</span><span class="n">script_author</span><span class="p">,</span> <span class="n">script_user</span><span class="p">}):</span>
</span><span id="NSSession.__init__-108"><a href="#NSSession.__init__-108"><span class="linenos">108</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="NSSession.__init__-109"><a href="#NSSession.__init__-109"><span class="linenos">109</span></a>                <span class="s2">&quot;One of, or both, of the nations in the user agent do not exist. Make sure you&#39;re only including the nation name in the constructor, e.g. &#39;Thorn1000&#39; instead of &#39;Devved by Thorn1000&#39;&quot;</span>
</span><span id="NSSession.__init__-110"><a href="#NSSession.__init__-110"><span class="linenos">110</span></a>            <span class="p">)</span>
</span><span id="NSSession.__init__-111"><a href="#NSSession.__init__-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initialized. Keybind to continue is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">keybind</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A wrapper around httpx that abstracts away
interacting with the HTML nationstates.net site.
Focused on legality, correctness, and ease of use.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>script_name (str):</strong>  Name of your script</li>
<li><strong>script_version (str):</strong>  Version number of your script</li>
<li><strong>script_author (str):</strong>  Author of your script</li>
<li><strong>script_user (str):</strong>  Nation name of the user running your script</li>
<li><strong>keybind (str, optional):</strong>  Keybind to count as a user click. Defaults to "space".</li>
<li><strong>link_to_src (str, optional):</strong>  Link to the source code of your script.</li>
<li><strong>logger (logging.Logger | None, optional):</strong>  Logger to use. Will create its own with name "NSDotPy" if none is specified. Defaults to None.</li>
</ul>
</div>


                            </div>
                            <div id="NSSession.refresh_auth_values" class="classattr">
                                        <input id="NSSession.refresh_auth_values-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">refresh_auth_values</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NSSession.refresh_auth_values-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.refresh_auth_values"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.refresh_auth_values-298"><a href="#NSSession.refresh_auth_values-298"><span class="linenos">298</span></a>    <span class="k">def</span> <span class="nf">refresh_auth_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NSSession.refresh_auth_values-299"><a href="#NSSession.refresh_auth_values-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Refreshing authentication values...&quot;</span><span class="p">)</span>
</span><span id="NSSession.refresh_auth_values-300"><a href="#NSSession.refresh_auth_values-300"><span class="linenos">300</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span>
</span><span id="NSSession.refresh_auth_values-301"><a href="#NSSession.refresh_auth_values-301"><span class="linenos">301</span></a>            <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/page=display_region/region=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth_region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="NSSession.refresh_auth_values-302"><a href="#NSSession.refresh_auth_values-302"><span class="linenos">302</span></a>            <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="s2">&quot;century&quot;</span><span class="p">},</span>
</span><span id="NSSession.refresh_auth_values-303"><a href="#NSSession.refresh_auth_values-303"><span class="linenos">303</span></a>        <span class="p">)</span>
</span><span id="NSSession.refresh_auth_values-304"><a href="#NSSession.refresh_auth_values-304"><span class="linenos">304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_get_auth_values</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="NSSession.request" class="classattr">
                                        <input id="NSSession.request-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">request</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">url</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">files</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">follow_redirects</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">httpx</span><span class="o">.</span><span class="n">Response</span>:</span></span>

                <label class="view-source-button" for="NSSession.request-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.request"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.request-306"><a href="#NSSession.request-306"><span class="linenos">306</span></a>    <span class="k">def</span> <span class="nf">request</span><span class="p">(</span>
</span><span id="NSSession.request-307"><a href="#NSSession.request-307"><span class="linenos">307</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.request-308"><a href="#NSSession.request-308"><span class="linenos">308</span></a>        <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.request-309"><a href="#NSSession.request-309"><span class="linenos">309</span></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="NSSession.request-310"><a href="#NSSession.request-310"><span class="linenos">310</span></a>        <span class="n">files</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="NSSession.request-311"><a href="#NSSession.request-311"><span class="linenos">311</span></a>        <span class="n">follow_redirects</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession.request-312"><a href="#NSSession.request-312"><span class="linenos">312</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">httpx</span><span class="o">.</span><span class="n">Response</span><span class="p">:</span>
</span><span id="NSSession.request-313"><a href="#NSSession.request-313"><span class="linenos">313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends a request to the given url with the given data and files.</span>
</span><span id="NSSession.request-314"><a href="#NSSession.request-314"><span class="linenos">314</span></a>
</span><span id="NSSession.request-315"><a href="#NSSession.request-315"><span class="linenos">315</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.request-316"><a href="#NSSession.request-316"><span class="linenos">316</span></a><span class="sd">            url (str): URL to send the request to</span>
</span><span id="NSSession.request-317"><a href="#NSSession.request-317"><span class="linenos">317</span></a><span class="sd">            data (dict, optional): Payload to send with the request</span>
</span><span id="NSSession.request-318"><a href="#NSSession.request-318"><span class="linenos">318</span></a><span class="sd">            files (dict, optional): Payload to send with requests that upload files</span>
</span><span id="NSSession.request-319"><a href="#NSSession.request-319"><span class="linenos">319</span></a>
</span><span id="NSSession.request-320"><a href="#NSSession.request-320"><span class="linenos">320</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.request-321"><a href="#NSSession.request-321"><span class="linenos">321</span></a><span class="sd">            httpx.Response: The response from the server</span>
</span><span id="NSSession.request-322"><a href="#NSSession.request-322"><span class="linenos">322</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.request-323"><a href="#NSSession.request-323"><span class="linenos">323</span></a>        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
</span><span id="NSSession.request-324"><a href="#NSSession.request-324"><span class="linenos">324</span></a>            <span class="n">banned_page</span> <span class="ow">in</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span><span id="NSSession.request-325"><a href="#NSSession.request-325"><span class="linenos">325</span></a>            <span class="k">for</span> <span class="n">banned_page</span> <span class="ow">in</span> <span class="p">{</span>
</span><span id="NSSession.request-326"><a href="#NSSession.request-326"><span class="linenos">326</span></a>                <span class="s2">&quot;page=telegrams&quot;</span><span class="p">,</span>
</span><span id="NSSession.request-327"><a href="#NSSession.request-327"><span class="linenos">327</span></a>                <span class="s2">&quot;page=dilemmas&quot;</span><span class="p">,</span>
</span><span id="NSSession.request-328"><a href="#NSSession.request-328"><span class="linenos">328</span></a>                <span class="s2">&quot;page=compose_telegram&quot;</span><span class="p">,</span>
</span><span id="NSSession.request-329"><a href="#NSSession.request-329"><span class="linenos">329</span></a>                <span class="s2">&quot;page=store&quot;</span><span class="p">,</span>
</span><span id="NSSession.request-330"><a href="#NSSession.request-330"><span class="linenos">330</span></a>                <span class="s2">&quot;page=help&quot;</span><span class="p">,</span>
</span><span id="NSSession.request-331"><a href="#NSSession.request-331"><span class="linenos">331</span></a>            <span class="p">}</span>
</span><span id="NSSession.request-332"><a href="#NSSession.request-332"><span class="linenos">332</span></a>        <span class="p">):</span>
</span><span id="NSSession.request-333"><a href="#NSSession.request-333"><span class="linenos">333</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="NSSession.request-334"><a href="#NSSession.request-334"><span class="linenos">334</span></a>                <span class="s2">&quot;You cannot use a tool to interact with telegrams, issues, getting help, or the store. Read up on the script rules: https://forum.nationstates.net/viewtopic.php?p=16394966#p16394966&quot;</span>
</span><span id="NSSession.request-335"><a href="#NSSession.request-335"><span class="linenos">335</span></a>            <span class="p">)</span>
</span><span id="NSSession.request-336"><a href="#NSSession.request-336"><span class="linenos">336</span></a>        <span class="k">if</span> <span class="s2">&quot;api.cgi&quot;</span> <span class="ow">in</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span><span id="NSSession.request-337"><a href="#NSSession.request-337"><span class="linenos">337</span></a>            <span class="c1"># you should be using api_request for api requests</span>
</span><span id="NSSession.request-338"><a href="#NSSession.request-338"><span class="linenos">338</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;You should be using api_request() for api requests.&quot;</span><span class="p">)</span>
</span><span id="NSSession.request-339"><a href="#NSSession.request-339"><span class="linenos">339</span></a>        <span class="k">elif</span> <span class="s2">&quot;nationstates&quot;</span> <span class="ow">in</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span><span id="NSSession.request-340"><a href="#NSSession.request-340"><span class="linenos">340</span></a>            <span class="c1"># do all the things that need to be done for html requests</span>
</span><span id="NSSession.request-341"><a href="#NSSession.request-341"><span class="linenos">341</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span><span class="p">:</span>
</span><span id="NSSession.request-342"><a href="#NSSession.request-342"><span class="linenos">342</span></a>                <span class="c1"># if lock is true then we&#39;re already in the middle of a</span>
</span><span id="NSSession.request-343"><a href="#NSSession.request-343"><span class="linenos">343</span></a>                <span class="c1"># request and we&#39;re in danger of breaking the simultaneity rule</span>
</span><span id="NSSession.request-344"><a href="#NSSession.request-344"><span class="linenos">344</span></a>                <span class="c1"># so raise an error</span>
</span><span id="NSSession.request-345"><a href="#NSSession.request-345"><span class="linenos">345</span></a>                <span class="k">raise</span> <span class="ne">PermissionError</span><span class="p">(</span>
</span><span id="NSSession.request-346"><a href="#NSSession.request-346"><span class="linenos">346</span></a>                    <span class="s2">&quot;You&#39;re already in the middle of a request. Stop trying to violate simultaneity.&quot;</span>
</span><span id="NSSession.request-347"><a href="#NSSession.request-347"><span class="linenos">347</span></a>                <span class="p">)</span>
</span><span id="NSSession.request-348"><a href="#NSSession.request-348"><span class="linenos">348</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="NSSession.request-349"><a href="#NSSession.request-349"><span class="linenos">349</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_html_request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="p">)</span>
</span><span id="NSSession.request-350"><a href="#NSSession.request-350"><span class="linenos">350</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_lock</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="NSSession.request-351"><a href="#NSSession.request-351"><span class="linenos">351</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NSSession.request-352"><a href="#NSSession.request-352"><span class="linenos">352</span></a>            <span class="c1"># if its not nationstates then just pass the request through</span>
</span><span id="NSSession.request-353"><a href="#NSSession.request-353"><span class="linenos">353</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span><span id="NSSession.request-354"><a href="#NSSession.request-354"><span class="linenos">354</span></a>                <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">follow_redirects</span><span class="o">=</span><span class="n">follow_redirects</span>
</span><span id="NSSession.request-355"><a href="#NSSession.request-355"><span class="linenos">355</span></a>            <span class="p">)</span>
</span><span id="NSSession.request-356"><a href="#NSSession.request-356"><span class="linenos">356</span></a>        <span class="k">return</span> <span class="n">response</span>
</span></pre></div>


            <div class="docstring"><p>Sends a request to the given url with the given data and files.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>url (str):</strong>  URL to send the request to</li>
<li><strong>data (dict, optional):</strong>  Payload to send with the request</li>
<li><strong>files (dict, optional):</strong>  Payload to send with requests that upload files</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>httpx.Response: The response from the server</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.api_request" class="classattr">
                                        <input id="NSSession.api_request-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">api_request</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">api</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">shard</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">benedict</span><span class="o">.</span><span class="n">dicts</span><span class="o">.</span><span class="n">benedict</span>:</span></span>

                <label class="view-source-button" for="NSSession.api_request-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.api_request"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.api_request-358"><a href="#NSSession.api_request-358"><span class="linenos">358</span></a>    <span class="k">def</span> <span class="nf">api_request</span><span class="p">(</span>
</span><span id="NSSession.api_request-359"><a href="#NSSession.api_request-359"><span class="linenos">359</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.api_request-360"><a href="#NSSession.api_request-360"><span class="linenos">360</span></a>        <span class="n">api</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_request-361"><a href="#NSSession.api_request-361"><span class="linenos">361</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="NSSession.api_request-362"><a href="#NSSession.api_request-362"><span class="linenos">362</span></a>        <span class="n">target</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_request-363"><a href="#NSSession.api_request-363"><span class="linenos">363</span></a>        <span class="n">shard</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_request-364"><a href="#NSSession.api_request-364"><span class="linenos">364</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_request-365"><a href="#NSSession.api_request-365"><span class="linenos">365</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession.api_request-366"><a href="#NSSession.api_request-366"><span class="linenos">366</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession.api_request-367"><a href="#NSSession.api_request-367"><span class="linenos">367</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends a request to the nationstates api with the given data.</span>
</span><span id="NSSession.api_request-368"><a href="#NSSession.api_request-368"><span class="linenos">368</span></a>
</span><span id="NSSession.api_request-369"><a href="#NSSession.api_request-369"><span class="linenos">369</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.api_request-370"><a href="#NSSession.api_request-370"><span class="linenos">370</span></a><span class="sd">            api (str): The api to send the request to. Must be &quot;nation&quot;, &quot;region&quot;, &quot;world&quot;, or &quot;wa&quot;</span>
</span><span id="NSSession.api_request-371"><a href="#NSSession.api_request-371"><span class="linenos">371</span></a><span class="sd">            target (str, optional): The nation, region, or wa council to target. Required for non-world api requests.</span>
</span><span id="NSSession.api_request-372"><a href="#NSSession.api_request-372"><span class="linenos">372</span></a><span class="sd">            shard (str, optional): The shard, or shards, you&#39;re requesting for. Must be a valid shard for the given api. Only required for world and wa api requests.</span>
</span><span id="NSSession.api_request-373"><a href="#NSSession.api_request-373"><span class="linenos">373</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession.api_request-374"><a href="#NSSession.api_request-374"><span class="linenos">374</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession.api_request-375"><a href="#NSSession.api_request-375"><span class="linenos">375</span></a>
</span><span id="NSSession.api_request-376"><a href="#NSSession.api_request-376"><span class="linenos">376</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.api_request-377"><a href="#NSSession.api_request-377"><span class="linenos">377</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession.api_request-378"><a href="#NSSession.api_request-378"><span class="linenos">378</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.api_request-379"><a href="#NSSession.api_request-379"><span class="linenos">379</span></a>        <span class="c1"># TODO: probably move this responsibility to a third party api library to avoid reinventing the wheel</span>
</span><span id="NSSession.api_request-380"><a href="#NSSession.api_request-380"><span class="linenos">380</span></a>        <span class="c1"># if one exists of sufficient quality thats AGPLv3 compatible</span>
</span><span id="NSSession.api_request-381"><a href="#NSSession.api_request-381"><span class="linenos">381</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;nation&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">,</span> <span class="s2">&quot;wa&quot;</span><span class="p">}:</span>
</span><span id="NSSession.api_request-382"><a href="#NSSession.api_request-382"><span class="linenos">382</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;api must be &#39;nation&#39;, &#39;region&#39;, &#39;world&#39;, or &#39;wa&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_request-383"><a href="#NSSession.api_request-383"><span class="linenos">383</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="o">!=</span> <span class="s2">&quot;world&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">target</span><span class="p">:</span>
</span><span id="NSSession.api_request-384"><a href="#NSSession.api_request-384"><span class="linenos">384</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;target must be specified for non-world api requests&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_request-385"><a href="#NSSession.api_request-385"><span class="linenos">385</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;wa&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">}</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">shard</span><span class="p">:</span>
</span><span id="NSSession.api_request-386"><a href="#NSSession.api_request-386"><span class="linenos">386</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;shard must be specified for world and wa api requests&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_request-387"><a href="#NSSession.api_request-387"><span class="linenos">387</span></a>        <span class="c1"># end argument validation</span>
</span><span id="NSSession.api_request-388"><a href="#NSSession.api_request-388"><span class="linenos">388</span></a>        <span class="c1"># shard validation</span>
</span><span id="NSSession.api_request-389"><a href="#NSSession.api_request-389"><span class="linenos">389</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">shard</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="NSSession.api_request-390"><a href="#NSSession.api_request-390"><span class="linenos">390</span></a>            <span class="n">shard</span> <span class="o">=</span> <span class="p">{</span><span class="n">shard</span><span class="p">}</span>
</span><span id="NSSession.api_request-391"><a href="#NSSession.api_request-391"><span class="linenos">391</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_shards</span><span class="p">(</span><span class="n">api</span><span class="p">,</span> <span class="n">shard</span><span class="p">)</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession.api_request-392"><a href="#NSSession.api_request-392"><span class="linenos">392</span></a>        <span class="c1"># end shard validation</span>
</span><span id="NSSession.api_request-393"><a href="#NSSession.api_request-393"><span class="linenos">393</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.api_request-394"><a href="#NSSession.api_request-394"><span class="linenos">394</span></a>            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_request-395"><a href="#NSSession.api_request-395"><span class="linenos">395</span></a>        <span class="p">}</span>
</span><span id="NSSession.api_request-396"><a href="#NSSession.api_request-396"><span class="linenos">396</span></a>        <span class="k">if</span> <span class="n">api</span> <span class="o">!=</span> <span class="s2">&quot;world&quot;</span><span class="p">:</span>
</span><span id="NSSession.api_request-397"><a href="#NSSession.api_request-397"><span class="linenos">397</span></a>            <span class="n">data</span><span class="p">[</span><span class="n">api</span><span class="p">]</span> <span class="o">=</span> <span class="n">target</span>
</span><span id="NSSession.api_request-398"><a href="#NSSession.api_request-398"><span class="linenos">398</span></a>        <span class="k">if</span> <span class="n">shard</span><span class="p">:</span>
</span><span id="NSSession.api_request-399"><a href="#NSSession.api_request-399"><span class="linenos">399</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;q&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">shard</span><span class="p">)</span>
</span><span id="NSSession.api_request-400"><a href="#NSSession.api_request-400"><span class="linenos">400</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/api.cgi&quot;</span>
</span><span id="NSSession.api_request-401"><a href="#NSSession.api_request-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession.api_request-402"><a href="#NSSession.api_request-402"><span class="linenos">402</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="NSSession.api_request-403"><a href="#NSSession.api_request-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span>
</span><span id="NSSession.api_request-404"><a href="#NSSession.api_request-404"><span class="linenos">404</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span>
</span><span id="NSSession.api_request-405"><a href="#NSSession.api_request-405"><span class="linenos">405</span></a>        <span class="c1"># rate limiting section</span>
</span><span id="NSSession.api_request-406"><a href="#NSSession.api_request-406"><span class="linenos">406</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.api_request-407"><a href="#NSSession.api_request-407"><span class="linenos">407</span></a>        <span class="c1"># if the server tells us to wait, wait</span>
</span><span id="NSSession.api_request-408"><a href="#NSSession.api_request-408"><span class="linenos">408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ratelimit</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">)</span>
</span><span id="NSSession.api_request-409"><a href="#NSSession.api_request-409"><span class="linenos">409</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="NSSession.api_request-410"><a href="#NSSession.api_request-410"><span class="linenos">410</span></a>        <span class="n">parsed_response</span> <span class="o">=</span> <span class="n">benedict</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">keyattr_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NSSession.api_request-411"><a href="#NSSession.api_request-411"><span class="linenos">411</span></a>        <span class="n">parsed_response</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</span><span id="NSSession.api_request-412"><a href="#NSSession.api_request-412"><span class="linenos">412</span></a>        <span class="n">parsed_response</span><span class="p">:</span> <span class="n">benedict</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="n">api</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession.api_request-413"><a href="#NSSession.api_request-413"><span class="linenos">413</span></a>        <span class="k">return</span> <span class="n">parsed_response</span>
</span></pre></div>


            <div class="docstring"><p>Sends a request to the nationstates api with the given data.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>api (str):</strong>  The api to send the request to. Must be "nation", "region", "world", or "wa"</li>
<li><strong>target (str, optional):</strong>  The nation, region, or wa council to target. Required for non-world api requests.</li>
<li><strong>shard (str, optional):</strong>  The shard, or shards, you're requesting for. Must be a valid shard for the given api. Only required for world and wa api requests.</li>
<li><strong>password (str, optional):</strong>  The password to use for authenticating private api requests. Defaults to "". Not required if already signed in, whether through the api or through the HTML site.</li>
<li><strong>constant_rate_limit (bool, optional):</strong>  If True, will always rate limit. If False, will only rate limit when there's less than 10 requests left in the current bucket. Defaults to False.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.api_issue" class="classattr">
                                        <input id="NSSession.api_issue-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">api_issue</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nation</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">issue</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">option</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">benedict</span><span class="o">.</span><span class="n">dicts</span><span class="o">.</span><span class="n">benedict</span>:</span></span>

                <label class="view-source-button" for="NSSession.api_issue-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.api_issue"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.api_issue-415"><a href="#NSSession.api_issue-415"><span class="linenos">415</span></a>    <span class="k">def</span> <span class="nf">api_issue</span><span class="p">(</span>
</span><span id="NSSession.api_issue-416"><a href="#NSSession.api_issue-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.api_issue-417"><a href="#NSSession.api_issue-417"><span class="linenos">417</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_issue-418"><a href="#NSSession.api_issue-418"><span class="linenos">418</span></a>        <span class="n">issue</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="NSSession.api_issue-419"><a href="#NSSession.api_issue-419"><span class="linenos">419</span></a>        <span class="n">option</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="NSSession.api_issue-420"><a href="#NSSession.api_issue-420"><span class="linenos">420</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_issue-421"><a href="#NSSession.api_issue-421"><span class="linenos">421</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession.api_issue-422"><a href="#NSSession.api_issue-422"><span class="linenos">422</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession.api_issue-423"><a href="#NSSession.api_issue-423"><span class="linenos">423</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Answers an issue via the API.</span>
</span><span id="NSSession.api_issue-424"><a href="#NSSession.api_issue-424"><span class="linenos">424</span></a>
</span><span id="NSSession.api_issue-425"><a href="#NSSession.api_issue-425"><span class="linenos">425</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.api_issue-426"><a href="#NSSession.api_issue-426"><span class="linenos">426</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession.api_issue-427"><a href="#NSSession.api_issue-427"><span class="linenos">427</span></a><span class="sd">            issue (int): the ID of the issue.</span>
</span><span id="NSSession.api_issue-428"><a href="#NSSession.api_issue-428"><span class="linenos">428</span></a><span class="sd">            option (int): the issue option to choose.</span>
</span><span id="NSSession.api_issue-429"><a href="#NSSession.api_issue-429"><span class="linenos">429</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession.api_issue-430"><a href="#NSSession.api_issue-430"><span class="linenos">430</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession.api_issue-431"><a href="#NSSession.api_issue-431"><span class="linenos">431</span></a>
</span><span id="NSSession.api_issue-432"><a href="#NSSession.api_issue-432"><span class="linenos">432</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.api_issue-433"><a href="#NSSession.api_issue-433"><span class="linenos">433</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession.api_issue-434"><a href="#NSSession.api_issue-434"><span class="linenos">434</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.api_issue-435"><a href="#NSSession.api_issue-435"><span class="linenos">435</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">password</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">):</span>
</span><span id="NSSession.api_issue-436"><a href="#NSSession.api_issue-436"><span class="linenos">436</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify authentication&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_issue-437"><a href="#NSSession.api_issue-437"><span class="linenos">437</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.api_issue-438"><a href="#NSSession.api_issue-438"><span class="linenos">438</span></a>            <span class="s2">&quot;v&quot;</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_issue-439"><a href="#NSSession.api_issue-439"><span class="linenos">439</span></a>            <span class="s2">&quot;c&quot;</span><span class="p">:</span> <span class="s2">&quot;issue&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_issue-440"><a href="#NSSession.api_issue-440"><span class="linenos">440</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span>
</span><span id="NSSession.api_issue-441"><a href="#NSSession.api_issue-441"><span class="linenos">441</span></a>            <span class="s2">&quot;issue&quot;</span><span class="p">:</span> <span class="n">issue</span><span class="p">,</span>
</span><span id="NSSession.api_issue-442"><a href="#NSSession.api_issue-442"><span class="linenos">442</span></a>            <span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="n">option</span><span class="p">,</span>
</span><span id="NSSession.api_issue-443"><a href="#NSSession.api_issue-443"><span class="linenos">443</span></a>        <span class="p">}</span>
</span><span id="NSSession.api_issue-444"><a href="#NSSession.api_issue-444"><span class="linenos">444</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/api.cgi&quot;</span>
</span><span id="NSSession.api_issue-445"><a href="#NSSession.api_issue-445"><span class="linenos">445</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession.api_issue-446"><a href="#NSSession.api_issue-446"><span class="linenos">446</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="NSSession.api_issue-447"><a href="#NSSession.api_issue-447"><span class="linenos">447</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span>
</span><span id="NSSession.api_issue-448"><a href="#NSSession.api_issue-448"><span class="linenos">448</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span>
</span><span id="NSSession.api_issue-449"><a href="#NSSession.api_issue-449"><span class="linenos">449</span></a>        <span class="c1"># rate limiting section</span>
</span><span id="NSSession.api_issue-450"><a href="#NSSession.api_issue-450"><span class="linenos">450</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.api_issue-451"><a href="#NSSession.api_issue-451"><span class="linenos">451</span></a>        <span class="c1"># if the server tells us to wait, wait</span>
</span><span id="NSSession.api_issue-452"><a href="#NSSession.api_issue-452"><span class="linenos">452</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ratelimit</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">)</span>
</span><span id="NSSession.api_issue-453"><a href="#NSSession.api_issue-453"><span class="linenos">453</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="NSSession.api_issue-454"><a href="#NSSession.api_issue-454"><span class="linenos">454</span></a>        <span class="n">parsed_response</span> <span class="o">=</span> <span class="n">benedict</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">keyattr_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NSSession.api_issue-455"><a href="#NSSession.api_issue-455"><span class="linenos">455</span></a>        <span class="n">parsed_response</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</span><span id="NSSession.api_issue-456"><a href="#NSSession.api_issue-456"><span class="linenos">456</span></a>        <span class="n">parsed_response</span><span class="p">:</span> <span class="n">benedict</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="s2">&quot;nation&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession.api_issue-457"><a href="#NSSession.api_issue-457"><span class="linenos">457</span></a>        <span class="k">return</span> <span class="n">parsed_response</span>
</span></pre></div>


            <div class="docstring"><p>Answers an issue via the API.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  The nation to perform the command with.</li>
<li><strong>issue (int):</strong>  the ID of the issue.</li>
<li><strong>option (int):</strong>  the issue option to choose.</li>
<li><strong>password (str, optional):</strong>  The password to use for authenticating private api requests. Defaults to "". Not required if already signed in, whether through the api or through the HTML site.</li>
<li><strong>constant_rate_limit (bool, optional):</strong>  If True, will always rate limit. If False, will only rate limit when there's less than 10 requests left in the current bucket. Defaults to False.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.api_command" class="classattr">
                                        <input id="NSSession.api_command-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">api_command</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nation</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">command</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data</span><span class="p">:</span> <span class="nb">dict</span>,</span><span class="param">	<span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">benedict</span><span class="o">.</span><span class="n">dicts</span><span class="o">.</span><span class="n">benedict</span>:</span></span>

                <label class="view-source-button" for="NSSession.api_command-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.api_command"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.api_command-459"><a href="#NSSession.api_command-459"><span class="linenos">459</span></a>    <span class="k">def</span> <span class="nf">api_command</span><span class="p">(</span>
</span><span id="NSSession.api_command-460"><a href="#NSSession.api_command-460"><span class="linenos">460</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.api_command-461"><a href="#NSSession.api_command-461"><span class="linenos">461</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_command-462"><a href="#NSSession.api_command-462"><span class="linenos">462</span></a>        <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_command-463"><a href="#NSSession.api_command-463"><span class="linenos">463</span></a>        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
</span><span id="NSSession.api_command-464"><a href="#NSSession.api_command-464"><span class="linenos">464</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_command-465"><a href="#NSSession.api_command-465"><span class="linenos">465</span></a>        <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_command-466"><a href="#NSSession.api_command-466"><span class="linenos">466</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession.api_command-467"><a href="#NSSession.api_command-467"><span class="linenos">467</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession.api_command-468"><a href="#NSSession.api_command-468"><span class="linenos">468</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sends a non-issue command to the nationstates api with the given data and password.</span>
</span><span id="NSSession.api_command-469"><a href="#NSSession.api_command-469"><span class="linenos">469</span></a>
</span><span id="NSSession.api_command-470"><a href="#NSSession.api_command-470"><span class="linenos">470</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.api_command-471"><a href="#NSSession.api_command-471"><span class="linenos">471</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession.api_command-472"><a href="#NSSession.api_command-472"><span class="linenos">472</span></a><span class="sd">            command (str): The command to perform. Must be &quot;giftcard&quot;, &quot;dispatch&quot;, &quot;rmbpost&quot;</span>
</span><span id="NSSession.api_command-473"><a href="#NSSession.api_command-473"><span class="linenos">473</span></a><span class="sd">            data (str, optional): The unique data to send with the parameters of the command; consult the API docs for more information.</span>
</span><span id="NSSession.api_command-474"><a href="#NSSession.api_command-474"><span class="linenos">474</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession.api_command-475"><a href="#NSSession.api_command-475"><span class="linenos">475</span></a><span class="sd">            mode (str, optional): Whether to prepare or to execute the command. If value is given, does one of the two and returns result, if no value is given, does both and returns result of execute.</span>
</span><span id="NSSession.api_command-476"><a href="#NSSession.api_command-476"><span class="linenos">476</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession.api_command-477"><a href="#NSSession.api_command-477"><span class="linenos">477</span></a>
</span><span id="NSSession.api_command-478"><a href="#NSSession.api_command-478"><span class="linenos">478</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.api_command-479"><a href="#NSSession.api_command-479"><span class="linenos">479</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession.api_command-480"><a href="#NSSession.api_command-480"><span class="linenos">480</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.api_command-481"><a href="#NSSession.api_command-481"><span class="linenos">481</span></a>        <span class="k">if</span> <span class="n">command</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;giftcard&quot;</span><span class="p">,</span> <span class="s2">&quot;dispatch&quot;</span><span class="p">,</span> <span class="s2">&quot;rmbpost&quot;</span><span class="p">}:</span>
</span><span id="NSSession.api_command-482"><a href="#NSSession.api_command-482"><span class="linenos">482</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;command must be &#39;giftcard&#39;, &#39;dispatch&#39;, or &#39;rmbpost&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_command-483"><a href="#NSSession.api_command-483"><span class="linenos">483</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">password</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">):</span>
</span><span id="NSSession.api_command-484"><a href="#NSSession.api_command-484"><span class="linenos">484</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify authentication&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_command-485"><a href="#NSSession.api_command-485"><span class="linenos">485</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;prepare&quot;</span><span class="p">,</span> <span class="s2">&quot;execute&quot;</span><span class="p">}:</span>
</span><span id="NSSession.api_command-486"><a href="#NSSession.api_command-486"><span class="linenos">486</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;mode must be prepare or execute&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_command-487"><a href="#NSSession.api_command-487"><span class="linenos">487</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;v&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;12&quot;</span>
</span><span id="NSSession.api_command-488"><a href="#NSSession.api_command-488"><span class="linenos">488</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;nation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span>
</span><span id="NSSession.api_command-489"><a href="#NSSession.api_command-489"><span class="linenos">489</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
</span><span id="NSSession.api_command-490"><a href="#NSSession.api_command-490"><span class="linenos">490</span></a>        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span> <span class="k">if</span> <span class="n">mode</span> <span class="k">else</span> <span class="s2">&quot;prepare&quot;</span>  <span class="c1"># if no mode than first prepare</span>
</span><span id="NSSession.api_command-491"><a href="#NSSession.api_command-491"><span class="linenos">491</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/api.cgi&quot;</span>
</span><span id="NSSession.api_command-492"><a href="#NSSession.api_command-492"><span class="linenos">492</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession.api_command-493"><a href="#NSSession.api_command-493"><span class="linenos">493</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="NSSession.api_command-494"><a href="#NSSession.api_command-494"><span class="linenos">494</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">:</span>
</span><span id="NSSession.api_command-495"><a href="#NSSession.api_command-495"><span class="linenos">495</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;X-Pin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span>
</span><span id="NSSession.api_command-496"><a href="#NSSession.api_command-496"><span class="linenos">496</span></a>        <span class="c1"># rate limiting section</span>
</span><span id="NSSession.api_command-497"><a href="#NSSession.api_command-497"><span class="linenos">497</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.api_command-498"><a href="#NSSession.api_command-498"><span class="linenos">498</span></a>        <span class="c1"># if the server tells us to wait, wait</span>
</span><span id="NSSession.api_command-499"><a href="#NSSession.api_command-499"><span class="linenos">499</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_wait_for_ratelimit</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="p">)</span>
</span><span id="NSSession.api_command-500"><a href="#NSSession.api_command-500"><span class="linenos">500</span></a>        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="NSSession.api_command-501"><a href="#NSSession.api_command-501"><span class="linenos">501</span></a>        <span class="n">parsed_response</span> <span class="o">=</span> <span class="n">benedict</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="n">keyattr_dynamic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="NSSession.api_command-502"><a href="#NSSession.api_command-502"><span class="linenos">502</span></a>        <span class="n">parsed_response</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>
</span><span id="NSSession.api_command-503"><a href="#NSSession.api_command-503"><span class="linenos">503</span></a>        <span class="n">parsed_response</span><span class="p">:</span> <span class="n">benedict</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="s2">&quot;nation&quot;</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
</span><span id="NSSession.api_command-504"><a href="#NSSession.api_command-504"><span class="linenos">504</span></a>        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
</span><span id="NSSession.api_command-505"><a href="#NSSession.api_command-505"><span class="linenos">505</span></a>            <span class="c1"># if no mode was specified earlier, repeat command with execute and token</span>
</span><span id="NSSession.api_command-506"><a href="#NSSession.api_command-506"><span class="linenos">506</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;token&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parsed_response</span><span class="p">[</span><span class="s2">&quot;success&quot;</span><span class="p">]</span>
</span><span id="NSSession.api_command-507"><a href="#NSSession.api_command-507"><span class="linenos">507</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span><span class="n">nation</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;execute&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_command-508"><a href="#NSSession.api_command-508"><span class="linenos">508</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NSSession.api_command-509"><a href="#NSSession.api_command-509"><span class="linenos">509</span></a>            <span class="k">return</span> <span class="n">parsed_response</span>
</span></pre></div>


            <div class="docstring"><p>Sends a non-issue command to the nationstates api with the given data and password.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  The nation to perform the command with.</li>
<li><strong>command (str):</strong>  The command to perform. Must be "giftcard", "dispatch", "rmbpost"</li>
<li><strong>data (str, optional):</strong>  The unique data to send with the parameters of the command; consult the API docs for more information.</li>
<li><strong>password (str, optional):</strong>  The password to use for authenticating private api requests. Defaults to "". Not required if already signed in, whether through the api or through the HTML site.</li>
<li><strong>mode (str, optional):</strong>  Whether to prepare or to execute the command. If value is given, does one of the two and returns result, if no value is given, does both and returns result of execute.</li>
<li><strong>constant_rate_limit (bool, optional):</strong>  If True, will always rate limit. If False, will only rate limit when there's less than 10 requests left in the current bucket. Defaults to False.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.api_giftcard" class="classattr">
                                        <input id="NSSession.api_giftcard-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">api_giftcard</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nation</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">card_id</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">season</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">recipient</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">benedict</span><span class="o">.</span><span class="n">dicts</span><span class="o">.</span><span class="n">benedict</span>:</span></span>

                <label class="view-source-button" for="NSSession.api_giftcard-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.api_giftcard"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.api_giftcard-511"><a href="#NSSession.api_giftcard-511"><span class="linenos">511</span></a>    <span class="k">def</span> <span class="nf">api_giftcard</span><span class="p">(</span>
</span><span id="NSSession.api_giftcard-512"><a href="#NSSession.api_giftcard-512"><span class="linenos">512</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.api_giftcard-513"><a href="#NSSession.api_giftcard-513"><span class="linenos">513</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_giftcard-514"><a href="#NSSession.api_giftcard-514"><span class="linenos">514</span></a>        <span class="n">card_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="NSSession.api_giftcard-515"><a href="#NSSession.api_giftcard-515"><span class="linenos">515</span></a>        <span class="n">season</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="NSSession.api_giftcard-516"><a href="#NSSession.api_giftcard-516"><span class="linenos">516</span></a>        <span class="n">recipient</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_giftcard-517"><a href="#NSSession.api_giftcard-517"><span class="linenos">517</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_giftcard-518"><a href="#NSSession.api_giftcard-518"><span class="linenos">518</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession.api_giftcard-519"><a href="#NSSession.api_giftcard-519"><span class="linenos">519</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession.api_giftcard-520"><a href="#NSSession.api_giftcard-520"><span class="linenos">520</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Gifts a card using the API.</span>
</span><span id="NSSession.api_giftcard-521"><a href="#NSSession.api_giftcard-521"><span class="linenos">521</span></a>
</span><span id="NSSession.api_giftcard-522"><a href="#NSSession.api_giftcard-522"><span class="linenos">522</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.api_giftcard-523"><a href="#NSSession.api_giftcard-523"><span class="linenos">523</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession.api_giftcard-524"><a href="#NSSession.api_giftcard-524"><span class="linenos">524</span></a><span class="sd">            card_id (int): The ID of the card to gift.</span>
</span><span id="NSSession.api_giftcard-525"><a href="#NSSession.api_giftcard-525"><span class="linenos">525</span></a><span class="sd">            season (int): The season of the card to gift.</span>
</span><span id="NSSession.api_giftcard-526"><a href="#NSSession.api_giftcard-526"><span class="linenos">526</span></a><span class="sd">            recipient (str): The nation to gift the card to.</span>
</span><span id="NSSession.api_giftcard-527"><a href="#NSSession.api_giftcard-527"><span class="linenos">527</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession.api_giftcard-528"><a href="#NSSession.api_giftcard-528"><span class="linenos">528</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession.api_giftcard-529"><a href="#NSSession.api_giftcard-529"><span class="linenos">529</span></a>
</span><span id="NSSession.api_giftcard-530"><a href="#NSSession.api_giftcard-530"><span class="linenos">530</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.api_giftcard-531"><a href="#NSSession.api_giftcard-531"><span class="linenos">531</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession.api_giftcard-532"><a href="#NSSession.api_giftcard-532"><span class="linenos">532</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.api_giftcard-533"><a href="#NSSession.api_giftcard-533"><span class="linenos">533</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cardid&quot;</span><span class="p">:</span> <span class="n">card_id</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">:</span> <span class="n">season</span><span class="p">,</span> <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">recipient</span><span class="p">)}</span>
</span><span id="NSSession.api_giftcard-534"><a href="#NSSession.api_giftcard-534"><span class="linenos">534</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span>
</span><span id="NSSession.api_giftcard-535"><a href="#NSSession.api_giftcard-535"><span class="linenos">535</span></a>            <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;giftcard&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="o">=</span><span class="n">constant_rate_limit</span>
</span><span id="NSSession.api_giftcard-536"><a href="#NSSession.api_giftcard-536"><span class="linenos">536</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Gifts a card using the API.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  The nation to perform the command with.</li>
<li><strong>card_id (int):</strong>  The ID of the card to gift.</li>
<li><strong>season (int):</strong>  The season of the card to gift.</li>
<li><strong>recipient (str):</strong>  The nation to gift the card to.</li>
<li><strong>password (str, optional):</strong>  The password to use for authenticating private api requests. Defaults to "". Not required if already signed in, whether through the api or through the HTML site.</li>
<li><strong>constant_rate_limit (bool, optional):</strong>  If True, will always rate limit. If False, will only rate limit when there's less than 10 requests left in the current bucket. Defaults to False.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.api_dispatch" class="classattr">
                                        <input id="NSSession.api_dispatch-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">api_dispatch</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nation</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">action</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">category</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">subcategory</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">dispatchid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">benedict</span><span class="o">.</span><span class="n">dicts</span><span class="o">.</span><span class="n">benedict</span>:</span></span>

                <label class="view-source-button" for="NSSession.api_dispatch-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.api_dispatch"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.api_dispatch-538"><a href="#NSSession.api_dispatch-538"><span class="linenos">538</span></a>    <span class="k">def</span> <span class="nf">api_dispatch</span><span class="p">(</span>
</span><span id="NSSession.api_dispatch-539"><a href="#NSSession.api_dispatch-539"><span class="linenos">539</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-540"><a href="#NSSession.api_dispatch-540"><span class="linenos">540</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-541"><a href="#NSSession.api_dispatch-541"><span class="linenos">541</span></a>        <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-542"><a href="#NSSession.api_dispatch-542"><span class="linenos">542</span></a>        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-543"><a href="#NSSession.api_dispatch-543"><span class="linenos">543</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-544"><a href="#NSSession.api_dispatch-544"><span class="linenos">544</span></a>        <span class="n">category</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-545"><a href="#NSSession.api_dispatch-545"><span class="linenos">545</span></a>        <span class="n">subcategory</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-546"><a href="#NSSession.api_dispatch-546"><span class="linenos">546</span></a>        <span class="n">dispatchid</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-547"><a href="#NSSession.api_dispatch-547"><span class="linenos">547</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-548"><a href="#NSSession.api_dispatch-548"><span class="linenos">548</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession.api_dispatch-549"><a href="#NSSession.api_dispatch-549"><span class="linenos">549</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession.api_dispatch-550"><a href="#NSSession.api_dispatch-550"><span class="linenos">550</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Add, edit, or remove a dispatch.</span>
</span><span id="NSSession.api_dispatch-551"><a href="#NSSession.api_dispatch-551"><span class="linenos">551</span></a>
</span><span id="NSSession.api_dispatch-552"><a href="#NSSession.api_dispatch-552"><span class="linenos">552</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.api_dispatch-553"><a href="#NSSession.api_dispatch-553"><span class="linenos">553</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession.api_dispatch-554"><a href="#NSSession.api_dispatch-554"><span class="linenos">554</span></a><span class="sd">            action (str): The action to take. Must be &quot;add&quot;, &quot;edit&quot;, &quot;remove&quot;</span>
</span><span id="NSSession.api_dispatch-555"><a href="#NSSession.api_dispatch-555"><span class="linenos">555</span></a><span class="sd">            title (str, optional): The dispatch title when adding or editing.</span>
</span><span id="NSSession.api_dispatch-556"><a href="#NSSession.api_dispatch-556"><span class="linenos">556</span></a><span class="sd">            text (str, optional): The dispatch text when adding or editing.</span>
</span><span id="NSSession.api_dispatch-557"><a href="#NSSession.api_dispatch-557"><span class="linenos">557</span></a><span class="sd">            category: (int, optional), The category ID when adding or editing.</span>
</span><span id="NSSession.api_dispatch-558"><a href="#NSSession.api_dispatch-558"><span class="linenos">558</span></a><span class="sd">            subcategory (int, optional): The subcategory ID when adding or editing.</span>
</span><span id="NSSession.api_dispatch-559"><a href="#NSSession.api_dispatch-559"><span class="linenos">559</span></a><span class="sd">            dispatchid (int, optional): The dispatch ID when editing or removing.</span>
</span><span id="NSSession.api_dispatch-560"><a href="#NSSession.api_dispatch-560"><span class="linenos">560</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession.api_dispatch-561"><a href="#NSSession.api_dispatch-561"><span class="linenos">561</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession.api_dispatch-562"><a href="#NSSession.api_dispatch-562"><span class="linenos">562</span></a>
</span><span id="NSSession.api_dispatch-563"><a href="#NSSession.api_dispatch-563"><span class="linenos">563</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.api_dispatch-564"><a href="#NSSession.api_dispatch-564"><span class="linenos">564</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession.api_dispatch-565"><a href="#NSSession.api_dispatch-565"><span class="linenos">565</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.api_dispatch-566"><a href="#NSSession.api_dispatch-566"><span class="linenos">566</span></a>        <span class="c1"># TODO: maybe consider splitting these three functions?</span>
</span><span id="NSSession.api_dispatch-567"><a href="#NSSession.api_dispatch-567"><span class="linenos">567</span></a>        <span class="c1"># TODO: maybe create enums for category and subcategory</span>
</span><span id="NSSession.api_dispatch-568"><a href="#NSSession.api_dispatch-568"><span class="linenos">568</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="s2">&quot;remove&quot;</span><span class="p">}:</span>
</span><span id="NSSession.api_dispatch-569"><a href="#NSSession.api_dispatch-569"><span class="linenos">569</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;action must be &#39;add&#39;, &#39;edit&#39;, or &#39;remove&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_dispatch-570"><a href="#NSSession.api_dispatch-570"><span class="linenos">570</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="o">!=</span> <span class="s2">&quot;remove&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">({</span><span class="n">title</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">subcategory</span><span class="p">}):</span>
</span><span id="NSSession.api_dispatch-571"><a href="#NSSession.api_dispatch-571"><span class="linenos">571</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify title, text, category, and subcategory&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_dispatch-572"><a href="#NSSession.api_dispatch-572"><span class="linenos">572</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="o">!=</span> <span class="s2">&quot;add&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">dispatchid</span><span class="p">:</span>
</span><span id="NSSession.api_dispatch-573"><a href="#NSSession.api_dispatch-573"><span class="linenos">573</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;must specify a dispatch id&quot;</span><span class="p">)</span>
</span><span id="NSSession.api_dispatch-574"><a href="#NSSession.api_dispatch-574"><span class="linenos">574</span></a>
</span><span id="NSSession.api_dispatch-575"><a href="#NSSession.api_dispatch-575"><span class="linenos">575</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dispatch&quot;</span><span class="p">:</span> <span class="n">action</span><span class="p">}</span>
</span><span id="NSSession.api_dispatch-576"><a href="#NSSession.api_dispatch-576"><span class="linenos">576</span></a>        <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
</span><span id="NSSession.api_dispatch-577"><a href="#NSSession.api_dispatch-577"><span class="linenos">577</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
</span><span id="NSSession.api_dispatch-578"><a href="#NSSession.api_dispatch-578"><span class="linenos">578</span></a>        <span class="k">if</span> <span class="n">text</span><span class="p">:</span>
</span><span id="NSSession.api_dispatch-579"><a href="#NSSession.api_dispatch-579"><span class="linenos">579</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
</span><span id="NSSession.api_dispatch-580"><a href="#NSSession.api_dispatch-580"><span class="linenos">580</span></a>        <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
</span><span id="NSSession.api_dispatch-581"><a href="#NSSession.api_dispatch-581"><span class="linenos">581</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
</span><span id="NSSession.api_dispatch-582"><a href="#NSSession.api_dispatch-582"><span class="linenos">582</span></a>        <span class="k">if</span> <span class="n">subcategory</span><span class="p">:</span>
</span><span id="NSSession.api_dispatch-583"><a href="#NSSession.api_dispatch-583"><span class="linenos">583</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;subcategory&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">subcategory</span>
</span><span id="NSSession.api_dispatch-584"><a href="#NSSession.api_dispatch-584"><span class="linenos">584</span></a>        <span class="k">if</span> <span class="n">dispatchid</span><span class="p">:</span>
</span><span id="NSSession.api_dispatch-585"><a href="#NSSession.api_dispatch-585"><span class="linenos">585</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;dispatchid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dispatchid</span>
</span><span id="NSSession.api_dispatch-586"><a href="#NSSession.api_dispatch-586"><span class="linenos">586</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span>
</span><span id="NSSession.api_dispatch-587"><a href="#NSSession.api_dispatch-587"><span class="linenos">587</span></a>            <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;dispatch&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="o">=</span><span class="n">constant_rate_limit</span>
</span><span id="NSSession.api_dispatch-588"><a href="#NSSession.api_dispatch-588"><span class="linenos">588</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Add, edit, or remove a dispatch.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  The nation to perform the command with.</li>
<li><strong>action (str):</strong>  The action to take. Must be "add", "edit", "remove"</li>
<li><strong>title (str, optional):</strong>  The dispatch title when adding or editing.</li>
<li><strong>text (str, optional):</strong>  The dispatch text when adding or editing.</li>
<li><strong>category:</strong>  (int, optional), The category ID when adding or editing.</li>
<li><strong>subcategory (int, optional):</strong>  The subcategory ID when adding or editing.</li>
<li><strong>dispatchid (int, optional):</strong>  The dispatch ID when editing or removing.</li>
<li><strong>password (str, optional):</strong>  The password to use for authenticating private api requests. Defaults to "". Not required if already signed in, whether through the api or through the HTML site.</li>
<li><strong>constant_rate_limit (bool, optional):</strong>  If True, will always rate limit. If False, will only rate limit when there's less than 10 requests left in the current bucket. Defaults to False.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.api_rmb" class="classattr">
                                        <input id="NSSession.api_rmb-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">api_rmb</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">nation</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">region</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">text</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">benedict</span><span class="o">.</span><span class="n">dicts</span><span class="o">.</span><span class="n">benedict</span>:</span></span>

                <label class="view-source-button" for="NSSession.api_rmb-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.api_rmb"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.api_rmb-590"><a href="#NSSession.api_rmb-590"><span class="linenos">590</span></a>    <span class="k">def</span> <span class="nf">api_rmb</span><span class="p">(</span>
</span><span id="NSSession.api_rmb-591"><a href="#NSSession.api_rmb-591"><span class="linenos">591</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.api_rmb-592"><a href="#NSSession.api_rmb-592"><span class="linenos">592</span></a>        <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_rmb-593"><a href="#NSSession.api_rmb-593"><span class="linenos">593</span></a>        <span class="n">region</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_rmb-594"><a href="#NSSession.api_rmb-594"><span class="linenos">594</span></a>        <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.api_rmb-595"><a href="#NSSession.api_rmb-595"><span class="linenos">595</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.api_rmb-596"><a href="#NSSession.api_rmb-596"><span class="linenos">596</span></a>        <span class="n">constant_rate_limit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession.api_rmb-597"><a href="#NSSession.api_rmb-597"><span class="linenos">597</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">benedict</span><span class="p">:</span>
</span><span id="NSSession.api_rmb-598"><a href="#NSSession.api_rmb-598"><span class="linenos">598</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Post a message on the regional message board via the API.</span>
</span><span id="NSSession.api_rmb-599"><a href="#NSSession.api_rmb-599"><span class="linenos">599</span></a>
</span><span id="NSSession.api_rmb-600"><a href="#NSSession.api_rmb-600"><span class="linenos">600</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.api_rmb-601"><a href="#NSSession.api_rmb-601"><span class="linenos">601</span></a><span class="sd">            nation (str): The nation to perform the command with.</span>
</span><span id="NSSession.api_rmb-602"><a href="#NSSession.api_rmb-602"><span class="linenos">602</span></a><span class="sd">            region (str): the region to post the message in.</span>
</span><span id="NSSession.api_rmb-603"><a href="#NSSession.api_rmb-603"><span class="linenos">603</span></a><span class="sd">            text (str): the text to post.</span>
</span><span id="NSSession.api_rmb-604"><a href="#NSSession.api_rmb-604"><span class="linenos">604</span></a><span class="sd">            password (str, optional): The password to use for authenticating private api requests. Defaults to &quot;&quot;. Not required if already signed in, whether through the api or through the HTML site.</span>
</span><span id="NSSession.api_rmb-605"><a href="#NSSession.api_rmb-605"><span class="linenos">605</span></a><span class="sd">            constant_rate_limit (bool, optional): If True, will always rate limit. If False, will only rate limit when there&#39;s less than 10 requests left in the current bucket. Defaults to False.</span>
</span><span id="NSSession.api_rmb-606"><a href="#NSSession.api_rmb-606"><span class="linenos">606</span></a>
</span><span id="NSSession.api_rmb-607"><a href="#NSSession.api_rmb-607"><span class="linenos">607</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.api_rmb-608"><a href="#NSSession.api_rmb-608"><span class="linenos">608</span></a><span class="sd">            benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</span>
</span><span id="NSSession.api_rmb-609"><a href="#NSSession.api_rmb-609"><span class="linenos">609</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.api_rmb-610"><a href="#NSSession.api_rmb-610"><span class="linenos">610</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">text</span><span class="p">}</span>
</span><span id="NSSession.api_rmb-611"><a href="#NSSession.api_rmb-611"><span class="linenos">611</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">api_command</span><span class="p">(</span>
</span><span id="NSSession.api_rmb-612"><a href="#NSSession.api_rmb-612"><span class="linenos">612</span></a>            <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;rmbpost&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">password</span><span class="p">,</span> <span class="n">constant_rate_limit</span><span class="o">=</span><span class="n">constant_rate_limit</span>
</span><span id="NSSession.api_rmb-613"><a href="#NSSession.api_rmb-613"><span class="linenos">613</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Post a message on the regional message board via the API.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  The nation to perform the command with.</li>
<li><strong>region (str):</strong>  the region to post the message in.</li>
<li><strong>text (str):</strong>  the text to post.</li>
<li><strong>password (str, optional):</strong>  The password to use for authenticating private api requests. Defaults to "". Not required if already signed in, whether through the api or through the HTML site.</li>
<li><strong>constant_rate_limit (bool, optional):</strong>  If True, will always rate limit. If False, will only rate limit when there's less than 10 requests left in the current bucket. Defaults to False.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>benedict: A benedict object containing the response from the server. Acts like a dictionary, with keypath and keylist support.</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.login" class="classattr">
                                        <input id="NSSession.login-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">login</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nation</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">password</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.login-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.login"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.login-615"><a href="#NSSession.login-615"><span class="linenos">615</span></a>    <span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.login-616"><a href="#NSSession.login-616"><span class="linenos">616</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Logs in to the nationstates site.</span>
</span><span id="NSSession.login-617"><a href="#NSSession.login-617"><span class="linenos">617</span></a>
</span><span id="NSSession.login-618"><a href="#NSSession.login-618"><span class="linenos">618</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.login-619"><a href="#NSSession.login-619"><span class="linenos">619</span></a><span class="sd">            nation (str): Nation name</span>
</span><span id="NSSession.login-620"><a href="#NSSession.login-620"><span class="linenos">620</span></a><span class="sd">            password (str): Nation password</span>
</span><span id="NSSession.login-621"><a href="#NSSession.login-621"><span class="linenos">621</span></a>
</span><span id="NSSession.login-622"><a href="#NSSession.login-622"><span class="linenos">622</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.login-623"><a href="#NSSession.login-623"><span class="linenos">623</span></a><span class="sd">            bool: True if login was successful, False otherwise</span>
</span><span id="NSSession.login-624"><a href="#NSSession.login-624"><span class="linenos">624</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.login-625"><a href="#NSSession.login-625"><span class="linenos">625</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logging in to </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.login-626"><a href="#NSSession.login-626"><span class="linenos">626</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/page=display_region/region=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_auth_region</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.login-627"><a href="#NSSession.login-627"><span class="linenos">627</span></a>        <span class="c1"># shoutouts to roavin for telling me i had to have page=display_region in the url so it&#39;d work with a userclick parameter</span>
</span><span id="NSSession.login-628"><a href="#NSSession.login-628"><span class="linenos">628</span></a>
</span><span id="NSSession.login-629"><a href="#NSSession.login-629"><span class="linenos">629</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.login-630"><a href="#NSSession.login-630"><span class="linenos">630</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span>
</span><span id="NSSession.login-631"><a href="#NSSession.login-631"><span class="linenos">631</span></a>            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="NSSession.login-632"><a href="#NSSession.login-632"><span class="linenos">632</span></a>            <span class="s2">&quot;theme&quot;</span><span class="p">:</span> <span class="s2">&quot;century&quot;</span><span class="p">,</span>
</span><span id="NSSession.login-633"><a href="#NSSession.login-633"><span class="linenos">633</span></a>            <span class="s2">&quot;logging_in&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.login-634"><a href="#NSSession.login-634"><span class="linenos">634</span></a>            <span class="s2">&quot;submit&quot;</span><span class="p">:</span> <span class="s2">&quot;Login&quot;</span><span class="p">,</span>
</span><span id="NSSession.login-635"><a href="#NSSession.login-635"><span class="linenos">635</span></a>        <span class="p">}</span>
</span><span id="NSSession.login-636"><a href="#NSSession.login-636"><span class="linenos">636</span></a>
</span><span id="NSSession.login-637"><a href="#NSSession.login-637"><span class="linenos">637</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.login-638"><a href="#NSSession.login-638"><span class="linenos">638</span></a>
</span><span id="NSSession.login-639"><a href="#NSSession.login-639"><span class="linenos">639</span></a>        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
</span><span id="NSSession.login-640"><a href="#NSSession.login-640"><span class="linenos">640</span></a>        <span class="c1"># checks if the body tag has your nation name in it; if it does, you&#39;re logged in</span>
</span><span id="NSSession.login-641"><a href="#NSSession.login-641"><span class="linenos">641</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;data-nname&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)}):</span>
</span><span id="NSSession.login-642"><a href="#NSSession.login-642"><span class="linenos">642</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="NSSession.login-643"><a href="#NSSession.login-643"><span class="linenos">643</span></a>
</span><span id="NSSession.login-644"><a href="#NSSession.login-644"><span class="linenos">644</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nation</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span>
</span><span id="NSSession.login-645"><a href="#NSSession.login-645"><span class="linenos">645</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Logs in to the nationstates site.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  Nation name</li>
<li><strong>password (str):</strong>  Nation password</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if login was successful, False otherwise</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.change_nation_flag" class="classattr">
                                        <input id="NSSession.change_nation_flag-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_nation_flag</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">flag_filename</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.change_nation_flag-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.change_nation_flag"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.change_nation_flag-647"><a href="#NSSession.change_nation_flag-647"><span class="linenos">647</span></a>    <span class="k">def</span> <span class="nf">change_nation_flag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.change_nation_flag-648"><a href="#NSSession.change_nation_flag-648"><span class="linenos">648</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the nation flag to the given image.</span>
</span><span id="NSSession.change_nation_flag-649"><a href="#NSSession.change_nation_flag-649"><span class="linenos">649</span></a>
</span><span id="NSSession.change_nation_flag-650"><a href="#NSSession.change_nation_flag-650"><span class="linenos">650</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.change_nation_flag-651"><a href="#NSSession.change_nation_flag-651"><span class="linenos">651</span></a><span class="sd">            flag_filename (str): Filename of the flag to change to</span>
</span><span id="NSSession.change_nation_flag-652"><a href="#NSSession.change_nation_flag-652"><span class="linenos">652</span></a>
</span><span id="NSSession.change_nation_flag-653"><a href="#NSSession.change_nation_flag-653"><span class="linenos">653</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.change_nation_flag-654"><a href="#NSSession.change_nation_flag-654"><span class="linenos">654</span></a><span class="sd">            bool: True if the flag was changed, False otherwise</span>
</span><span id="NSSession.change_nation_flag-655"><a href="#NSSession.change_nation_flag-655"><span class="linenos">655</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.change_nation_flag-656"><a href="#NSSession.change_nation_flag-656"><span class="linenos">656</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changing flag on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.change_nation_flag-657"><a href="#NSSession.change_nation_flag-657"><span class="linenos">657</span></a>        <span class="c1"># THIS WAS SO FUCKING FRUSTRATING BUT IT WORKS NOW AND IM NEVER TOUCHING THIS BULLSHIT UNLESS NS BREAKS IT AGAIN</span>
</span><span id="NSSession.change_nation_flag-658"><a href="#NSSession.change_nation_flag-658"><span class="linenos">658</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/upload.cgi&quot;</span>
</span><span id="NSSession.change_nation_flag-659"><a href="#NSSession.change_nation_flag-659"><span class="linenos">659</span></a>
</span><span id="NSSession.change_nation_flag-660"><a href="#NSSession.change_nation_flag-660"><span class="linenos">660</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.change_nation_flag-661"><a href="#NSSession.change_nation_flag-661"><span class="linenos">661</span></a>            <span class="s2">&quot;nationname&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="p">,</span>
</span><span id="NSSession.change_nation_flag-662"><a href="#NSSession.change_nation_flag-662"><span class="linenos">662</span></a>        <span class="p">}</span>
</span><span id="NSSession.change_nation_flag-663"><a href="#NSSession.change_nation_flag-663"><span class="linenos">663</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.change_nation_flag-664"><a href="#NSSession.change_nation_flag-664"><span class="linenos">664</span></a>            <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="NSSession.change_nation_flag-665"><a href="#NSSession.change_nation_flag-665"><span class="linenos">665</span></a>                <span class="n">flag_filename</span><span class="p">,</span>
</span><span id="NSSession.change_nation_flag-666"><a href="#NSSession.change_nation_flag-666"><span class="linenos">666</span></a>                <span class="nb">open</span><span class="p">(</span><span class="n">flag_filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">),</span>
</span><span id="NSSession.change_nation_flag-667"><a href="#NSSession.change_nation_flag-667"><span class="linenos">667</span></a>                <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">flag_filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="NSSession.change_nation_flag-668"><a href="#NSSession.change_nation_flag-668"><span class="linenos">668</span></a>            <span class="p">)</span>
</span><span id="NSSession.change_nation_flag-669"><a href="#NSSession.change_nation_flag-669"><span class="linenos">669</span></a>        <span class="p">}</span>
</span><span id="NSSession.change_nation_flag-670"><a href="#NSSession.change_nation_flag-670"><span class="linenos">670</span></a>
</span><span id="NSSession.change_nation_flag-671"><a href="#NSSession.change_nation_flag-671"><span class="linenos">671</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="NSSession.change_nation_flag-672"><a href="#NSSession.change_nation_flag-672"><span class="linenos">672</span></a>
</span><span id="NSSession.change_nation_flag-673"><a href="#NSSession.change_nation_flag-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="s2">&quot;page=settings&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]:</span>
</span><span id="NSSession.change_nation_flag-674"><a href="#NSSession.change_nation_flag-674"><span class="linenos">674</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="NSSession.change_nation_flag-675"><a href="#NSSession.change_nation_flag-675"><span class="linenos">675</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="NSSession.change_nation_flag-676"><a href="#NSSession.change_nation_flag-676"><span class="linenos">676</span></a>        <span class="k">elif</span> <span class="s2">&quot;Just a moment...&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span><span id="NSSession.change_nation_flag-677"><a href="#NSSession.change_nation_flag-677"><span class="linenos">677</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
</span><span id="NSSession.change_nation_flag-678"><a href="#NSSession.change_nation_flag-678"><span class="linenos">678</span></a>                <span class="s2">&quot;Cloudflare blocked you idiot get fucked have fun with that like I had to lmaoooooooooo&quot;</span>
</span><span id="NSSession.change_nation_flag-679"><a href="#NSSession.change_nation_flag-679"><span class="linenos">679</span></a>            <span class="p">)</span>
</span><span id="NSSession.change_nation_flag-680"><a href="#NSSession.change_nation_flag-680"><span class="linenos">680</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Changes the nation flag to the given image.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>flag_filename (str):</strong>  Filename of the flag to change to</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the flag was changed, False otherwise</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.change_nation_settings" class="classattr">
                                        <input id="NSSession.change_nation_settings-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_nation_settings</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">email</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">pretitle</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">slogan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">currency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">animal</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">demonym_noun</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">demonym_adjective</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">demonym_plural</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">new_password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.change_nation_settings-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.change_nation_settings"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.change_nation_settings-682"><a href="#NSSession.change_nation_settings-682"><span class="linenos">682</span></a>    <span class="k">def</span> <span class="nf">change_nation_settings</span><span class="p">(</span>
</span><span id="NSSession.change_nation_settings-683"><a href="#NSSession.change_nation_settings-683"><span class="linenos">683</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-684"><a href="#NSSession.change_nation_settings-684"><span class="linenos">684</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-685"><a href="#NSSession.change_nation_settings-685"><span class="linenos">685</span></a>        <span class="n">email</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-686"><a href="#NSSession.change_nation_settings-686"><span class="linenos">686</span></a>        <span class="n">pretitle</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-687"><a href="#NSSession.change_nation_settings-687"><span class="linenos">687</span></a>        <span class="n">slogan</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-688"><a href="#NSSession.change_nation_settings-688"><span class="linenos">688</span></a>        <span class="n">currency</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-689"><a href="#NSSession.change_nation_settings-689"><span class="linenos">689</span></a>        <span class="n">animal</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-690"><a href="#NSSession.change_nation_settings-690"><span class="linenos">690</span></a>        <span class="n">demonym_noun</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-691"><a href="#NSSession.change_nation_settings-691"><span class="linenos">691</span></a>        <span class="n">demonym_adjective</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-692"><a href="#NSSession.change_nation_settings-692"><span class="linenos">692</span></a>        <span class="n">demonym_plural</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-693"><a href="#NSSession.change_nation_settings-693"><span class="linenos">693</span></a>        <span class="n">new_password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-694"><a href="#NSSession.change_nation_settings-694"><span class="linenos">694</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.change_nation_settings-695"><a href="#NSSession.change_nation_settings-695"><span class="linenos">695</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Given a logged in session, changes customizable fields and settings of the logged in nation.</span>
</span><span id="NSSession.change_nation_settings-696"><a href="#NSSession.change_nation_settings-696"><span class="linenos">696</span></a><span class="sd">        Variables must be explicitly named in the call to the function, e.g. &quot;session.change_nation_settings(pretitle=&#39;Join Lily&#39;, currency=&#39;Join Lily&#39;)&quot;</span>
</span><span id="NSSession.change_nation_settings-697"><a href="#NSSession.change_nation_settings-697"><span class="linenos">697</span></a>
</span><span id="NSSession.change_nation_settings-698"><a href="#NSSession.change_nation_settings-698"><span class="linenos">698</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.change_nation_settings-699"><a href="#NSSession.change_nation_settings-699"><span class="linenos">699</span></a><span class="sd">            email (str, optional): New email for WA apps.</span>
</span><span id="NSSession.change_nation_settings-700"><a href="#NSSession.change_nation_settings-700"><span class="linenos">700</span></a><span class="sd">            pretitle (str, optional): New pretitle of the nation. Max length of 28. Nation must have minimum population of 250 million.</span>
</span><span id="NSSession.change_nation_settings-701"><a href="#NSSession.change_nation_settings-701"><span class="linenos">701</span></a><span class="sd">            slogan (str, optional): New Slogan/Motto of the nation. Max length of 55.</span>
</span><span id="NSSession.change_nation_settings-702"><a href="#NSSession.change_nation_settings-702"><span class="linenos">702</span></a><span class="sd">            currency (str, optional): New currency of the nation. Max length of 40.</span>
</span><span id="NSSession.change_nation_settings-703"><a href="#NSSession.change_nation_settings-703"><span class="linenos">703</span></a><span class="sd">            animal (str, optional): New national animal of the nation. Max length of 40.</span>
</span><span id="NSSession.change_nation_settings-704"><a href="#NSSession.change_nation_settings-704"><span class="linenos">704</span></a><span class="sd">            demonym_noun (str, optional): Noun the nation will refer to its citizens as. Max length of 44.</span>
</span><span id="NSSession.change_nation_settings-705"><a href="#NSSession.change_nation_settings-705"><span class="linenos">705</span></a><span class="sd">            demonym_adjective (str, optional): Adjective the nation will refer to its citizens as. Max length of 44.</span>
</span><span id="NSSession.change_nation_settings-706"><a href="#NSSession.change_nation_settings-706"><span class="linenos">706</span></a><span class="sd">            demonym_plural (str, optional): Plural form of &quot;demonym_noun&quot;. Max length of 44.</span>
</span><span id="NSSession.change_nation_settings-707"><a href="#NSSession.change_nation_settings-707"><span class="linenos">707</span></a><span class="sd">            new_password (str, optional): New password to assign to the nation.</span>
</span><span id="NSSession.change_nation_settings-708"><a href="#NSSession.change_nation_settings-708"><span class="linenos">708</span></a>
</span><span id="NSSession.change_nation_settings-709"><a href="#NSSession.change_nation_settings-709"><span class="linenos">709</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.change_nation_settings-710"><a href="#NSSession.change_nation_settings-710"><span class="linenos">710</span></a><span class="sd">            bool: True if changes were successful, False otherwise.</span>
</span><span id="NSSession.change_nation_settings-711"><a href="#NSSession.change_nation_settings-711"><span class="linenos">711</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.change_nation_settings-712"><a href="#NSSession.change_nation_settings-712"><span class="linenos">712</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changing settings on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.change_nation_settings-713"><a href="#NSSession.change_nation_settings-713"><span class="linenos">713</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=settings&quot;</span>
</span><span id="NSSession.change_nation_settings-714"><a href="#NSSession.change_nation_settings-714"><span class="linenos">714</span></a>
</span><span id="NSSession.change_nation_settings-715"><a href="#NSSession.change_nation_settings-715"><span class="linenos">715</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.change_nation_settings-716"><a href="#NSSession.change_nation_settings-716"><span class="linenos">716</span></a>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="n">pretitle</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-717"><a href="#NSSession.change_nation_settings-717"><span class="linenos">717</span></a>            <span class="s2">&quot;slogan&quot;</span><span class="p">:</span> <span class="n">slogan</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-718"><a href="#NSSession.change_nation_settings-718"><span class="linenos">718</span></a>            <span class="s2">&quot;currency&quot;</span><span class="p">:</span> <span class="n">currency</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-719"><a href="#NSSession.change_nation_settings-719"><span class="linenos">719</span></a>            <span class="s2">&quot;animal&quot;</span><span class="p">:</span> <span class="n">animal</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-720"><a href="#NSSession.change_nation_settings-720"><span class="linenos">720</span></a>            <span class="s2">&quot;demonym2&quot;</span><span class="p">:</span> <span class="n">demonym_noun</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-721"><a href="#NSSession.change_nation_settings-721"><span class="linenos">721</span></a>            <span class="s2">&quot;demonym&quot;</span><span class="p">:</span> <span class="n">demonym_adjective</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-722"><a href="#NSSession.change_nation_settings-722"><span class="linenos">722</span></a>            <span class="s2">&quot;demonym2pl&quot;</span><span class="p">:</span> <span class="n">demonym_plural</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-723"><a href="#NSSession.change_nation_settings-723"><span class="linenos">723</span></a>            <span class="s2">&quot;email&quot;</span><span class="p">:</span> <span class="n">email</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-724"><a href="#NSSession.change_nation_settings-724"><span class="linenos">724</span></a>            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">new_password</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-725"><a href="#NSSession.change_nation_settings-725"><span class="linenos">725</span></a>            <span class="s2">&quot;confirm_password&quot;</span><span class="p">:</span> <span class="n">new_password</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-726"><a href="#NSSession.change_nation_settings-726"><span class="linenos">726</span></a>            <span class="s2">&quot;update&quot;</span><span class="p">:</span> <span class="s2">&quot; Update &quot;</span><span class="p">,</span>
</span><span id="NSSession.change_nation_settings-727"><a href="#NSSession.change_nation_settings-727"><span class="linenos">727</span></a>        <span class="p">}</span>
</span><span id="NSSession.change_nation_settings-728"><a href="#NSSession.change_nation_settings-728"><span class="linenos">728</span></a>        <span class="c1"># remove keys that have empty values</span>
</span><span id="NSSession.change_nation_settings-729"><a href="#NSSession.change_nation_settings-729"><span class="linenos">729</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">}</span>
</span><span id="NSSession.change_nation_settings-730"><a href="#NSSession.change_nation_settings-730"><span class="linenos">730</span></a>        <span class="c1"># make sure everything is following the proper length limits and only contains acceptable characters</span>
</span><span id="NSSession.change_nation_settings-731"><a href="#NSSession.change_nation_settings-731"><span class="linenos">731</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_fields</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.change_nation_settings-732"><a href="#NSSession.change_nation_settings-732"><span class="linenos">732</span></a>
</span><span id="NSSession.change_nation_settings-733"><a href="#NSSession.change_nation_settings-733"><span class="linenos">733</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.change_nation_settings-734"><a href="#NSSession.change_nation_settings-734"><span class="linenos">734</span></a>        <span class="k">return</span> <span class="s2">&quot;Your settings have been successfully updated.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Given a logged in session, changes customizable fields and settings of the logged in nation.
Variables must be explicitly named in the call to the function, e.g. "session.change_nation_settings(pretitle='Join Lily', currency='Join Lily')"</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>email (str, optional):</strong>  New email for WA apps.</li>
<li><strong>pretitle (str, optional):</strong>  New pretitle of the nation. Max length of 28. Nation must have minimum population of 250 million.</li>
<li><strong>slogan (str, optional):</strong>  New Slogan/Motto of the nation. Max length of 55.</li>
<li><strong>currency (str, optional):</strong>  New currency of the nation. Max length of 40.</li>
<li><strong>animal (str, optional):</strong>  New national animal of the nation. Max length of 40.</li>
<li><strong>demonym_noun (str, optional):</strong>  Noun the nation will refer to its citizens as. Max length of 44.</li>
<li><strong>demonym_adjective (str, optional):</strong>  Adjective the nation will refer to its citizens as. Max length of 44.</li>
<li><strong>demonym_plural (str, optional):</strong>  Plural form of "demonym_noun". Max length of 44.</li>
<li><strong>new_password (str, optional):</strong>  New password to assign to the nation.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if changes were successful, False otherwise.</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.move_to_region" class="classattr">
                                        <input id="NSSession.move_to_region-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">move_to_region</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">region</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.move_to_region-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.move_to_region"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.move_to_region-736"><a href="#NSSession.move_to_region-736"><span class="linenos">736</span></a>    <span class="k">def</span> <span class="nf">move_to_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">region</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.move_to_region-737"><a href="#NSSession.move_to_region-737"><span class="linenos">737</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Moves the nation to the given region.</span>
</span><span id="NSSession.move_to_region-738"><a href="#NSSession.move_to_region-738"><span class="linenos">738</span></a>
</span><span id="NSSession.move_to_region-739"><a href="#NSSession.move_to_region-739"><span class="linenos">739</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.move_to_region-740"><a href="#NSSession.move_to_region-740"><span class="linenos">740</span></a><span class="sd">            region (str): Region to move to</span>
</span><span id="NSSession.move_to_region-741"><a href="#NSSession.move_to_region-741"><span class="linenos">741</span></a><span class="sd">            password (str, optional): Region password, if the region is passworded</span>
</span><span id="NSSession.move_to_region-742"><a href="#NSSession.move_to_region-742"><span class="linenos">742</span></a>
</span><span id="NSSession.move_to_region-743"><a href="#NSSession.move_to_region-743"><span class="linenos">743</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.move_to_region-744"><a href="#NSSession.move_to_region-744"><span class="linenos">744</span></a><span class="sd">            bool: True if the move was successful, False otherwise</span>
</span><span id="NSSession.move_to_region-745"><a href="#NSSession.move_to_region-745"><span class="linenos">745</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.move_to_region-746"><a href="#NSSession.move_to_region-746"><span class="linenos">746</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Moving </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.move_to_region-747"><a href="#NSSession.move_to_region-747"><span class="linenos">747</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=change_region&quot;</span>
</span><span id="NSSession.move_to_region-748"><a href="#NSSession.move_to_region-748"><span class="linenos">748</span></a>
</span><span id="NSSession.move_to_region-749"><a href="#NSSession.move_to_region-749"><span class="linenos">749</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;region_name&quot;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span> <span class="s2">&quot;move_region&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.move_to_region-750"><a href="#NSSession.move_to_region-750"><span class="linenos">750</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession.move_to_region-751"><a href="#NSSession.move_to_region-751"><span class="linenos">751</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">password</span>
</span><span id="NSSession.move_to_region-752"><a href="#NSSession.move_to_region-752"><span class="linenos">752</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.move_to_region-753"><a href="#NSSession.move_to_region-753"><span class="linenos">753</span></a>
</span><span id="NSSession.move_to_region-754"><a href="#NSSession.move_to_region-754"><span class="linenos">754</span></a>        <span class="k">if</span> <span class="s2">&quot;Success!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
</span><span id="NSSession.move_to_region-755"><a href="#NSSession.move_to_region-755"><span class="linenos">755</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">region</span><span class="p">)</span>
</span><span id="NSSession.move_to_region-756"><a href="#NSSession.move_to_region-756"><span class="linenos">756</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="NSSession.move_to_region-757"><a href="#NSSession.move_to_region-757"><span class="linenos">757</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Moves the nation to the given region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>region (str):</strong>  Region to move to</li>
<li><strong>password (str, optional):</strong>  Region password, if the region is passworded</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the move was successful, False otherwise</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.vote" class="classattr">
                                        <input id="NSSession.vote-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">vote</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">pollid</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">option</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.vote-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.vote"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.vote-759"><a href="#NSSession.vote-759"><span class="linenos">759</span></a>    <span class="k">def</span> <span class="nf">vote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pollid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">option</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.vote-760"><a href="#NSSession.vote-760"><span class="linenos">760</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Votes on a poll.</span>
</span><span id="NSSession.vote-761"><a href="#NSSession.vote-761"><span class="linenos">761</span></a>
</span><span id="NSSession.vote-762"><a href="#NSSession.vote-762"><span class="linenos">762</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.vote-763"><a href="#NSSession.vote-763"><span class="linenos">763</span></a><span class="sd">            pollid (str): ID of the poll to vote on, e.g. &quot;199747&quot;</span>
</span><span id="NSSession.vote-764"><a href="#NSSession.vote-764"><span class="linenos">764</span></a><span class="sd">            option (str): Option to vote for (starts at 0)</span>
</span><span id="NSSession.vote-765"><a href="#NSSession.vote-765"><span class="linenos">765</span></a>
</span><span id="NSSession.vote-766"><a href="#NSSession.vote-766"><span class="linenos">766</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.vote-767"><a href="#NSSession.vote-767"><span class="linenos">767</span></a><span class="sd">            bool: True if the vote was successful, False otherwise</span>
</span><span id="NSSession.vote-768"><a href="#NSSession.vote-768"><span class="linenos">768</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.vote-769"><a href="#NSSession.vote-769"><span class="linenos">769</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Voting on poll </span><span class="si">{</span><span class="n">pollid</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.vote-770"><a href="#NSSession.vote-770"><span class="linenos">770</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=poll/p=</span><span class="si">{</span><span class="n">pollid</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.vote-771"><a href="#NSSession.vote-771"><span class="linenos">771</span></a>
</span><span id="NSSession.vote-772"><a href="#NSSession.vote-772"><span class="linenos">772</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;pollid&quot;</span><span class="p">:</span> <span class="n">pollid</span><span class="p">,</span> <span class="s2">&quot;q1&quot;</span><span class="p">:</span> <span class="n">option</span><span class="p">,</span> <span class="s2">&quot;poll_submit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.vote-773"><a href="#NSSession.vote-773"><span class="linenos">773</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.vote-774"><a href="#NSSession.vote-774"><span class="linenos">774</span></a>
</span><span id="NSSession.vote-775"><a href="#NSSession.vote-775"><span class="linenos">775</span></a>        <span class="k">return</span> <span class="s2">&quot;Your vote has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Votes on a poll.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>pollid (str):</strong>  ID of the poll to vote on, e.g. "199747"</li>
<li><strong>option (str):</strong>  Option to vote for (starts at 0)</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the vote was successful, False otherwise</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.join_wa" class="classattr">
                                        <input id="NSSession.join_wa-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">join_wa</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nation</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.join_wa-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.join_wa"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.join_wa-779"><a href="#NSSession.join_wa-779"><span class="linenos">779</span></a>    <span class="k">def</span> <span class="nf">join_wa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">app_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.join_wa-780"><a href="#NSSession.join_wa-780"><span class="linenos">780</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Joins the WA with the given nation.</span>
</span><span id="NSSession.join_wa-781"><a href="#NSSession.join_wa-781"><span class="linenos">781</span></a>
</span><span id="NSSession.join_wa-782"><a href="#NSSession.join_wa-782"><span class="linenos">782</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.join_wa-783"><a href="#NSSession.join_wa-783"><span class="linenos">783</span></a><span class="sd">            nation (str): Nation to join the WA with</span>
</span><span id="NSSession.join_wa-784"><a href="#NSSession.join_wa-784"><span class="linenos">784</span></a><span class="sd">            app_id (str): ID of the WA application to use</span>
</span><span id="NSSession.join_wa-785"><a href="#NSSession.join_wa-785"><span class="linenos">785</span></a>
</span><span id="NSSession.join_wa-786"><a href="#NSSession.join_wa-786"><span class="linenos">786</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.join_wa-787"><a href="#NSSession.join_wa-787"><span class="linenos">787</span></a><span class="sd">            bool: True if the join was successful, False otherwise</span>
</span><span id="NSSession.join_wa-788"><a href="#NSSession.join_wa-788"><span class="linenos">788</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.join_wa-789"><a href="#NSSession.join_wa-789"><span class="linenos">789</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joining WA with </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.join_wa-790"><a href="#NSSession.join_wa-790"><span class="linenos">790</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/join_un.cgi&quot;</span>
</span><span id="NSSession.join_wa-791"><a href="#NSSession.join_wa-791"><span class="linenos">791</span></a>
</span><span id="NSSession.join_wa-792"><a href="#NSSession.join_wa-792"><span class="linenos">792</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span> <span class="s2">&quot;appid&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="o">.</span><span class="n">strip</span><span class="p">()}</span>
</span><span id="NSSession.join_wa-793"><a href="#NSSession.join_wa-793"><span class="linenos">793</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.join_wa-794"><a href="#NSSession.join_wa-794"><span class="linenos">794</span></a>
</span><span id="NSSession.join_wa-795"><a href="#NSSession.join_wa-795"><span class="linenos">795</span></a>        <span class="k">if</span> <span class="s2">&quot;?welcome=1&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]:</span>
</span><span id="NSSession.join_wa-796"><a href="#NSSession.join_wa-796"><span class="linenos">796</span></a>            <span class="c1"># since we&#39;re just getting thrown into a cgi script, we&#39;ll have to manually grab authentication values</span>
</span><span id="NSSession.join_wa-797"><a href="#NSSession.join_wa-797"><span class="linenos">797</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="NSSession.join_wa-798"><a href="#NSSession.join_wa-798"><span class="linenos">798</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="NSSession.join_wa-799"><a href="#NSSession.join_wa-799"><span class="linenos">799</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Joins the WA with the given nation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  Nation to join the WA with</li>
<li><strong>app_id (str):</strong>  ID of the WA application to use</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the join was successful, False otherwise</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.resign_wa" class="classattr">
                                        <input id="NSSession.resign_wa-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">resign_wa</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NSSession.resign_wa-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.resign_wa"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.resign_wa-801"><a href="#NSSession.resign_wa-801"><span class="linenos">801</span></a>    <span class="k">def</span> <span class="nf">resign_wa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="NSSession.resign_wa-802"><a href="#NSSession.resign_wa-802"><span class="linenos">802</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Resigns from the WA.</span>
</span><span id="NSSession.resign_wa-803"><a href="#NSSession.resign_wa-803"><span class="linenos">803</span></a>
</span><span id="NSSession.resign_wa-804"><a href="#NSSession.resign_wa-804"><span class="linenos">804</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.resign_wa-805"><a href="#NSSession.resign_wa-805"><span class="linenos">805</span></a><span class="sd">            bool: True if the resignation was successful, False otherwise</span>
</span><span id="NSSession.resign_wa-806"><a href="#NSSession.resign_wa-806"><span class="linenos">806</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.resign_wa-807"><a href="#NSSession.resign_wa-807"><span class="linenos">807</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Resigning from WA&quot;</span><span class="p">)</span>
</span><span id="NSSession.resign_wa-808"><a href="#NSSession.resign_wa-808"><span class="linenos">808</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=UN_status&quot;</span>
</span><span id="NSSession.resign_wa-809"><a href="#NSSession.resign_wa-809"><span class="linenos">809</span></a>
</span><span id="NSSession.resign_wa-810"><a href="#NSSession.resign_wa-810"><span class="linenos">810</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;leave_UN&quot;</span><span class="p">,</span> <span class="s2">&quot;submit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.resign_wa-811"><a href="#NSSession.resign_wa-811"><span class="linenos">811</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.resign_wa-812"><a href="#NSSession.resign_wa-812"><span class="linenos">812</span></a>
</span><span id="NSSession.resign_wa-813"><a href="#NSSession.resign_wa-813"><span class="linenos">813</span></a>        <span class="k">return</span> <span class="s2">&quot;From this moment forward, your nation is on its own.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Resigns from the WA.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the resignation was successful, False otherwise</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.apply_wa" class="classattr">
                                        <input id="NSSession.apply_wa-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_wa</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">reapply</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.apply_wa-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.apply_wa"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.apply_wa-815"><a href="#NSSession.apply_wa-815"><span class="linenos">815</span></a>    <span class="k">def</span> <span class="nf">apply_wa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reapply</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.apply_wa-816"><a href="#NSSession.apply_wa-816"><span class="linenos">816</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Applies to the WA.</span>
</span><span id="NSSession.apply_wa-817"><a href="#NSSession.apply_wa-817"><span class="linenos">817</span></a>
</span><span id="NSSession.apply_wa-818"><a href="#NSSession.apply_wa-818"><span class="linenos">818</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.apply_wa-819"><a href="#NSSession.apply_wa-819"><span class="linenos">819</span></a><span class="sd">            reapply (bool, optional): Whether to reapply if you&#39;ve been sent an application that&#39;s still valid. Defaults to True.</span>
</span><span id="NSSession.apply_wa-820"><a href="#NSSession.apply_wa-820"><span class="linenos">820</span></a>
</span><span id="NSSession.apply_wa-821"><a href="#NSSession.apply_wa-821"><span class="linenos">821</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.apply_wa-822"><a href="#NSSession.apply_wa-822"><span class="linenos">822</span></a><span class="sd">            bool: True if the application was successful, False otherwise</span>
</span><span id="NSSession.apply_wa-823"><a href="#NSSession.apply_wa-823"><span class="linenos">823</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.apply_wa-824"><a href="#NSSession.apply_wa-824"><span class="linenos">824</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying to WA with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.apply_wa-825"><a href="#NSSession.apply_wa-825"><span class="linenos">825</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=UN_status&quot;</span>
</span><span id="NSSession.apply_wa-826"><a href="#NSSession.apply_wa-826"><span class="linenos">826</span></a>
</span><span id="NSSession.apply_wa-827"><a href="#NSSession.apply_wa-827"><span class="linenos">827</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;join_UN&quot;</span><span class="p">}</span>
</span><span id="NSSession.apply_wa-828"><a href="#NSSession.apply_wa-828"><span class="linenos">828</span></a>        <span class="k">if</span> <span class="n">reapply</span><span class="p">:</span>
</span><span id="NSSession.apply_wa-829"><a href="#NSSession.apply_wa-829"><span class="linenos">829</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;resend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</span><span id="NSSession.apply_wa-830"><a href="#NSSession.apply_wa-830"><span class="linenos">830</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="NSSession.apply_wa-831"><a href="#NSSession.apply_wa-831"><span class="linenos">831</span></a>            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;submit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
</span><span id="NSSession.apply_wa-832"><a href="#NSSession.apply_wa-832"><span class="linenos">832</span></a>
</span><span id="NSSession.apply_wa-833"><a href="#NSSession.apply_wa-833"><span class="linenos">833</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.apply_wa-834"><a href="#NSSession.apply_wa-834"><span class="linenos">834</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="NSSession.apply_wa-835"><a href="#NSSession.apply_wa-835"><span class="linenos">835</span></a>            <span class="s2">&quot;Your application to join the World Assembly has been received!&quot;</span>
</span><span id="NSSession.apply_wa-836"><a href="#NSSession.apply_wa-836"><span class="linenos">836</span></a>            <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession.apply_wa-837"><a href="#NSSession.apply_wa-837"><span class="linenos">837</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Applies to the WA.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>reapply (bool, optional):</strong>  Whether to reapply if you've been sent an application that's still valid. Defaults to True.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the application was successful, False otherwise</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.endorse" class="classattr">
                                        <input id="NSSession.endorse-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">endorse</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nation</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">endorse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.endorse-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.endorse"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.endorse-839"><a href="#NSSession.endorse-839"><span class="linenos">839</span></a>    <span class="k">def</span> <span class="nf">endorse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endorse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.endorse-840"><a href="#NSSession.endorse-840"><span class="linenos">840</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Endorses the given nation.</span>
</span><span id="NSSession.endorse-841"><a href="#NSSession.endorse-841"><span class="linenos">841</span></a>
</span><span id="NSSession.endorse-842"><a href="#NSSession.endorse-842"><span class="linenos">842</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.endorse-843"><a href="#NSSession.endorse-843"><span class="linenos">843</span></a><span class="sd">            nation (str): Nation to endorse</span>
</span><span id="NSSession.endorse-844"><a href="#NSSession.endorse-844"><span class="linenos">844</span></a><span class="sd">            endorse (bool, optional): True=endorse, False=unendorse. Defaults to True.</span>
</span><span id="NSSession.endorse-845"><a href="#NSSession.endorse-845"><span class="linenos">845</span></a>
</span><span id="NSSession.endorse-846"><a href="#NSSession.endorse-846"><span class="linenos">846</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.endorse-847"><a href="#NSSession.endorse-847"><span class="linenos">847</span></a><span class="sd">            bool: True if the endorsement was successful, False otherwise</span>
</span><span id="NSSession.endorse-848"><a href="#NSSession.endorse-848"><span class="linenos">848</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.endorse-849"><a href="#NSSession.endorse-849"><span class="linenos">849</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="NSSession.endorse-850"><a href="#NSSession.endorse-850"><span class="linenos">850</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="s1">&#39;Unendorsing&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Endorsing&#39;</span><span class="p">)[</span><span class="n">endorse</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.endorse-851"><a href="#NSSession.endorse-851"><span class="linenos">851</span></a>        <span class="p">)</span>
</span><span id="NSSession.endorse-852"><a href="#NSSession.endorse-852"><span class="linenos">852</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/endorse.cgi&quot;</span>
</span><span id="NSSession.endorse-853"><a href="#NSSession.endorse-853"><span class="linenos">853</span></a>
</span><span id="NSSession.endorse-854"><a href="#NSSession.endorse-854"><span class="linenos">854</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.endorse-855"><a href="#NSSession.endorse-855"><span class="linenos">855</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">),</span>
</span><span id="NSSession.endorse-856"><a href="#NSSession.endorse-856"><span class="linenos">856</span></a>            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;endorse&quot;</span> <span class="k">if</span> <span class="n">endorse</span> <span class="k">else</span> <span class="s2">&quot;unendorse&quot;</span><span class="p">,</span>
</span><span id="NSSession.endorse-857"><a href="#NSSession.endorse-857"><span class="linenos">857</span></a>        <span class="p">}</span>
</span><span id="NSSession.endorse-858"><a href="#NSSession.endorse-858"><span class="linenos">858</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.endorse-859"><a href="#NSSession.endorse-859"><span class="linenos">859</span></a>
</span><span id="NSSession.endorse-860"><a href="#NSSession.endorse-860"><span class="linenos">860</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;nation=</span><span class="si">{</span><span class="n">canonicalize</span><span class="p">(</span><span class="n">nation</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Endorses the given nation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  Nation to endorse</li>
<li><strong>endorse (bool, optional):</strong>  True=endorse, False=unendorse. Defaults to True.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if the endorsement was successful, False otherwise</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.clear_dossier" class="classattr">
                                        <input id="NSSession.clear_dossier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">clear_dossier</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.clear_dossier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.clear_dossier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.clear_dossier-862"><a href="#NSSession.clear_dossier-862"><span class="linenos">862</span></a>    <span class="k">def</span> <span class="nf">clear_dossier</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.clear_dossier-863"><a href="#NSSession.clear_dossier-863"><span class="linenos">863</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Clears a logged in nation&#39;s dossier.</span>
</span><span id="NSSession.clear_dossier-864"><a href="#NSSession.clear_dossier-864"><span class="linenos">864</span></a>
</span><span id="NSSession.clear_dossier-865"><a href="#NSSession.clear_dossier-865"><span class="linenos">865</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.clear_dossier-866"><a href="#NSSession.clear_dossier-866"><span class="linenos">866</span></a><span class="sd">            bool: Whether it was successful or not</span>
</span><span id="NSSession.clear_dossier-867"><a href="#NSSession.clear_dossier-867"><span class="linenos">867</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.clear_dossier-868"><a href="#NSSession.clear_dossier-868"><span class="linenos">868</span></a>
</span><span id="NSSession.clear_dossier-869"><a href="#NSSession.clear_dossier-869"><span class="linenos">869</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Clearing dossier on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.clear_dossier-870"><a href="#NSSession.clear_dossier-870"><span class="linenos">870</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=dossier&quot;</span>
</span><span id="NSSession.clear_dossier-871"><a href="#NSSession.clear_dossier-871"><span class="linenos">871</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;clear_dossier&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.clear_dossier-872"><a href="#NSSession.clear_dossier-872"><span class="linenos">872</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.clear_dossier-873"><a href="#NSSession.clear_dossier-873"><span class="linenos">873</span></a>
</span><span id="NSSession.clear_dossier-874"><a href="#NSSession.clear_dossier-874"><span class="linenos">874</span></a>        <span class="k">return</span> <span class="s2">&quot;Dossier cleared of nations.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Clears a logged in nation's dossier.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether it was successful or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.add_to_dossier" class="classattr">
                                        <input id="NSSession.add_to_dossier-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_to_dossier</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.add_to_dossier-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.add_to_dossier"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.add_to_dossier-876"><a href="#NSSession.add_to_dossier-876"><span class="linenos">876</span></a>    <span class="k">def</span> <span class="nf">add_to_dossier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nations</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.add_to_dossier-877"><a href="#NSSession.add_to_dossier-877"><span class="linenos">877</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds nations to the logged in nation&#39;s dossier.</span>
</span><span id="NSSession.add_to_dossier-878"><a href="#NSSession.add_to_dossier-878"><span class="linenos">878</span></a>
</span><span id="NSSession.add_to_dossier-879"><a href="#NSSession.add_to_dossier-879"><span class="linenos">879</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.add_to_dossier-880"><a href="#NSSession.add_to_dossier-880"><span class="linenos">880</span></a><span class="sd">            nations (list[str] | str): List of nations to add, or a single nation</span>
</span><span id="NSSession.add_to_dossier-881"><a href="#NSSession.add_to_dossier-881"><span class="linenos">881</span></a>
</span><span id="NSSession.add_to_dossier-882"><a href="#NSSession.add_to_dossier-882"><span class="linenos">882</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.add_to_dossier-883"><a href="#NSSession.add_to_dossier-883"><span class="linenos">883</span></a><span class="sd">            bool: Whether it was successful or not</span>
</span><span id="NSSession.add_to_dossier-884"><a href="#NSSession.add_to_dossier-884"><span class="linenos">884</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.add_to_dossier-885"><a href="#NSSession.add_to_dossier-885"><span class="linenos">885</span></a>
</span><span id="NSSession.add_to_dossier-886"><a href="#NSSession.add_to_dossier-886"><span class="linenos">886</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">nations</span><span class="si">}</span><span class="s2"> to dossier on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.add_to_dossier-887"><a href="#NSSession.add_to_dossier-887"><span class="linenos">887</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/dossier.cgi&quot;</span>
</span><span id="NSSession.add_to_dossier-888"><a href="#NSSession.add_to_dossier-888"><span class="linenos">888</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.add_to_dossier-889"><a href="#NSSession.add_to_dossier-889"><span class="linenos">889</span></a>            <span class="s2">&quot;currentnation&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="p">),</span>
</span><span id="NSSession.add_to_dossier-890"><a href="#NSSession.add_to_dossier-890"><span class="linenos">890</span></a>            <span class="s2">&quot;action_append&quot;</span><span class="p">:</span> <span class="s2">&quot;Upload Nation Dossier File&quot;</span><span class="p">,</span>
</span><span id="NSSession.add_to_dossier-891"><a href="#NSSession.add_to_dossier-891"><span class="linenos">891</span></a>        <span class="p">}</span>
</span><span id="NSSession.add_to_dossier-892"><a href="#NSSession.add_to_dossier-892"><span class="linenos">892</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.add_to_dossier-893"><a href="#NSSession.add_to_dossier-893"><span class="linenos">893</span></a>            <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="NSSession.add_to_dossier-894"><a href="#NSSession.add_to_dossier-894"><span class="linenos">894</span></a>                <span class="s2">&quot;dossier.txt&quot;</span><span class="p">,</span>
</span><span id="NSSession.add_to_dossier-895"><a href="#NSSession.add_to_dossier-895"><span class="linenos">895</span></a>                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">nations</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">nations</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="k">else</span> <span class="n">nations</span><span class="p">,</span>
</span><span id="NSSession.add_to_dossier-896"><a href="#NSSession.add_to_dossier-896"><span class="linenos">896</span></a>                <span class="s2">&quot;text/plain&quot;</span><span class="p">,</span>
</span><span id="NSSession.add_to_dossier-897"><a href="#NSSession.add_to_dossier-897"><span class="linenos">897</span></a>            <span class="p">),</span>
</span><span id="NSSession.add_to_dossier-898"><a href="#NSSession.add_to_dossier-898"><span class="linenos">898</span></a>        <span class="p">}</span>
</span><span id="NSSession.add_to_dossier-899"><a href="#NSSession.add_to_dossier-899"><span class="linenos">899</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="NSSession.add_to_dossier-900"><a href="#NSSession.add_to_dossier-900"><span class="linenos">900</span></a>
</span><span id="NSSession.add_to_dossier-901"><a href="#NSSession.add_to_dossier-901"><span class="linenos">901</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="NSSession.add_to_dossier-902"><a href="#NSSession.add_to_dossier-902"><span class="linenos">902</span></a>        <span class="k">return</span> <span class="s2">&quot;appended=&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Adds nations to the logged in nation's dossier.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nations (list[str] | str):</strong>  List of nations to add, or a single nation</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether it was successful or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.wa_vote" class="classattr">
                                        <input id="NSSession.wa_vote-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">wa_vote</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">council</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">vote</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.wa_vote-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.wa_vote"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.wa_vote-904"><a href="#NSSession.wa_vote-904"><span class="linenos">904</span></a>    <span class="k">def</span> <span class="nf">wa_vote</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">council</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">vote</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.wa_vote-905"><a href="#NSSession.wa_vote-905"><span class="linenos">905</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Votes on the current WA resolution.</span>
</span><span id="NSSession.wa_vote-906"><a href="#NSSession.wa_vote-906"><span class="linenos">906</span></a>
</span><span id="NSSession.wa_vote-907"><a href="#NSSession.wa_vote-907"><span class="linenos">907</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.wa_vote-908"><a href="#NSSession.wa_vote-908"><span class="linenos">908</span></a><span class="sd">            council (str): Must be &quot;ga&quot; for general assembly, &quot;sc&quot; for security council.</span>
</span><span id="NSSession.wa_vote-909"><a href="#NSSession.wa_vote-909"><span class="linenos">909</span></a><span class="sd">            vote (str): Must be &quot;for&quot; or &quot;against&quot;.</span>
</span><span id="NSSession.wa_vote-910"><a href="#NSSession.wa_vote-910"><span class="linenos">910</span></a>
</span><span id="NSSession.wa_vote-911"><a href="#NSSession.wa_vote-911"><span class="linenos">911</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.wa_vote-912"><a href="#NSSession.wa_vote-912"><span class="linenos">912</span></a><span class="sd">            bool: Whether the vote was successful or not</span>
</span><span id="NSSession.wa_vote-913"><a href="#NSSession.wa_vote-913"><span class="linenos">913</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.wa_vote-914"><a href="#NSSession.wa_vote-914"><span class="linenos">914</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="NSSession.wa_vote-915"><a href="#NSSession.wa_vote-915"><span class="linenos">915</span></a>            <span class="sa">f</span><span class="s2">&quot;Voting </span><span class="si">{</span><span class="n">vote</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">council</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2"> resolution with </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nation</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.wa_vote-916"><a href="#NSSession.wa_vote-916"><span class="linenos">916</span></a>        <span class="p">)</span>
</span><span id="NSSession.wa_vote-917"><a href="#NSSession.wa_vote-917"><span class="linenos">917</span></a>        <span class="k">if</span> <span class="n">council</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;ga&quot;</span><span class="p">,</span> <span class="s2">&quot;sc&quot;</span><span class="p">}:</span>
</span><span id="NSSession.wa_vote-918"><a href="#NSSession.wa_vote-918"><span class="linenos">918</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;council must be &#39;ga&#39; or &#39;sc&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession.wa_vote-919"><a href="#NSSession.wa_vote-919"><span class="linenos">919</span></a>        <span class="k">if</span> <span class="n">vote</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;for&quot;</span><span class="p">,</span> <span class="s2">&quot;against&quot;</span><span class="p">}:</span>
</span><span id="NSSession.wa_vote-920"><a href="#NSSession.wa_vote-920"><span class="linenos">920</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;vote must be &#39;for&#39; or &#39;against&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession.wa_vote-921"><a href="#NSSession.wa_vote-921"><span class="linenos">921</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Voting on WA resolution&quot;</span><span class="p">)</span>
</span><span id="NSSession.wa_vote-922"><a href="#NSSession.wa_vote-922"><span class="linenos">922</span></a>
</span><span id="NSSession.wa_vote-923"><a href="#NSSession.wa_vote-923"><span class="linenos">923</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=</span><span class="si">{</span><span class="n">council</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.wa_vote-924"><a href="#NSSession.wa_vote-924"><span class="linenos">924</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.wa_vote-925"><a href="#NSSession.wa_vote-925"><span class="linenos">925</span></a>            <span class="s2">&quot;vote&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Vote </span><span class="si">{</span><span class="n">vote</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="NSSession.wa_vote-926"><a href="#NSSession.wa_vote-926"><span class="linenos">926</span></a>        <span class="p">}</span>
</span><span id="NSSession.wa_vote-927"><a href="#NSSession.wa_vote-927"><span class="linenos">927</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.wa_vote-928"><a href="#NSSession.wa_vote-928"><span class="linenos">928</span></a>
</span><span id="NSSession.wa_vote-929"><a href="#NSSession.wa_vote-929"><span class="linenos">929</span></a>        <span class="k">return</span> <span class="s2">&quot;Your vote has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Votes on the current WA resolution.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>council (str):</strong>  Must be "ga" for general assembly, "sc" for security council.</li>
<li><strong>vote (str):</strong>  Must be "for" or "against".</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the vote was successful or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.refound_nation" class="classattr">
                                        <input id="NSSession.refound_nation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">refound_nation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nation</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">password</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.refound_nation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.refound_nation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.refound_nation-931"><a href="#NSSession.refound_nation-931"><span class="linenos">931</span></a>    <span class="k">def</span> <span class="nf">refound_nation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.refound_nation-932"><a href="#NSSession.refound_nation-932"><span class="linenos">932</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Refounds a nation.</span>
</span><span id="NSSession.refound_nation-933"><a href="#NSSession.refound_nation-933"><span class="linenos">933</span></a>
</span><span id="NSSession.refound_nation-934"><a href="#NSSession.refound_nation-934"><span class="linenos">934</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.refound_nation-935"><a href="#NSSession.refound_nation-935"><span class="linenos">935</span></a><span class="sd">            nation (str): Name of the nation to refound</span>
</span><span id="NSSession.refound_nation-936"><a href="#NSSession.refound_nation-936"><span class="linenos">936</span></a><span class="sd">            password (str): Password to the nation</span>
</span><span id="NSSession.refound_nation-937"><a href="#NSSession.refound_nation-937"><span class="linenos">937</span></a>
</span><span id="NSSession.refound_nation-938"><a href="#NSSession.refound_nation-938"><span class="linenos">938</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.refound_nation-939"><a href="#NSSession.refound_nation-939"><span class="linenos">939</span></a><span class="sd">            bool: Whether the nation was successfully refounded or not</span>
</span><span id="NSSession.refound_nation-940"><a href="#NSSession.refound_nation-940"><span class="linenos">940</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.refound_nation-941"><a href="#NSSession.refound_nation-941"><span class="linenos">941</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/&quot;</span>
</span><span id="NSSession.refound_nation-942"><a href="#NSSession.refound_nation-942"><span class="linenos">942</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.refound_nation-943"><a href="#NSSession.refound_nation-943"><span class="linenos">943</span></a>            <span class="s2">&quot;logging_in&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.refound_nation-944"><a href="#NSSession.refound_nation-944"><span class="linenos">944</span></a>            <span class="s2">&quot;restore_password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
</span><span id="NSSession.refound_nation-945"><a href="#NSSession.refound_nation-945"><span class="linenos">945</span></a>            <span class="s2">&quot;restore_nation&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.refound_nation-946"><a href="#NSSession.refound_nation-946"><span class="linenos">946</span></a>            <span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">nation</span><span class="p">,</span>
</span><span id="NSSession.refound_nation-947"><a href="#NSSession.refound_nation-947"><span class="linenos">947</span></a>        <span class="p">}</span>
</span><span id="NSSession.refound_nation-948"><a href="#NSSession.refound_nation-948"><span class="linenos">948</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.refound_nation-949"><a href="#NSSession.refound_nation-949"><span class="linenos">949</span></a>        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">302</span><span class="p">:</span>
</span><span id="NSSession.refound_nation-950"><a href="#NSSession.refound_nation-950"><span class="linenos">950</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">nation</span> <span class="o">=</span> <span class="n">nation</span>
</span><span id="NSSession.refound_nation-951"><a href="#NSSession.refound_nation-951"><span class="linenos">951</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">refresh_auth_values</span><span class="p">()</span>
</span><span id="NSSession.refound_nation-952"><a href="#NSSession.refound_nation-952"><span class="linenos">952</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="NSSession.refound_nation-953"><a href="#NSSession.refound_nation-953"><span class="linenos">953</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Refounds a nation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  Name of the nation to refound</li>
<li><strong>password (str):</strong>  Password to the nation</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the nation was successfully refounded or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.create_region" class="classattr">
                                        <input id="NSSession.create_region-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_region</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">region_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">wfe</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="o">*</span>,</span><span class="param">	<span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">frontier</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">executive_delegacy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.create_region-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.create_region"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.create_region-957"><a href="#NSSession.create_region-957"><span class="linenos">957</span></a>    <span class="k">def</span> <span class="nf">create_region</span><span class="p">(</span>
</span><span id="NSSession.create_region-958"><a href="#NSSession.create_region-958"><span class="linenos">958</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="NSSession.create_region-959"><a href="#NSSession.create_region-959"><span class="linenos">959</span></a>        <span class="n">region_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.create_region-960"><a href="#NSSession.create_region-960"><span class="linenos">960</span></a>        <span class="n">wfe</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="NSSession.create_region-961"><a href="#NSSession.create_region-961"><span class="linenos">961</span></a>        <span class="o">*</span><span class="p">,</span>
</span><span id="NSSession.create_region-962"><a href="#NSSession.create_region-962"><span class="linenos">962</span></a>        <span class="n">password</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span id="NSSession.create_region-963"><a href="#NSSession.create_region-963"><span class="linenos">963</span></a>        <span class="n">frontier</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession.create_region-964"><a href="#NSSession.create_region-964"><span class="linenos">964</span></a>        <span class="n">executive_delegacy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="NSSession.create_region-965"><a href="#NSSession.create_region-965"><span class="linenos">965</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.create_region-966"><a href="#NSSession.create_region-966"><span class="linenos">966</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a new region.</span>
</span><span id="NSSession.create_region-967"><a href="#NSSession.create_region-967"><span class="linenos">967</span></a>
</span><span id="NSSession.create_region-968"><a href="#NSSession.create_region-968"><span class="linenos">968</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.create_region-969"><a href="#NSSession.create_region-969"><span class="linenos">969</span></a><span class="sd">            region_name (str): Name of the region</span>
</span><span id="NSSession.create_region-970"><a href="#NSSession.create_region-970"><span class="linenos">970</span></a><span class="sd">            wfe (str): WFE of the region</span>
</span><span id="NSSession.create_region-971"><a href="#NSSession.create_region-971"><span class="linenos">971</span></a><span class="sd">            password (str, optional): Password to the region. Defaults to &quot;&quot;.</span>
</span><span id="NSSession.create_region-972"><a href="#NSSession.create_region-972"><span class="linenos">972</span></a><span class="sd">            frontier (bool, optional): Whether or not the region is a frontier. Defaults to False.</span>
</span><span id="NSSession.create_region-973"><a href="#NSSession.create_region-973"><span class="linenos">973</span></a><span class="sd">            executive_delegacy (bool, optional): Whether or not the region has an executive WA delegacy. Defaults to False. Ignored if frontier is True.</span>
</span><span id="NSSession.create_region-974"><a href="#NSSession.create_region-974"><span class="linenos">974</span></a>
</span><span id="NSSession.create_region-975"><a href="#NSSession.create_region-975"><span class="linenos">975</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.create_region-976"><a href="#NSSession.create_region-976"><span class="linenos">976</span></a><span class="sd">            bool: Whether the region was successfully created or not</span>
</span><span id="NSSession.create_region-977"><a href="#NSSession.create_region-977"><span class="linenos">977</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.create_region-978"><a href="#NSSession.create_region-978"><span class="linenos">978</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating new region </span><span class="si">{</span><span class="n">region_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.create_region-979"><a href="#NSSession.create_region-979"><span class="linenos">979</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=create_region&quot;</span>
</span><span id="NSSession.create_region-980"><a href="#NSSession.create_region-980"><span class="linenos">980</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.create_region-981"><a href="#NSSession.create_region-981"><span class="linenos">981</span></a>            <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;create_region&quot;</span><span class="p">,</span>
</span><span id="NSSession.create_region-982"><a href="#NSSession.create_region-982"><span class="linenos">982</span></a>            <span class="s2">&quot;region_name&quot;</span><span class="p">:</span> <span class="n">region_name</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="NSSession.create_region-983"><a href="#NSSession.create_region-983"><span class="linenos">983</span></a>            <span class="s2">&quot;desc&quot;</span><span class="p">:</span> <span class="n">wfe</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
</span><span id="NSSession.create_region-984"><a href="#NSSession.create_region-984"><span class="linenos">984</span></a>            <span class="s2">&quot;create_region&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.create_region-985"><a href="#NSSession.create_region-985"><span class="linenos">985</span></a>        <span class="p">}</span>
</span><span id="NSSession.create_region-986"><a href="#NSSession.create_region-986"><span class="linenos">986</span></a>        <span class="k">if</span> <span class="n">password</span><span class="p">:</span>
</span><span id="NSSession.create_region-987"><a href="#NSSession.create_region-987"><span class="linenos">987</span></a>            <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;pw&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;rpassword&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">}</span>
</span><span id="NSSession.create_region-988"><a href="#NSSession.create_region-988"><span class="linenos">988</span></a>        <span class="k">if</span> <span class="n">frontier</span><span class="p">:</span>
</span><span id="NSSession.create_region-989"><a href="#NSSession.create_region-989"><span class="linenos">989</span></a>            <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;is_frontier&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.create_region-990"><a href="#NSSession.create_region-990"><span class="linenos">990</span></a>        <span class="k">elif</span> <span class="n">executive_delegacy</span><span class="p">:</span>
</span><span id="NSSession.create_region-991"><a href="#NSSession.create_region-991"><span class="linenos">991</span></a>            <span class="n">data</span> <span class="o">|=</span> <span class="p">{</span><span class="s2">&quot;delegate_control&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.create_region-992"><a href="#NSSession.create_region-992"><span class="linenos">992</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.create_region-993"><a href="#NSSession.create_region-993"><span class="linenos">993</span></a>        <span class="k">return</span> <span class="s2">&quot;Success! You have founded &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Creates a new region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>region_name (str):</strong>  Name of the region</li>
<li><strong>wfe (str):</strong>  WFE of the region</li>
<li><strong>password (str, optional):</strong>  Password to the region. Defaults to "".</li>
<li><strong>frontier (bool, optional):</strong>  Whether or not the region is a frontier. Defaults to False.</li>
<li><strong>executive_delegacy (bool, optional):</strong>  Whether or not the region has an executive WA delegacy. Defaults to False. Ignored if frontier is True.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the region was successfully created or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.upload_to_region" class="classattr">
                                        <input id="NSSession.upload_to_region-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">upload_to_region</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="nb">type</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="NSSession.upload_to_region-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.upload_to_region"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.upload_to_region-995"><a href="#NSSession.upload_to_region-995"><span class="linenos"> 995</span></a>    <span class="k">def</span> <span class="nf">upload_to_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="NSSession.upload_to_region-996"><a href="#NSSession.upload_to_region-996"><span class="linenos"> 996</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Uploads a file to the current region.</span>
</span><span id="NSSession.upload_to_region-997"><a href="#NSSession.upload_to_region-997"><span class="linenos"> 997</span></a>
</span><span id="NSSession.upload_to_region-998"><a href="#NSSession.upload_to_region-998"><span class="linenos"> 998</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.upload_to_region-999"><a href="#NSSession.upload_to_region-999"><span class="linenos"> 999</span></a><span class="sd">            type (str): Type of file to upload. Must be &quot;flag&quot; or &quot;banner&quot;.</span>
</span><span id="NSSession.upload_to_region-1000"><a href="#NSSession.upload_to_region-1000"><span class="linenos">1000</span></a><span class="sd">            filename (str): Name of the file to upload. e.g. &quot;myflag.png&quot;</span>
</span><span id="NSSession.upload_to_region-1001"><a href="#NSSession.upload_to_region-1001"><span class="linenos">1001</span></a>
</span><span id="NSSession.upload_to_region-1002"><a href="#NSSession.upload_to_region-1002"><span class="linenos">1002</span></a><span class="sd">        Raises:</span>
</span><span id="NSSession.upload_to_region-1003"><a href="#NSSession.upload_to_region-1003"><span class="linenos">1003</span></a><span class="sd">            ValueError: If type is not &quot;flag&quot; or &quot;banner&quot;</span>
</span><span id="NSSession.upload_to_region-1004"><a href="#NSSession.upload_to_region-1004"><span class="linenos">1004</span></a>
</span><span id="NSSession.upload_to_region-1005"><a href="#NSSession.upload_to_region-1005"><span class="linenos">1005</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.upload_to_region-1006"><a href="#NSSession.upload_to_region-1006"><span class="linenos">1006</span></a><span class="sd">            str: Empty string if the upload failed, otherwise the ID of the uploaded file</span>
</span><span id="NSSession.upload_to_region-1007"><a href="#NSSession.upload_to_region-1007"><span class="linenos">1007</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.upload_to_region-1008"><a href="#NSSession.upload_to_region-1008"><span class="linenos">1008</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploading </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.upload_to_region-1009"><a href="#NSSession.upload_to_region-1009"><span class="linenos">1009</span></a>        <span class="k">if</span> <span class="nb">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="s2">&quot;banner&quot;</span><span class="p">}:</span>
</span><span id="NSSession.upload_to_region-1010"><a href="#NSSession.upload_to_region-1010"><span class="linenos">1010</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;type must be &#39;flag&#39; or &#39;banner&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession.upload_to_region-1011"><a href="#NSSession.upload_to_region-1011"><span class="linenos">1011</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/cgi-bin/upload.cgi&quot;</span>
</span><span id="NSSession.upload_to_region-1012"><a href="#NSSession.upload_to_region-1012"><span class="linenos">1012</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.upload_to_region-1013"><a href="#NSSession.upload_to_region-1013"><span class="linenos">1013</span></a>            <span class="s2">&quot;uploadtype&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;r</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="NSSession.upload_to_region-1014"><a href="#NSSession.upload_to_region-1014"><span class="linenos">1014</span></a>            <span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;region_control&quot;</span><span class="p">,</span>
</span><span id="NSSession.upload_to_region-1015"><a href="#NSSession.upload_to_region-1015"><span class="linenos">1015</span></a>            <span class="s2">&quot;region&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
</span><span id="NSSession.upload_to_region-1016"><a href="#NSSession.upload_to_region-1016"><span class="linenos">1016</span></a>            <span class="s2">&quot;expect&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
</span><span id="NSSession.upload_to_region-1017"><a href="#NSSession.upload_to_region-1017"><span class="linenos">1017</span></a>        <span class="p">}</span>
</span><span id="NSSession.upload_to_region-1018"><a href="#NSSession.upload_to_region-1018"><span class="linenos">1018</span></a>        <span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.upload_to_region-1019"><a href="#NSSession.upload_to_region-1019"><span class="linenos">1019</span></a>            <span class="sa">f</span><span class="s2">&quot;file_upload_r</span><span class="si">{</span><span class="nb">type</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="p">(</span>
</span><span id="NSSession.upload_to_region-1020"><a href="#NSSession.upload_to_region-1020"><span class="linenos">1020</span></a>                <span class="n">filename</span><span class="p">,</span>
</span><span id="NSSession.upload_to_region-1021"><a href="#NSSession.upload_to_region-1021"><span class="linenos">1021</span></a>                <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">),</span>
</span><span id="NSSession.upload_to_region-1022"><a href="#NSSession.upload_to_region-1022"><span class="linenos">1022</span></a>                <span class="n">mimetypes</span><span class="o">.</span><span class="n">guess_type</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
</span><span id="NSSession.upload_to_region-1023"><a href="#NSSession.upload_to_region-1023"><span class="linenos">1023</span></a>            <span class="p">)</span>
</span><span id="NSSession.upload_to_region-1024"><a href="#NSSession.upload_to_region-1024"><span class="linenos">1024</span></a>        <span class="p">}</span>
</span><span id="NSSession.upload_to_region-1025"><a href="#NSSession.upload_to_region-1025"><span class="linenos">1025</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="NSSession.upload_to_region-1026"><a href="#NSSession.upload_to_region-1026"><span class="linenos">1026</span></a>        <span class="k">return</span> <span class="s2">&quot;&quot;</span> <span class="k">if</span> <span class="s2">&quot;id&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span> <span class="k">else</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Uploads a file to the current region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>type (str):</strong>  Type of file to upload. Must be "flag" or "banner".</li>
<li><strong>filename (str):</strong>  Name of the file to upload. e.g. "myflag.png"</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If type is not "flag" or "banner"</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>str: Empty string if the upload failed, otherwise the ID of the uploaded file</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.set_flag_and_banner" class="classattr">
                                        <input id="NSSession.set_flag_and_banner-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_flag_and_banner</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">flag_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">banner_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>,</span><span class="param">	<span class="n">flag_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.set_flag_and_banner-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.set_flag_and_banner"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.set_flag_and_banner-1028"><a href="#NSSession.set_flag_and_banner-1028"><span class="linenos">1028</span></a>    <span class="k">def</span> <span class="nf">set_flag_and_banner</span><span class="p">(</span>
</span><span id="NSSession.set_flag_and_banner-1029"><a href="#NSSession.set_flag_and_banner-1029"><span class="linenos">1029</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">flag_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">banner_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">flag_mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="NSSession.set_flag_and_banner-1030"><a href="#NSSession.set_flag_and_banner-1030"><span class="linenos">1030</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.set_flag_and_banner-1031"><a href="#NSSession.set_flag_and_banner-1031"><span class="linenos">1031</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the uploaded flag and/or banner for the current region.</span>
</span><span id="NSSession.set_flag_and_banner-1032"><a href="#NSSession.set_flag_and_banner-1032"><span class="linenos">1032</span></a>
</span><span id="NSSession.set_flag_and_banner-1033"><a href="#NSSession.set_flag_and_banner-1033"><span class="linenos">1033</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.set_flag_and_banner-1034"><a href="#NSSession.set_flag_and_banner-1034"><span class="linenos">1034</span></a><span class="sd">            flag_id (str, optional): ID of the flag, uploaded with upload_to_region(). Defaults to &quot;&quot;.</span>
</span><span id="NSSession.set_flag_and_banner-1035"><a href="#NSSession.set_flag_and_banner-1035"><span class="linenos">1035</span></a><span class="sd">            banner_id (str, optional): ID of the banner, uploaded with upload_to_region(). Defaults to &quot;&quot;.</span>
</span><span id="NSSession.set_flag_and_banner-1036"><a href="#NSSession.set_flag_and_banner-1036"><span class="linenos">1036</span></a><span class="sd">            flagmode (str, optional): Must be &quot;flag&quot; which will have a shadow, or &quot;logo&quot; which will not, or &quot;&quot; to not change it. Defaults to &quot;&quot;.</span>
</span><span id="NSSession.set_flag_and_banner-1037"><a href="#NSSession.set_flag_and_banner-1037"><span class="linenos">1037</span></a>
</span><span id="NSSession.set_flag_and_banner-1038"><a href="#NSSession.set_flag_and_banner-1038"><span class="linenos">1038</span></a><span class="sd">        Raises:</span>
</span><span id="NSSession.set_flag_and_banner-1039"><a href="#NSSession.set_flag_and_banner-1039"><span class="linenos">1039</span></a><span class="sd">            ValueError: If flagmode is not &quot;flag&quot;, &quot;logo&quot;, or &quot;&quot;</span>
</span><span id="NSSession.set_flag_and_banner-1040"><a href="#NSSession.set_flag_and_banner-1040"><span class="linenos">1040</span></a>
</span><span id="NSSession.set_flag_and_banner-1041"><a href="#NSSession.set_flag_and_banner-1041"><span class="linenos">1041</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.set_flag_and_banner-1042"><a href="#NSSession.set_flag_and_banner-1042"><span class="linenos">1042</span></a><span class="sd">            bool: Whether the change was successful or not</span>
</span><span id="NSSession.set_flag_and_banner-1043"><a href="#NSSession.set_flag_and_banner-1043"><span class="linenos">1043</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.set_flag_and_banner-1044"><a href="#NSSession.set_flag_and_banner-1044"><span class="linenos">1044</span></a>        <span class="k">if</span> <span class="n">flag_mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="s2">&quot;logo&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">}:</span>
</span><span id="NSSession.set_flag_and_banner-1045"><a href="#NSSession.set_flag_and_banner-1045"><span class="linenos">1045</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;flagmode must be &#39;flag&#39;, &#39;logo&#39;, or &#39;&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession.set_flag_and_banner-1046"><a href="#NSSession.set_flag_and_banner-1046"><span class="linenos">1046</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting flag and banner for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.set_flag_and_banner-1047"><a href="#NSSession.set_flag_and_banner-1047"><span class="linenos">1047</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession.set_flag_and_banner-1048"><a href="#NSSession.set_flag_and_banner-1048"><span class="linenos">1048</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.set_flag_and_banner-1049"><a href="#NSSession.set_flag_and_banner-1049"><span class="linenos">1049</span></a>            <span class="s2">&quot;newflag&quot;</span><span class="p">:</span> <span class="n">flag_id</span><span class="p">,</span>
</span><span id="NSSession.set_flag_and_banner-1050"><a href="#NSSession.set_flag_and_banner-1050"><span class="linenos">1050</span></a>            <span class="s2">&quot;newbanner&quot;</span><span class="p">:</span> <span class="n">banner_id</span><span class="p">,</span>
</span><span id="NSSession.set_flag_and_banner-1051"><a href="#NSSession.set_flag_and_banner-1051"><span class="linenos">1051</span></a>            <span class="s2">&quot;saveflagandbannerchanges&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.set_flag_and_banner-1052"><a href="#NSSession.set_flag_and_banner-1052"><span class="linenos">1052</span></a>            <span class="s2">&quot;flagmode&quot;</span><span class="p">:</span> <span class="n">flag_mode</span><span class="p">,</span>
</span><span id="NSSession.set_flag_and_banner-1053"><a href="#NSSession.set_flag_and_banner-1053"><span class="linenos">1053</span></a>        <span class="p">}</span>
</span><span id="NSSession.set_flag_and_banner-1054"><a href="#NSSession.set_flag_and_banner-1054"><span class="linenos">1054</span></a>        <span class="c1"># remove entries with empty values</span>
</span><span id="NSSession.set_flag_and_banner-1055"><a href="#NSSession.set_flag_and_banner-1055"><span class="linenos">1055</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span><span class="p">}</span>
</span><span id="NSSession.set_flag_and_banner-1056"><a href="#NSSession.set_flag_and_banner-1056"><span class="linenos">1056</span></a>
</span><span id="NSSession.set_flag_and_banner-1057"><a href="#NSSession.set_flag_and_banner-1057"><span class="linenos">1057</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.set_flag_and_banner-1058"><a href="#NSSession.set_flag_and_banner-1058"><span class="linenos">1058</span></a>
</span><span id="NSSession.set_flag_and_banner-1059"><a href="#NSSession.set_flag_and_banner-1059"><span class="linenos">1059</span></a>        <span class="k">return</span> <span class="s2">&quot;Regional banner/flag updated!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Sets the uploaded flag and/or banner for the current region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>flag_id (str, optional):</strong>  ID of the flag, uploaded with upload_to_region(). Defaults to "".</li>
<li><strong>banner_id (str, optional):</strong>  ID of the banner, uploaded with upload_to_region(). Defaults to "".</li>
<li><strong>flagmode (str, optional):</strong>  Must be "flag" which will have a shadow, or "logo" which will not, or "" to not change it. Defaults to "".</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If flagmode is not "flag", "logo", or ""</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the change was successful or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.change_wfe" class="classattr">
                                        <input id="NSSession.change_wfe-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_wfe</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">wfe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.change_wfe-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.change_wfe"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.change_wfe-1061"><a href="#NSSession.change_wfe-1061"><span class="linenos">1061</span></a>    <span class="k">def</span> <span class="nf">change_wfe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wfe</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.change_wfe-1062"><a href="#NSSession.change_wfe-1062"><span class="linenos">1062</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Changes the WFE of the current region.</span>
</span><span id="NSSession.change_wfe-1063"><a href="#NSSession.change_wfe-1063"><span class="linenos">1063</span></a>
</span><span id="NSSession.change_wfe-1064"><a href="#NSSession.change_wfe-1064"><span class="linenos">1064</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.change_wfe-1065"><a href="#NSSession.change_wfe-1065"><span class="linenos">1065</span></a><span class="sd">            wfe (str, optional): World Factbook Entry to change to. Defaults to the oldest WFE the region has, for detags.</span>
</span><span id="NSSession.change_wfe-1066"><a href="#NSSession.change_wfe-1066"><span class="linenos">1066</span></a>
</span><span id="NSSession.change_wfe-1067"><a href="#NSSession.change_wfe-1067"><span class="linenos">1067</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.change_wfe-1068"><a href="#NSSession.change_wfe-1068"><span class="linenos">1068</span></a><span class="sd">            bool: True if successful, False otherwise</span>
</span><span id="NSSession.change_wfe-1069"><a href="#NSSession.change_wfe-1069"><span class="linenos">1069</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.change_wfe-1070"><a href="#NSSession.change_wfe-1070"><span class="linenos">1070</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Changing WFE for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.change_wfe-1071"><a href="#NSSession.change_wfe-1071"><span class="linenos">1071</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">wfe</span><span class="p">:</span>
</span><span id="NSSession.change_wfe-1072"><a href="#NSSession.change_wfe-1072"><span class="linenos">1072</span></a>            <span class="n">wfe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_detag_wfe</span><span class="p">()</span>  <span class="c1"># haku im sorry for hitting your site so much</span>
</span><span id="NSSession.change_wfe-1073"><a href="#NSSession.change_wfe-1073"><span class="linenos">1073</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession.change_wfe-1074"><a href="#NSSession.change_wfe-1074"><span class="linenos">1074</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.change_wfe-1075"><a href="#NSSession.change_wfe-1075"><span class="linenos">1075</span></a>            <span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="n">wfe</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;iso-8859-1&quot;</span><span class="p">,</span> <span class="s2">&quot;xmlcharrefreplace&quot;</span><span class="p">)</span>
</span><span id="NSSession.change_wfe-1076"><a href="#NSSession.change_wfe-1076"><span class="linenos">1076</span></a>            <span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="NSSession.change_wfe-1077"><a href="#NSSession.change_wfe-1077"><span class="linenos">1077</span></a>            <span class="o">.</span><span class="n">strip</span><span class="p">(),</span>  <span class="c1"># lol.</span>
</span><span id="NSSession.change_wfe-1078"><a href="#NSSession.change_wfe-1078"><span class="linenos">1078</span></a>            <span class="s2">&quot;setwfebutton&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.change_wfe-1079"><a href="#NSSession.change_wfe-1079"><span class="linenos">1079</span></a>        <span class="p">}</span>
</span><span id="NSSession.change_wfe-1080"><a href="#NSSession.change_wfe-1080"><span class="linenos">1080</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.change_wfe-1081"><a href="#NSSession.change_wfe-1081"><span class="linenos">1081</span></a>        <span class="k">return</span> <span class="s2">&quot;World Factbook Entry updated!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Changes the WFE of the current region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>wfe (str, optional):</strong>  World Factbook Entry to change to. Defaults to the oldest WFE the region has, for detags.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: True if successful, False otherwise</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.request_embassy" class="classattr">
                                        <input id="NSSession.request_embassy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">request_embassy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.request_embassy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.request_embassy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.request_embassy-1085"><a href="#NSSession.request_embassy-1085"><span class="linenos">1085</span></a>    <span class="k">def</span> <span class="nf">request_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.request_embassy-1086"><a href="#NSSession.request_embassy-1086"><span class="linenos">1086</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Requests an embassy with a region.</span>
</span><span id="NSSession.request_embassy-1087"><a href="#NSSession.request_embassy-1087"><span class="linenos">1087</span></a>
</span><span id="NSSession.request_embassy-1088"><a href="#NSSession.request_embassy-1088"><span class="linenos">1088</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.request_embassy-1089"><a href="#NSSession.request_embassy-1089"><span class="linenos">1089</span></a><span class="sd">            target (str): The region to request the embassy with.</span>
</span><span id="NSSession.request_embassy-1090"><a href="#NSSession.request_embassy-1090"><span class="linenos">1090</span></a>
</span><span id="NSSession.request_embassy-1091"><a href="#NSSession.request_embassy-1091"><span class="linenos">1091</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.request_embassy-1092"><a href="#NSSession.request_embassy-1092"><span class="linenos">1092</span></a><span class="sd">            bool: Whether the request was successfully sent or not</span>
</span><span id="NSSession.request_embassy-1093"><a href="#NSSession.request_embassy-1093"><span class="linenos">1093</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.request_embassy-1094"><a href="#NSSession.request_embassy-1094"><span class="linenos">1094</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Requesting embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.request_embassy-1095"><a href="#NSSession.request_embassy-1095"><span class="linenos">1095</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession.request_embassy-1096"><a href="#NSSession.request_embassy-1096"><span class="linenos">1096</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.request_embassy-1097"><a href="#NSSession.request_embassy-1097"><span class="linenos">1097</span></a>            <span class="s2">&quot;requestembassyregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">,</span>
</span><span id="NSSession.request_embassy-1098"><a href="#NSSession.request_embassy-1098"><span class="linenos">1098</span></a>            <span class="s2">&quot;requestembassy&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>  <span class="c1"># it&#39;s silly that requesting needs this but not closing, aborting, or cancelling</span>
</span><span id="NSSession.request_embassy-1099"><a href="#NSSession.request_embassy-1099"><span class="linenos">1099</span></a>        <span class="p">}</span>
</span><span id="NSSession.request_embassy-1100"><a href="#NSSession.request_embassy-1100"><span class="linenos">1100</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.request_embassy-1101"><a href="#NSSession.request_embassy-1101"><span class="linenos">1101</span></a>        <span class="k">return</span> <span class="s2">&quot;Your proposal for the construction of embassies with&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Requests an embassy with a region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target (str):</strong>  The region to request the embassy with.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the request was successfully sent or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.close_embassy" class="classattr">
                                        <input id="NSSession.close_embassy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">close_embassy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.close_embassy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.close_embassy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.close_embassy-1103"><a href="#NSSession.close_embassy-1103"><span class="linenos">1103</span></a>    <span class="k">def</span> <span class="nf">close_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.close_embassy-1104"><a href="#NSSession.close_embassy-1104"><span class="linenos">1104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Closes an embassy with a region.</span>
</span><span id="NSSession.close_embassy-1105"><a href="#NSSession.close_embassy-1105"><span class="linenos">1105</span></a>
</span><span id="NSSession.close_embassy-1106"><a href="#NSSession.close_embassy-1106"><span class="linenos">1106</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.close_embassy-1107"><a href="#NSSession.close_embassy-1107"><span class="linenos">1107</span></a><span class="sd">            target (str): The region with which to close the embassy.</span>
</span><span id="NSSession.close_embassy-1108"><a href="#NSSession.close_embassy-1108"><span class="linenos">1108</span></a>
</span><span id="NSSession.close_embassy-1109"><a href="#NSSession.close_embassy-1109"><span class="linenos">1109</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.close_embassy-1110"><a href="#NSSession.close_embassy-1110"><span class="linenos">1110</span></a><span class="sd">            bool: Whether the embassy was successfully closed or not</span>
</span><span id="NSSession.close_embassy-1111"><a href="#NSSession.close_embassy-1111"><span class="linenos">1111</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.close_embassy-1112"><a href="#NSSession.close_embassy-1112"><span class="linenos">1112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Closing embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.close_embassy-1113"><a href="#NSSession.close_embassy-1113"><span class="linenos">1113</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession.close_embassy-1114"><a href="#NSSession.close_embassy-1114"><span class="linenos">1114</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cancelembassyregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
</span><span id="NSSession.close_embassy-1115"><a href="#NSSession.close_embassy-1115"><span class="linenos">1115</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.close_embassy-1116"><a href="#NSSession.close_embassy-1116"><span class="linenos">1116</span></a>        <span class="k">return</span> <span class="s2">&quot; has been scheduled for demolition.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Closes an embassy with a region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target (str):</strong>  The region with which to close the embassy.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the embassy was successfully closed or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.abort_embassy" class="classattr">
                                        <input id="NSSession.abort_embassy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">abort_embassy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.abort_embassy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.abort_embassy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.abort_embassy-1118"><a href="#NSSession.abort_embassy-1118"><span class="linenos">1118</span></a>    <span class="k">def</span> <span class="nf">abort_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.abort_embassy-1119"><a href="#NSSession.abort_embassy-1119"><span class="linenos">1119</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Aborts an embassy with a region.</span>
</span><span id="NSSession.abort_embassy-1120"><a href="#NSSession.abort_embassy-1120"><span class="linenos">1120</span></a>
</span><span id="NSSession.abort_embassy-1121"><a href="#NSSession.abort_embassy-1121"><span class="linenos">1121</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.abort_embassy-1122"><a href="#NSSession.abort_embassy-1122"><span class="linenos">1122</span></a><span class="sd">            target (str): The region with which to abort the embassy.</span>
</span><span id="NSSession.abort_embassy-1123"><a href="#NSSession.abort_embassy-1123"><span class="linenos">1123</span></a>
</span><span id="NSSession.abort_embassy-1124"><a href="#NSSession.abort_embassy-1124"><span class="linenos">1124</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.abort_embassy-1125"><a href="#NSSession.abort_embassy-1125"><span class="linenos">1125</span></a><span class="sd">            bool: Whether the embassy was successfully aborted or not</span>
</span><span id="NSSession.abort_embassy-1126"><a href="#NSSession.abort_embassy-1126"><span class="linenos">1126</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.abort_embassy-1127"><a href="#NSSession.abort_embassy-1127"><span class="linenos">1127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Aborting embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.abort_embassy-1128"><a href="#NSSession.abort_embassy-1128"><span class="linenos">1128</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession.abort_embassy-1129"><a href="#NSSession.abort_embassy-1129"><span class="linenos">1129</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;abortembassyregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
</span><span id="NSSession.abort_embassy-1130"><a href="#NSSession.abort_embassy-1130"><span class="linenos">1130</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.abort_embassy-1131"><a href="#NSSession.abort_embassy-1131"><span class="linenos">1131</span></a>        <span class="k">return</span> <span class="s2">&quot; aborted.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Aborts an embassy with a region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target (str):</strong>  The region with which to abort the embassy.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the embassy was successfully aborted or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.cancel_embassy" class="classattr">
                                        <input id="NSSession.cancel_embassy-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">cancel_embassy</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">target</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.cancel_embassy-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.cancel_embassy"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.cancel_embassy-1133"><a href="#NSSession.cancel_embassy-1133"><span class="linenos">1133</span></a>    <span class="k">def</span> <span class="nf">cancel_embassy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.cancel_embassy-1134"><a href="#NSSession.cancel_embassy-1134"><span class="linenos">1134</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Cancels an embassy with a region.</span>
</span><span id="NSSession.cancel_embassy-1135"><a href="#NSSession.cancel_embassy-1135"><span class="linenos">1135</span></a>
</span><span id="NSSession.cancel_embassy-1136"><a href="#NSSession.cancel_embassy-1136"><span class="linenos">1136</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.cancel_embassy-1137"><a href="#NSSession.cancel_embassy-1137"><span class="linenos">1137</span></a><span class="sd">            target (str): The region with which to cancel the embassy.</span>
</span><span id="NSSession.cancel_embassy-1138"><a href="#NSSession.cancel_embassy-1138"><span class="linenos">1138</span></a>
</span><span id="NSSession.cancel_embassy-1139"><a href="#NSSession.cancel_embassy-1139"><span class="linenos">1139</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.cancel_embassy-1140"><a href="#NSSession.cancel_embassy-1140"><span class="linenos">1140</span></a><span class="sd">            bool: Whether the embassy was successfully cancelled or not</span>
</span><span id="NSSession.cancel_embassy-1141"><a href="#NSSession.cancel_embassy-1141"><span class="linenos">1141</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.cancel_embassy-1142"><a href="#NSSession.cancel_embassy-1142"><span class="linenos">1142</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cancelling embassy with </span><span class="si">{</span><span class="n">target</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.cancel_embassy-1143"><a href="#NSSession.cancel_embassy-1143"><span class="linenos">1143</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession.cancel_embassy-1144"><a href="#NSSession.cancel_embassy-1144"><span class="linenos">1144</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cancelembassyclosureregion&quot;</span><span class="p">:</span> <span class="n">target</span><span class="p">}</span>
</span><span id="NSSession.cancel_embassy-1145"><a href="#NSSession.cancel_embassy-1145"><span class="linenos">1145</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.cancel_embassy-1146"><a href="#NSSession.cancel_embassy-1146"><span class="linenos">1146</span></a>        <span class="k">return</span> <span class="s2">&quot;Embassy closure order cancelled.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Cancels an embassy with a region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>target (str):</strong>  The region with which to cancel the embassy.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the embassy was successfully cancelled or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.tag" class="classattr">
                                        <input id="NSSession.tag-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">tag</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">action</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">tag</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.tag-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.tag"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.tag-1150"><a href="#NSSession.tag-1150"><span class="linenos">1150</span></a>    <span class="k">def</span> <span class="nf">tag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tag</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.tag-1151"><a href="#NSSession.tag-1151"><span class="linenos">1151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds or removes a tag to the current region.</span>
</span><span id="NSSession.tag-1152"><a href="#NSSession.tag-1152"><span class="linenos">1152</span></a>
</span><span id="NSSession.tag-1153"><a href="#NSSession.tag-1153"><span class="linenos">1153</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.tag-1154"><a href="#NSSession.tag-1154"><span class="linenos">1154</span></a><span class="sd">            action (str): The action to take. Must be &quot;add&quot; or &quot;remove&quot;.</span>
</span><span id="NSSession.tag-1155"><a href="#NSSession.tag-1155"><span class="linenos">1155</span></a><span class="sd">            tag (str): The tag to add or remove.</span>
</span><span id="NSSession.tag-1156"><a href="#NSSession.tag-1156"><span class="linenos">1156</span></a>
</span><span id="NSSession.tag-1157"><a href="#NSSession.tag-1157"><span class="linenos">1157</span></a><span class="sd">        Raises:</span>
</span><span id="NSSession.tag-1158"><a href="#NSSession.tag-1158"><span class="linenos">1158</span></a><span class="sd">            ValueError: If action is not &quot;add&quot; or &quot;remove&quot;, or if tag is not a valid tag.</span>
</span><span id="NSSession.tag-1159"><a href="#NSSession.tag-1159"><span class="linenos">1159</span></a>
</span><span id="NSSession.tag-1160"><a href="#NSSession.tag-1160"><span class="linenos">1160</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.tag-1161"><a href="#NSSession.tag-1161"><span class="linenos">1161</span></a><span class="sd">            bool: Whether the tag was successfully added or removed</span>
</span><span id="NSSession.tag-1162"><a href="#NSSession.tag-1162"><span class="linenos">1162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.tag-1163"><a href="#NSSession.tag-1163"><span class="linenos">1163</span></a>        <span class="k">if</span> <span class="n">action</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="s2">&quot;remove&quot;</span><span class="p">}:</span>
</span><span id="NSSession.tag-1164"><a href="#NSSession.tag-1164"><span class="linenos">1164</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;action must be &#39;add&#39; or &#39;remove&#39;&quot;</span><span class="p">)</span>
</span><span id="NSSession.tag-1165"><a href="#NSSession.tag-1165"><span class="linenos">1165</span></a>        <span class="k">if</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">tag</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid</span><span class="o">.</span><span class="n">REGION_TAGS</span><span class="p">:</span>
</span><span id="NSSession.tag-1166"><a href="#NSSession.tag-1166"><span class="linenos">1166</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2"> is not a valid tag&quot;</span><span class="p">)</span>
</span><span id="NSSession.tag-1167"><a href="#NSSession.tag-1167"><span class="linenos">1167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">action</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="si">}</span><span class="s2">ing tag </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.tag-1168"><a href="#NSSession.tag-1168"><span class="linenos">1168</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession.tag-1169"><a href="#NSSession.tag-1169"><span class="linenos">1169</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.tag-1170"><a href="#NSSession.tag-1170"><span class="linenos">1170</span></a>            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">_tag&quot;</span><span class="p">:</span> <span class="n">canonicalize</span><span class="p">(</span><span class="n">tag</span><span class="p">),</span>
</span><span id="NSSession.tag-1171"><a href="#NSSession.tag-1171"><span class="linenos">1171</span></a>            <span class="s2">&quot;updatetagsbutton&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.tag-1172"><a href="#NSSession.tag-1172"><span class="linenos">1172</span></a>        <span class="p">}</span>
</span><span id="NSSession.tag-1173"><a href="#NSSession.tag-1173"><span class="linenos">1173</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.tag-1174"><a href="#NSSession.tag-1174"><span class="linenos">1174</span></a>        <span class="k">return</span> <span class="s2">&quot;Region Tags updated!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Adds or removes a tag to the current region.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>action (str):</strong>  The action to take. Must be "add" or "remove".</li>
<li><strong>tag (str):</strong>  The tag to add or remove.</li>
</ul>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>ValueError:</strong>  If action is not "add" or "remove", or if tag is not a valid tag.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the tag was successfully added or removed</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.eject" class="classattr">
                                        <input id="NSSession.eject-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">eject</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nation</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.eject-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.eject"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.eject-1176"><a href="#NSSession.eject-1176"><span class="linenos">1176</span></a>    <span class="k">def</span> <span class="nf">eject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.eject-1177"><a href="#NSSession.eject-1177"><span class="linenos">1177</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Ejects a nation from the current region. Note that a 1 second delay is required before ejecting another nation.</span>
</span><span id="NSSession.eject-1178"><a href="#NSSession.eject-1178"><span class="linenos">1178</span></a>
</span><span id="NSSession.eject-1179"><a href="#NSSession.eject-1179"><span class="linenos">1179</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.eject-1180"><a href="#NSSession.eject-1180"><span class="linenos">1180</span></a><span class="sd">            nation (str): The nation to eject.</span>
</span><span id="NSSession.eject-1181"><a href="#NSSession.eject-1181"><span class="linenos">1181</span></a>
</span><span id="NSSession.eject-1182"><a href="#NSSession.eject-1182"><span class="linenos">1182</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.eject-1183"><a href="#NSSession.eject-1183"><span class="linenos">1183</span></a><span class="sd">            bool: Whether the nation was successfully ejected or not</span>
</span><span id="NSSession.eject-1184"><a href="#NSSession.eject-1184"><span class="linenos">1184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.eject-1185"><a href="#NSSession.eject-1185"><span class="linenos">1185</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ejecting </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.eject-1186"><a href="#NSSession.eject-1186"><span class="linenos">1186</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession.eject-1187"><a href="#NSSession.eject-1187"><span class="linenos">1187</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation_name&quot;</span><span class="p">:</span> <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;eject&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.eject-1188"><a href="#NSSession.eject-1188"><span class="linenos">1188</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.eject-1189"><a href="#NSSession.eject-1189"><span class="linenos">1189</span></a>        <span class="k">return</span> <span class="s2">&quot;has been ejected from &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Ejects a nation from the current region. Note that a 1 second delay is required before ejecting another nation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  The nation to eject.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the nation was successfully ejected or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.banject" class="classattr">
                                        <input id="NSSession.banject-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">banject</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nation</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.banject-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.banject"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.banject-1191"><a href="#NSSession.banject-1191"><span class="linenos">1191</span></a>    <span class="k">def</span> <span class="nf">banject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nation</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.banject-1192"><a href="#NSSession.banject-1192"><span class="linenos">1192</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Bans a nation from the current region. Note that a 1 second delay is required before banjecting another nation.</span>
</span><span id="NSSession.banject-1193"><a href="#NSSession.banject-1193"><span class="linenos">1193</span></a>
</span><span id="NSSession.banject-1194"><a href="#NSSession.banject-1194"><span class="linenos">1194</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.banject-1195"><a href="#NSSession.banject-1195"><span class="linenos">1195</span></a><span class="sd">            nation (str): The nation to banject.</span>
</span><span id="NSSession.banject-1196"><a href="#NSSession.banject-1196"><span class="linenos">1196</span></a>
</span><span id="NSSession.banject-1197"><a href="#NSSession.banject-1197"><span class="linenos">1197</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.banject-1198"><a href="#NSSession.banject-1198"><span class="linenos">1198</span></a><span class="sd">            bool: Whether the nation was successfully banjected or not</span>
</span><span id="NSSession.banject-1199"><a href="#NSSession.banject-1199"><span class="linenos">1199</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.banject-1200"><a href="#NSSession.banject-1200"><span class="linenos">1200</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Banjecting </span><span class="si">{</span><span class="n">nation</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.banject-1201"><a href="#NSSession.banject-1201"><span class="linenos">1201</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=region_control/&quot;</span>
</span><span id="NSSession.banject-1202"><a href="#NSSession.banject-1202"><span class="linenos">1202</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation_name&quot;</span><span class="p">:</span> <span class="n">nation</span><span class="p">,</span> <span class="s2">&quot;ban&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.banject-1203"><a href="#NSSession.banject-1203"><span class="linenos">1203</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.banject-1204"><a href="#NSSession.banject-1204"><span class="linenos">1204</span></a>        <span class="k">return</span> <span class="s2">&quot;has been ejected and banned from &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Bans a nation from the current region. Note that a 1 second delay is required before banjecting another nation.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>nation (str):</strong>  The nation to banject.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the nation was successfully banjected or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.junk_card" class="classattr">
                                        <input id="NSSession.junk_card-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">junk_card</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">season</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.junk_card-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.junk_card"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.junk_card-1208"><a href="#NSSession.junk_card-1208"><span class="linenos">1208</span></a>    <span class="k">def</span> <span class="nf">junk_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.junk_card-1209"><a href="#NSSession.junk_card-1209"><span class="linenos">1209</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Junks a card from the current nation&#39;s deck.</span>
</span><span id="NSSession.junk_card-1210"><a href="#NSSession.junk_card-1210"><span class="linenos">1210</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.junk_card-1211"><a href="#NSSession.junk_card-1211"><span class="linenos">1211</span></a><span class="sd">            id (str): ID of the card to junk</span>
</span><span id="NSSession.junk_card-1212"><a href="#NSSession.junk_card-1212"><span class="linenos">1212</span></a><span class="sd">            season (str): Season of the card to junk</span>
</span><span id="NSSession.junk_card-1213"><a href="#NSSession.junk_card-1213"><span class="linenos">1213</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.junk_card-1214"><a href="#NSSession.junk_card-1214"><span class="linenos">1214</span></a><span class="sd">            bool: Whether the card was successfully junked or not</span>
</span><span id="NSSession.junk_card-1215"><a href="#NSSession.junk_card-1215"><span class="linenos">1215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.junk_card-1216"><a href="#NSSession.junk_card-1216"><span class="linenos">1216</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Junking card </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2"> from season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.junk_card-1217"><a href="#NSSession.junk_card-1217"><span class="linenos">1217</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession.junk_card-1218"><a href="#NSSession.junk_card-1218"><span class="linenos">1218</span></a>
</span><span id="NSSession.junk_card-1219"><a href="#NSSession.junk_card-1219"><span class="linenos">1219</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;page&quot;</span><span class="p">:</span> <span class="s2">&quot;ajax3&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span> <span class="s2">&quot;junkcard&quot;</span><span class="p">,</span> <span class="s2">&quot;card&quot;</span><span class="p">:</span> <span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;season&quot;</span><span class="p">:</span> <span class="n">season</span><span class="p">}</span>
</span><span id="NSSession.junk_card-1220"><a href="#NSSession.junk_card-1220"><span class="linenos">1220</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.junk_card-1221"><a href="#NSSession.junk_card-1221"><span class="linenos">1221</span></a>
</span><span id="NSSession.junk_card-1222"><a href="#NSSession.junk_card-1222"><span class="linenos">1222</span></a>        <span class="k">return</span> <span class="s2">&quot;Your Deck&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Junks a card from the current nation's deck.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>id (str):</strong>  ID of the card to junk</li>
<li><strong>season (str):</strong>  Season of the card to junk</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the card was successfully junked or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.open_pack" class="classattr">
                                        <input id="NSSession.open_pack-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">open_pack</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.open_pack-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.open_pack"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.open_pack-1224"><a href="#NSSession.open_pack-1224"><span class="linenos">1224</span></a>    <span class="k">def</span> <span class="nf">open_pack</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.open_pack-1225"><a href="#NSSession.open_pack-1225"><span class="linenos">1225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Opens a card pack.</span>
</span><span id="NSSession.open_pack-1226"><a href="#NSSession.open_pack-1226"><span class="linenos">1226</span></a>
</span><span id="NSSession.open_pack-1227"><a href="#NSSession.open_pack-1227"><span class="linenos">1227</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.open_pack-1228"><a href="#NSSession.open_pack-1228"><span class="linenos">1228</span></a><span class="sd">            bool: Whether the bid was successfully removed or not</span>
</span><span id="NSSession.open_pack-1229"><a href="#NSSession.open_pack-1229"><span class="linenos">1229</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.open_pack-1230"><a href="#NSSession.open_pack-1230"><span class="linenos">1230</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Opening trading card pack&quot;</span><span class="p">)</span>
</span><span id="NSSession.open_pack-1231"><a href="#NSSession.open_pack-1231"><span class="linenos">1231</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession.open_pack-1232"><a href="#NSSession.open_pack-1232"><span class="linenos">1232</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;open_loot_box&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.open_pack-1233"><a href="#NSSession.open_pack-1233"><span class="linenos">1233</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.open_pack-1234"><a href="#NSSession.open_pack-1234"><span class="linenos">1234</span></a>        <span class="k">return</span> <span class="s2">&quot;Tap cards to reveal...&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Opens a card pack.</p>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the bid was successfully removed or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.ask" class="classattr">
                                        <input id="NSSession.ask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ask</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">price</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">season</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.ask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.ask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.ask-1236"><a href="#NSSession.ask-1236"><span class="linenos">1236</span></a>    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.ask-1237"><a href="#NSSession.ask-1237"><span class="linenos">1237</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Puts an ask at price on a card in a season</span>
</span><span id="NSSession.ask-1238"><a href="#NSSession.ask-1238"><span class="linenos">1238</span></a>
</span><span id="NSSession.ask-1239"><a href="#NSSession.ask-1239"><span class="linenos">1239</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.ask-1240"><a href="#NSSession.ask-1240"><span class="linenos">1240</span></a><span class="sd">            price (str): Price to ask</span>
</span><span id="NSSession.ask-1241"><a href="#NSSession.ask-1241"><span class="linenos">1241</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="NSSession.ask-1242"><a href="#NSSession.ask-1242"><span class="linenos">1242</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="NSSession.ask-1243"><a href="#NSSession.ask-1243"><span class="linenos">1243</span></a>
</span><span id="NSSession.ask-1244"><a href="#NSSession.ask-1244"><span class="linenos">1244</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.ask-1245"><a href="#NSSession.ask-1245"><span class="linenos">1245</span></a><span class="sd">            bool: Whether the ask was successfully lodged or not</span>
</span><span id="NSSession.ask-1246"><a href="#NSSession.ask-1246"><span class="linenos">1246</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.ask-1247"><a href="#NSSession.ask-1247"><span class="linenos">1247</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Asking for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.ask-1248"><a href="#NSSession.ask-1248"><span class="linenos">1248</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.ask-1249"><a href="#NSSession.ask-1249"><span class="linenos">1249</span></a>
</span><span id="NSSession.ask-1250"><a href="#NSSession.ask-1250"><span class="linenos">1250</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;auction_ask&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;auction_submit&quot;</span><span class="p">:</span> <span class="s2">&quot;ask&quot;</span><span class="p">}</span>
</span><span id="NSSession.ask-1251"><a href="#NSSession.ask-1251"><span class="linenos">1251</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.ask-1252"><a href="#NSSession.ask-1252"><span class="linenos">1252</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Your ask of </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Puts an ask at price on a card in a season</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>price (str):</strong>  Price to ask</li>
<li><strong>card_id (str):</strong>  ID of the card</li>
<li><strong>season (str):</strong>  Season of the card</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the ask was successfully lodged or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.bid" class="classattr">
                                        <input id="NSSession.bid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">price</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">season</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.bid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.bid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.bid-1254"><a href="#NSSession.bid-1254"><span class="linenos">1254</span></a>    <span class="k">def</span> <span class="nf">bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.bid-1255"><a href="#NSSession.bid-1255"><span class="linenos">1255</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Places a bid on a card in a season</span>
</span><span id="NSSession.bid-1256"><a href="#NSSession.bid-1256"><span class="linenos">1256</span></a>
</span><span id="NSSession.bid-1257"><a href="#NSSession.bid-1257"><span class="linenos">1257</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.bid-1258"><a href="#NSSession.bid-1258"><span class="linenos">1258</span></a><span class="sd">            price (str): Amount of bank to bid</span>
</span><span id="NSSession.bid-1259"><a href="#NSSession.bid-1259"><span class="linenos">1259</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="NSSession.bid-1260"><a href="#NSSession.bid-1260"><span class="linenos">1260</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="NSSession.bid-1261"><a href="#NSSession.bid-1261"><span class="linenos">1261</span></a>
</span><span id="NSSession.bid-1262"><a href="#NSSession.bid-1262"><span class="linenos">1262</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.bid-1263"><a href="#NSSession.bid-1263"><span class="linenos">1263</span></a><span class="sd">            bool: Whether the bid was successfully lodged or not</span>
</span><span id="NSSession.bid-1264"><a href="#NSSession.bid-1264"><span class="linenos">1264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.bid-1265"><a href="#NSSession.bid-1265"><span class="linenos">1265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Putting a bid for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.bid-1266"><a href="#NSSession.bid-1266"><span class="linenos">1266</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.bid-1267"><a href="#NSSession.bid-1267"><span class="linenos">1267</span></a>
</span><span id="NSSession.bid-1268"><a href="#NSSession.bid-1268"><span class="linenos">1268</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;auction_bid&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;auction_submit&quot;</span><span class="p">:</span> <span class="s2">&quot;bid&quot;</span><span class="p">}</span>
</span><span id="NSSession.bid-1269"><a href="#NSSession.bid-1269"><span class="linenos">1269</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.bid-1270"><a href="#NSSession.bid-1270"><span class="linenos">1270</span></a>
</span><span id="NSSession.bid-1271"><a href="#NSSession.bid-1271"><span class="linenos">1271</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Your bid of </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> has been lodged.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Places a bid on a card in a season</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>price (str):</strong>  Amount of bank to bid</li>
<li><strong>card_id (str):</strong>  ID of the card</li>
<li><strong>season (str):</strong>  Season of the card</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the bid was successfully lodged or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.remove_ask" class="classattr">
                                        <input id="NSSession.remove_ask-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_ask</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">price</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">season</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.remove_ask-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.remove_ask"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.remove_ask-1273"><a href="#NSSession.remove_ask-1273"><span class="linenos">1273</span></a>    <span class="k">def</span> <span class="nf">remove_ask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.remove_ask-1274"><a href="#NSSession.remove_ask-1274"><span class="linenos">1274</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes an ask on card_id in season at price</span>
</span><span id="NSSession.remove_ask-1275"><a href="#NSSession.remove_ask-1275"><span class="linenos">1275</span></a>
</span><span id="NSSession.remove_ask-1276"><a href="#NSSession.remove_ask-1276"><span class="linenos">1276</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.remove_ask-1277"><a href="#NSSession.remove_ask-1277"><span class="linenos">1277</span></a><span class="sd">            price (str): Price of the ask to remove</span>
</span><span id="NSSession.remove_ask-1278"><a href="#NSSession.remove_ask-1278"><span class="linenos">1278</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="NSSession.remove_ask-1279"><a href="#NSSession.remove_ask-1279"><span class="linenos">1279</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="NSSession.remove_ask-1280"><a href="#NSSession.remove_ask-1280"><span class="linenos">1280</span></a>
</span><span id="NSSession.remove_ask-1281"><a href="#NSSession.remove_ask-1281"><span class="linenos">1281</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.remove_ask-1282"><a href="#NSSession.remove_ask-1282"><span class="linenos">1282</span></a><span class="sd">            bool: Whether the ask was successfully removed or not</span>
</span><span id="NSSession.remove_ask-1283"><a href="#NSSession.remove_ask-1283"><span class="linenos">1283</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.remove_ask-1284"><a href="#NSSession.remove_ask-1284"><span class="linenos">1284</span></a>
</span><span id="NSSession.remove_ask-1285"><a href="#NSSession.remove_ask-1285"><span class="linenos">1285</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;removing an ask for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.remove_ask-1286"><a href="#NSSession.remove_ask-1286"><span class="linenos">1286</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.remove_ask-1287"><a href="#NSSession.remove_ask-1287"><span class="linenos">1287</span></a>
</span><span id="NSSession.remove_ask-1288"><a href="#NSSession.remove_ask-1288"><span class="linenos">1288</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;new_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;remove_ask_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">}</span>
</span><span id="NSSession.remove_ask-1289"><a href="#NSSession.remove_ask-1289"><span class="linenos">1289</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.remove_ask-1290"><a href="#NSSession.remove_ask-1290"><span class="linenos">1290</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Removed your ask for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Removes an ask on card_id in season at price</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>price (str):</strong>  Price of the ask to remove</li>
<li><strong>card_id (str):</strong>  ID of the card</li>
<li><strong>season (str):</strong>  Season of the card</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the ask was successfully removed or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.remove_bid" class="classattr">
                                        <input id="NSSession.remove_bid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_bid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">price</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">season</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.remove_bid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.remove_bid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.remove_bid-1292"><a href="#NSSession.remove_bid-1292"><span class="linenos">1292</span></a>    <span class="k">def</span> <span class="nf">remove_bid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">season</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.remove_bid-1293"><a href="#NSSession.remove_bid-1293"><span class="linenos">1293</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes a bid on a card</span>
</span><span id="NSSession.remove_bid-1294"><a href="#NSSession.remove_bid-1294"><span class="linenos">1294</span></a>
</span><span id="NSSession.remove_bid-1295"><a href="#NSSession.remove_bid-1295"><span class="linenos">1295</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.remove_bid-1296"><a href="#NSSession.remove_bid-1296"><span class="linenos">1296</span></a><span class="sd">            price (str): Price of the bid to remove</span>
</span><span id="NSSession.remove_bid-1297"><a href="#NSSession.remove_bid-1297"><span class="linenos">1297</span></a><span class="sd">            card_id (str): ID of the card</span>
</span><span id="NSSession.remove_bid-1298"><a href="#NSSession.remove_bid-1298"><span class="linenos">1298</span></a><span class="sd">            season (str): Season of the card</span>
</span><span id="NSSession.remove_bid-1299"><a href="#NSSession.remove_bid-1299"><span class="linenos">1299</span></a>
</span><span id="NSSession.remove_bid-1300"><a href="#NSSession.remove_bid-1300"><span class="linenos">1300</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.remove_bid-1301"><a href="#NSSession.remove_bid-1301"><span class="linenos">1301</span></a><span class="sd">            bool: Whether the bid was successfully removed or not</span>
</span><span id="NSSession.remove_bid-1302"><a href="#NSSession.remove_bid-1302"><span class="linenos">1302</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.remove_bid-1303"><a href="#NSSession.remove_bid-1303"><span class="linenos">1303</span></a>
</span><span id="NSSession.remove_bid-1304"><a href="#NSSession.remove_bid-1304"><span class="linenos">1304</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing a bid for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> season </span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.remove_bid-1305"><a href="#NSSession.remove_bid-1305"><span class="linenos">1305</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.remove_bid-1306"><a href="#NSSession.remove_bid-1306"><span class="linenos">1306</span></a>
</span><span id="NSSession.remove_bid-1307"><a href="#NSSession.remove_bid-1307"><span class="linenos">1307</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;new_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span> <span class="s2">&quot;remove_bid_price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">}</span>
</span><span id="NSSession.remove_bid-1308"><a href="#NSSession.remove_bid-1308"><span class="linenos">1308</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.remove_bid-1309"><a href="#NSSession.remove_bid-1309"><span class="linenos">1309</span></a>
</span><span id="NSSession.remove_bid-1310"><a href="#NSSession.remove_bid-1310"><span class="linenos">1310</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Removed your bid for </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Removes a bid on a card</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>price (str):</strong>  Price of the bid to remove</li>
<li><strong>card_id (str):</strong>  ID of the card</li>
<li><strong>season (str):</strong>  Season of the card</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the bid was successfully removed or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.expand_deck" class="classattr">
                                        <input id="NSSession.expand_deck-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">expand_deck</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">price</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="NSSession.expand_deck-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.expand_deck"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.expand_deck-1312"><a href="#NSSession.expand_deck-1312"><span class="linenos">1312</span></a>    <span class="k">def</span> <span class="nf">expand_deck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="NSSession.expand_deck-1313"><a href="#NSSession.expand_deck-1313"><span class="linenos">1313</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Upgrades deck capacity</span>
</span><span id="NSSession.expand_deck-1314"><a href="#NSSession.expand_deck-1314"><span class="linenos">1314</span></a>
</span><span id="NSSession.expand_deck-1315"><a href="#NSSession.expand_deck-1315"><span class="linenos">1315</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.expand_deck-1316"><a href="#NSSession.expand_deck-1316"><span class="linenos">1316</span></a><span class="sd">            price (str): Price of the Upgrade</span>
</span><span id="NSSession.expand_deck-1317"><a href="#NSSession.expand_deck-1317"><span class="linenos">1317</span></a>
</span><span id="NSSession.expand_deck-1318"><a href="#NSSession.expand_deck-1318"><span class="linenos">1318</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.expand_deck-1319"><a href="#NSSession.expand_deck-1319"><span class="linenos">1319</span></a><span class="sd">            bool: Whether the upgrade was successfully removed or not</span>
</span><span id="NSSession.expand_deck-1320"><a href="#NSSession.expand_deck-1320"><span class="linenos">1320</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.expand_deck-1321"><a href="#NSSession.expand_deck-1321"><span class="linenos">1321</span></a>
</span><span id="NSSession.expand_deck-1322"><a href="#NSSession.expand_deck-1322"><span class="linenos">1322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Upgrading your deck at a cost of </span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.expand_deck-1323"><a href="#NSSession.expand_deck-1323"><span class="linenos">1323</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession.expand_deck-1324"><a href="#NSSession.expand_deck-1324"><span class="linenos">1324</span></a>
</span><span id="NSSession.expand_deck-1325"><a href="#NSSession.expand_deck-1325"><span class="linenos">1325</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;embiggen_deck&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">}</span>
</span><span id="NSSession.expand_deck-1326"><a href="#NSSession.expand_deck-1326"><span class="linenos">1326</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.expand_deck-1327"><a href="#NSSession.expand_deck-1327"><span class="linenos">1327</span></a>
</span><span id="NSSession.expand_deck-1328"><a href="#NSSession.expand_deck-1328"><span class="linenos">1328</span></a>        <span class="k">return</span> <span class="s2">&quot;Increased deck capacity from&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Upgrades deck capacity</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>price (str):</strong>  Price of the Upgrade</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the upgrade was successfully removed or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.add_to_collection" class="classattr">
                                        <input id="NSSession.add_to_collection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_to_collection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">card_season</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">collection_id</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NSSession.add_to_collection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.add_to_collection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.add_to_collection-1330"><a href="#NSSession.add_to_collection-1330"><span class="linenos">1330</span></a>    <span class="k">def</span> <span class="nf">add_to_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_season</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collection_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession.add_to_collection-1331"><a href="#NSSession.add_to_collection-1331"><span class="linenos">1331</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a card to collection_id</span>
</span><span id="NSSession.add_to_collection-1332"><a href="#NSSession.add_to_collection-1332"><span class="linenos">1332</span></a>
</span><span id="NSSession.add_to_collection-1333"><a href="#NSSession.add_to_collection-1333"><span class="linenos">1333</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.add_to_collection-1334"><a href="#NSSession.add_to_collection-1334"><span class="linenos">1334</span></a><span class="sd">            card_id (str): Card ID</span>
</span><span id="NSSession.add_to_collection-1335"><a href="#NSSession.add_to_collection-1335"><span class="linenos">1335</span></a><span class="sd">            card_season (str): Cards season</span>
</span><span id="NSSession.add_to_collection-1336"><a href="#NSSession.add_to_collection-1336"><span class="linenos">1336</span></a><span class="sd">            collection_id (str): The ID of the collection you want to add to</span>
</span><span id="NSSession.add_to_collection-1337"><a href="#NSSession.add_to_collection-1337"><span class="linenos">1337</span></a>
</span><span id="NSSession.add_to_collection-1338"><a href="#NSSession.add_to_collection-1338"><span class="linenos">1338</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.add_to_collection-1339"><a href="#NSSession.add_to_collection-1339"><span class="linenos">1339</span></a><span class="sd">            bool: Whether the adding was successfully added or not</span>
</span><span id="NSSession.add_to_collection-1340"><a href="#NSSession.add_to_collection-1340"><span class="linenos">1340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.add_to_collection-1341"><a href="#NSSession.add_to_collection-1341"><span class="linenos">1341</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> of season </span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.add_to_collection-1342"><a href="#NSSession.add_to_collection-1342"><span class="linenos">1342</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.add_to_collection-1343"><a href="#NSSession.add_to_collection-1343"><span class="linenos">1343</span></a>
</span><span id="NSSession.add_to_collection-1344"><a href="#NSSession.add_to_collection-1344"><span class="linenos">1344</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.add_to_collection-1345"><a href="#NSSession.add_to_collection-1345"><span class="linenos">1345</span></a>            <span class="s2">&quot;manage_collections&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.add_to_collection-1346"><a href="#NSSession.add_to_collection-1346"><span class="linenos">1346</span></a>            <span class="s2">&quot;modify_card_in_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.add_to_collection-1347"><a href="#NSSession.add_to_collection-1347"><span class="linenos">1347</span></a>            <span class="sa">f</span><span class="s2">&quot;collection_</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.add_to_collection-1348"><a href="#NSSession.add_to_collection-1348"><span class="linenos">1348</span></a>            <span class="s2">&quot;save_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.add_to_collection-1349"><a href="#NSSession.add_to_collection-1349"><span class="linenos">1349</span></a>        <span class="p">}</span>
</span><span id="NSSession.add_to_collection-1350"><a href="#NSSession.add_to_collection-1350"><span class="linenos">1350</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.add_to_collection-1351"><a href="#NSSession.add_to_collection-1351"><span class="linenos">1351</span></a>
</span><span id="NSSession.add_to_collection-1352"><a href="#NSSession.add_to_collection-1352"><span class="linenos">1352</span></a>        <span class="k">return</span> <span class="s2">&quot;Updated collections.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Adds a card to collection_id</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>card_id (str):</strong>  Card ID</li>
<li><strong>card_season (str):</strong>  Cards season</li>
<li><strong>collection_id (str):</strong>  The ID of the collection you want to add to</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the adding was successfully added or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.remove_from_collection" class="classattr">
                                        <input id="NSSession.remove_from_collection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">remove_from_collection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">card_season</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">collection_id</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NSSession.remove_from_collection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.remove_from_collection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.remove_from_collection-1354"><a href="#NSSession.remove_from_collection-1354"><span class="linenos">1354</span></a>    <span class="k">def</span> <span class="nf">remove_from_collection</span><span class="p">(</span>
</span><span id="NSSession.remove_from_collection-1355"><a href="#NSSession.remove_from_collection-1355"><span class="linenos">1355</span></a>        <span class="bp">self</span><span class="p">,</span> <span class="n">card_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_season</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collection_id</span><span class="p">:</span> <span class="nb">str</span>
</span><span id="NSSession.remove_from_collection-1356"><a href="#NSSession.remove_from_collection-1356"><span class="linenos">1356</span></a>    <span class="p">):</span>
</span><span id="NSSession.remove_from_collection-1357"><a href="#NSSession.remove_from_collection-1357"><span class="linenos">1357</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes a card from collection_id</span>
</span><span id="NSSession.remove_from_collection-1358"><a href="#NSSession.remove_from_collection-1358"><span class="linenos">1358</span></a>
</span><span id="NSSession.remove_from_collection-1359"><a href="#NSSession.remove_from_collection-1359"><span class="linenos">1359</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.remove_from_collection-1360"><a href="#NSSession.remove_from_collection-1360"><span class="linenos">1360</span></a><span class="sd">            card_id (str): Card ID</span>
</span><span id="NSSession.remove_from_collection-1361"><a href="#NSSession.remove_from_collection-1361"><span class="linenos">1361</span></a><span class="sd">            card_season (str): Cards season</span>
</span><span id="NSSession.remove_from_collection-1362"><a href="#NSSession.remove_from_collection-1362"><span class="linenos">1362</span></a><span class="sd">            collection_id (str): The ID of the collection you want to remove from</span>
</span><span id="NSSession.remove_from_collection-1363"><a href="#NSSession.remove_from_collection-1363"><span class="linenos">1363</span></a>
</span><span id="NSSession.remove_from_collection-1364"><a href="#NSSession.remove_from_collection-1364"><span class="linenos">1364</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.remove_from_collection-1365"><a href="#NSSession.remove_from_collection-1365"><span class="linenos">1365</span></a><span class="sd">            bool: Whether the removal was successfully added or not</span>
</span><span id="NSSession.remove_from_collection-1366"><a href="#NSSession.remove_from_collection-1366"><span class="linenos">1366</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.remove_from_collection-1367"><a href="#NSSession.remove_from_collection-1367"><span class="linenos">1367</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
</span><span id="NSSession.remove_from_collection-1368"><a href="#NSSession.remove_from_collection-1368"><span class="linenos">1368</span></a>            <span class="sa">f</span><span class="s2">&quot;Removing </span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2"> of season </span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2"> from </span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.remove_from_collection-1369"><a href="#NSSession.remove_from_collection-1369"><span class="linenos">1369</span></a>        <span class="p">)</span>
</span><span id="NSSession.remove_from_collection-1370"><a href="#NSSession.remove_from_collection-1370"><span class="linenos">1370</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck/card=</span><span class="si">{</span><span class="n">card_id</span><span class="si">}</span><span class="s2">/season=</span><span class="si">{</span><span class="n">card_season</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.remove_from_collection-1371"><a href="#NSSession.remove_from_collection-1371"><span class="linenos">1371</span></a>
</span><span id="NSSession.remove_from_collection-1372"><a href="#NSSession.remove_from_collection-1372"><span class="linenos">1372</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="NSSession.remove_from_collection-1373"><a href="#NSSession.remove_from_collection-1373"><span class="linenos">1373</span></a>            <span class="s2">&quot;manage_collections&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.remove_from_collection-1374"><a href="#NSSession.remove_from_collection-1374"><span class="linenos">1374</span></a>            <span class="s2">&quot;modify_card_in_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.remove_from_collection-1375"><a href="#NSSession.remove_from_collection-1375"><span class="linenos">1375</span></a>            <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
</span><span id="NSSession.remove_from_collection-1376"><a href="#NSSession.remove_from_collection-1376"><span class="linenos">1376</span></a>            <span class="sa">f</span><span class="s2">&quot;collection_</span><span class="si">{</span><span class="n">collection_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span><span class="p">,</span>
</span><span id="NSSession.remove_from_collection-1377"><a href="#NSSession.remove_from_collection-1377"><span class="linenos">1377</span></a>            <span class="s2">&quot;save_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span id="NSSession.remove_from_collection-1378"><a href="#NSSession.remove_from_collection-1378"><span class="linenos">1378</span></a>        <span class="p">}</span>
</span><span id="NSSession.remove_from_collection-1379"><a href="#NSSession.remove_from_collection-1379"><span class="linenos">1379</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.remove_from_collection-1380"><a href="#NSSession.remove_from_collection-1380"><span class="linenos">1380</span></a>
</span><span id="NSSession.remove_from_collection-1381"><a href="#NSSession.remove_from_collection-1381"><span class="linenos">1381</span></a>        <span class="k">return</span> <span class="s2">&quot;Updated collections.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Removes a card from collection_id</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>card_id (str):</strong>  Card ID</li>
<li><strong>card_season (str):</strong>  Cards season</li>
<li><strong>collection_id (str):</strong>  The ID of the collection you want to remove from</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the removal was successfully added or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.create_collection" class="classattr">
                                        <input id="NSSession.create_collection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">create_collection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NSSession.create_collection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.create_collection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.create_collection-1383"><a href="#NSSession.create_collection-1383"><span class="linenos">1383</span></a>    <span class="k">def</span> <span class="nf">create_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession.create_collection-1384"><a href="#NSSession.create_collection-1384"><span class="linenos">1384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a collection named name</span>
</span><span id="NSSession.create_collection-1385"><a href="#NSSession.create_collection-1385"><span class="linenos">1385</span></a>
</span><span id="NSSession.create_collection-1386"><a href="#NSSession.create_collection-1386"><span class="linenos">1386</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.create_collection-1387"><a href="#NSSession.create_collection-1387"><span class="linenos">1387</span></a><span class="sd">            name (str): The name of the collection you want to create</span>
</span><span id="NSSession.create_collection-1388"><a href="#NSSession.create_collection-1388"><span class="linenos">1388</span></a>
</span><span id="NSSession.create_collection-1389"><a href="#NSSession.create_collection-1389"><span class="linenos">1389</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.create_collection-1390"><a href="#NSSession.create_collection-1390"><span class="linenos">1390</span></a><span class="sd">            bool: Whether the creating was successfully added or not</span>
</span><span id="NSSession.create_collection-1391"><a href="#NSSession.create_collection-1391"><span class="linenos">1391</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.create_collection-1392"><a href="#NSSession.create_collection-1392"><span class="linenos">1392</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> collection&quot;</span><span class="p">)</span>
</span><span id="NSSession.create_collection-1393"><a href="#NSSession.create_collection-1393"><span class="linenos">1393</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession.create_collection-1394"><a href="#NSSession.create_collection-1394"><span class="linenos">1394</span></a>
</span><span id="NSSession.create_collection-1395"><a href="#NSSession.create_collection-1395"><span class="linenos">1395</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;edit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;collection_name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;save_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.create_collection-1396"><a href="#NSSession.create_collection-1396"><span class="linenos">1396</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.create_collection-1397"><a href="#NSSession.create_collection-1397"><span class="linenos">1397</span></a>
</span><span id="NSSession.create_collection-1398"><a href="#NSSession.create_collection-1398"><span class="linenos">1398</span></a>        <span class="k">return</span> <span class="s2">&quot;Created collection!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Creates a collection named name</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name (str):</strong>  The name of the collection you want to create</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the creating was successfully added or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.delete_collection" class="classattr">
                                        <input id="NSSession.delete_collection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">delete_collection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NSSession.delete_collection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.delete_collection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.delete_collection-1400"><a href="#NSSession.delete_collection-1400"><span class="linenos">1400</span></a>    <span class="k">def</span> <span class="nf">delete_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession.delete_collection-1401"><a href="#NSSession.delete_collection-1401"><span class="linenos">1401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes a collection named name</span>
</span><span id="NSSession.delete_collection-1402"><a href="#NSSession.delete_collection-1402"><span class="linenos">1402</span></a>
</span><span id="NSSession.delete_collection-1403"><a href="#NSSession.delete_collection-1403"><span class="linenos">1403</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.delete_collection-1404"><a href="#NSSession.delete_collection-1404"><span class="linenos">1404</span></a><span class="sd">            name (str): The name of the collection you want to delete</span>
</span><span id="NSSession.delete_collection-1405"><a href="#NSSession.delete_collection-1405"><span class="linenos">1405</span></a>
</span><span id="NSSession.delete_collection-1406"><a href="#NSSession.delete_collection-1406"><span class="linenos">1406</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.delete_collection-1407"><a href="#NSSession.delete_collection-1407"><span class="linenos">1407</span></a><span class="sd">            bool: Whether the deleting was successfully added or not</span>
</span><span id="NSSession.delete_collection-1408"><a href="#NSSession.delete_collection-1408"><span class="linenos">1408</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.delete_collection-1409"><a href="#NSSession.delete_collection-1409"><span class="linenos">1409</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Deleting </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> collection&quot;</span><span class="p">)</span>
</span><span id="NSSession.delete_collection-1410"><a href="#NSSession.delete_collection-1410"><span class="linenos">1410</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=deck&quot;</span>
</span><span id="NSSession.delete_collection-1411"><a href="#NSSession.delete_collection-1411"><span class="linenos">1411</span></a>
</span><span id="NSSession.delete_collection-1412"><a href="#NSSession.delete_collection-1412"><span class="linenos">1412</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;edit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;collection_name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;delete_collection&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.delete_collection-1413"><a href="#NSSession.delete_collection-1413"><span class="linenos">1413</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.delete_collection-1414"><a href="#NSSession.delete_collection-1414"><span class="linenos">1414</span></a>
</span><span id="NSSession.delete_collection-1415"><a href="#NSSession.delete_collection-1415"><span class="linenos">1415</span></a>        <span class="k">return</span> <span class="s2">&quot;Created collection!&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Deletes a collection named name</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name (str):</strong>  The name of the collection you want to delete</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the deleting was successfully added or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.can_nation_be_founded" class="classattr">
                                        <input id="NSSession.can_nation_be_founded-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">can_nation_be_founded</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">name</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NSSession.can_nation_be_founded-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.can_nation_be_founded"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.can_nation_be_founded-1417"><a href="#NSSession.can_nation_be_founded-1417"><span class="linenos">1417</span></a>    <span class="k">def</span> <span class="nf">can_nation_be_founded</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession.can_nation_be_founded-1418"><a href="#NSSession.can_nation_be_founded-1418"><span class="linenos">1418</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if a nation can be founded</span>
</span><span id="NSSession.can_nation_be_founded-1419"><a href="#NSSession.can_nation_be_founded-1419"><span class="linenos">1419</span></a>
</span><span id="NSSession.can_nation_be_founded-1420"><a href="#NSSession.can_nation_be_founded-1420"><span class="linenos">1420</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.can_nation_be_founded-1421"><a href="#NSSession.can_nation_be_founded-1421"><span class="linenos">1421</span></a><span class="sd">            name (str): The name of the nation you want to check</span>
</span><span id="NSSession.can_nation_be_founded-1422"><a href="#NSSession.can_nation_be_founded-1422"><span class="linenos">1422</span></a>
</span><span id="NSSession.can_nation_be_founded-1423"><a href="#NSSession.can_nation_be_founded-1423"><span class="linenos">1423</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.can_nation_be_founded-1424"><a href="#NSSession.can_nation_be_founded-1424"><span class="linenos">1424</span></a><span class="sd">            bool: Whether the nation can be founded or not</span>
</span><span id="NSSession.can_nation_be_founded-1425"><a href="#NSSession.can_nation_be_founded-1425"><span class="linenos">1425</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.can_nation_be_founded-1426"><a href="#NSSession.can_nation_be_founded-1426"><span class="linenos">1426</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> in boneyard&quot;</span><span class="p">)</span>
</span><span id="NSSession.can_nation_be_founded-1427"><a href="#NSSession.can_nation_be_founded-1427"><span class="linenos">1427</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=boneyard&quot;</span>
</span><span id="NSSession.can_nation_be_founded-1428"><a href="#NSSession.can_nation_be_founded-1428"><span class="linenos">1428</span></a>
</span><span id="NSSession.can_nation_be_founded-1429"><a href="#NSSession.can_nation_be_founded-1429"><span class="linenos">1429</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nation&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span> <span class="s2">&quot;submit&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.can_nation_be_founded-1430"><a href="#NSSession.can_nation_be_founded-1430"><span class="linenos">1430</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.can_nation_be_founded-1431"><a href="#NSSession.can_nation_be_founded-1431"><span class="linenos">1431</span></a>
</span><span id="NSSession.can_nation_be_founded-1432"><a href="#NSSession.can_nation_be_founded-1432"><span class="linenos">1432</span></a>        <span class="k">return</span> <span class="p">(</span>
</span><span id="NSSession.can_nation_be_founded-1433"><a href="#NSSession.can_nation_be_founded-1433"><span class="linenos">1433</span></a>            <span class="s2">&quot;Available! This name may be used to found a new nation.&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span><span id="NSSession.can_nation_be_founded-1434"><a href="#NSSession.can_nation_be_founded-1434"><span class="linenos">1434</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Checks if a nation can be founded</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>name (str):</strong>  The name of the nation you want to check</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the nation can be founded or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.join_nday_faction" class="classattr">
                                        <input id="NSSession.join_nday_faction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">join_nday_faction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NSSession.join_nday_faction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.join_nday_faction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.join_nday_faction-1436"><a href="#NSSession.join_nday_faction-1436"><span class="linenos">1436</span></a>    <span class="k">def</span> <span class="nf">join_nday_faction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession.join_nday_faction-1437"><a href="#NSSession.join_nday_faction-1437"><span class="linenos">1437</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Joins a faction in the N-Day event</span>
</span><span id="NSSession.join_nday_faction-1438"><a href="#NSSession.join_nday_faction-1438"><span class="linenos">1438</span></a>
</span><span id="NSSession.join_nday_faction-1439"><a href="#NSSession.join_nday_faction-1439"><span class="linenos">1439</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.join_nday_faction-1440"><a href="#NSSession.join_nday_faction-1440"><span class="linenos">1440</span></a><span class="sd">            id (str): The ID of the faction you want to join</span>
</span><span id="NSSession.join_nday_faction-1441"><a href="#NSSession.join_nday_faction-1441"><span class="linenos">1441</span></a>
</span><span id="NSSession.join_nday_faction-1442"><a href="#NSSession.join_nday_faction-1442"><span class="linenos">1442</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.join_nday_faction-1443"><a href="#NSSession.join_nday_faction-1443"><span class="linenos">1443</span></a><span class="sd">            bool: Whether the joining was successful or not</span>
</span><span id="NSSession.join_nday_faction-1444"><a href="#NSSession.join_nday_faction-1444"><span class="linenos">1444</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.join_nday_faction-1445"><a href="#NSSession.join_nday_faction-1445"><span class="linenos">1445</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joining faction </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.join_nday_faction-1446"><a href="#NSSession.join_nday_faction-1446"><span class="linenos">1446</span></a>
</span><span id="NSSession.join_nday_faction-1447"><a href="#NSSession.join_nday_faction-1447"><span class="linenos">1447</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="NSSession.join_nday_faction-1448"><a href="#NSSession.join_nday_faction-1448"><span class="linenos">1448</span></a>            <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=faction/fid=</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.join_nday_faction-1449"><a href="#NSSession.join_nday_faction-1449"><span class="linenos">1449</span></a>        <span class="p">)</span>
</span><span id="NSSession.join_nday_faction-1450"><a href="#NSSession.join_nday_faction-1450"><span class="linenos">1450</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;join_faction&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.join_nday_faction-1451"><a href="#NSSession.join_nday_faction-1451"><span class="linenos">1451</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.join_nday_faction-1452"><a href="#NSSession.join_nday_faction-1452"><span class="linenos">1452</span></a>
</span><span id="NSSession.join_nday_faction-1453"><a href="#NSSession.join_nday_faction-1453"><span class="linenos">1453</span></a>        <span class="k">return</span> <span class="s2">&quot; has joined &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Joins a faction in the N-Day event</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>id (str):</strong>  The ID of the faction you want to join</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the joining was successful or not</p>
</blockquote>
</div>


                            </div>
                            <div id="NSSession.leave_nday_faction" class="classattr">
                                        <input id="NSSession.leave_nday_faction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">leave_nday_faction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="NSSession.leave_nday_faction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#NSSession.leave_nday_faction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="NSSession.leave_nday_faction-1455"><a href="#NSSession.leave_nday_faction-1455"><span class="linenos">1455</span></a>    <span class="k">def</span> <span class="nf">leave_nday_faction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="NSSession.leave_nday_faction-1456"><a href="#NSSession.leave_nday_faction-1456"><span class="linenos">1456</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Leaves a faction in the N-Day event</span>
</span><span id="NSSession.leave_nday_faction-1457"><a href="#NSSession.leave_nday_faction-1457"><span class="linenos">1457</span></a>
</span><span id="NSSession.leave_nday_faction-1458"><a href="#NSSession.leave_nday_faction-1458"><span class="linenos">1458</span></a><span class="sd">        Args:</span>
</span><span id="NSSession.leave_nday_faction-1459"><a href="#NSSession.leave_nday_faction-1459"><span class="linenos">1459</span></a><span class="sd">            id (str): The ID of the faction you want to leave</span>
</span><span id="NSSession.leave_nday_faction-1460"><a href="#NSSession.leave_nday_faction-1460"><span class="linenos">1460</span></a>
</span><span id="NSSession.leave_nday_faction-1461"><a href="#NSSession.leave_nday_faction-1461"><span class="linenos">1461</span></a><span class="sd">        Returns:</span>
</span><span id="NSSession.leave_nday_faction-1462"><a href="#NSSession.leave_nday_faction-1462"><span class="linenos">1462</span></a><span class="sd">            bool: Whether the leaving was successful or not</span>
</span><span id="NSSession.leave_nday_faction-1463"><a href="#NSSession.leave_nday_faction-1463"><span class="linenos">1463</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="NSSession.leave_nday_faction-1464"><a href="#NSSession.leave_nday_faction-1464"><span class="linenos">1464</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Leaving faction </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="NSSession.leave_nday_faction-1465"><a href="#NSSession.leave_nday_faction-1465"><span class="linenos">1465</span></a>
</span><span id="NSSession.leave_nday_faction-1466"><a href="#NSSession.leave_nday_faction-1466"><span class="linenos">1466</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="NSSession.leave_nday_faction-1467"><a href="#NSSession.leave_nday_faction-1467"><span class="linenos">1467</span></a>            <span class="sa">f</span><span class="s2">&quot;https://www.nationstates.net/template-overall=none/page=faction/fid=</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="NSSession.leave_nday_faction-1468"><a href="#NSSession.leave_nday_faction-1468"><span class="linenos">1468</span></a>        <span class="p">)</span>
</span><span id="NSSession.leave_nday_faction-1469"><a href="#NSSession.leave_nday_faction-1469"><span class="linenos">1469</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;leave_faction&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">}</span>
</span><span id="NSSession.leave_nday_faction-1470"><a href="#NSSession.leave_nday_faction-1470"><span class="linenos">1470</span></a>        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="NSSession.leave_nday_faction-1471"><a href="#NSSession.leave_nday_faction-1471"><span class="linenos">1471</span></a>
</span><span id="NSSession.leave_nday_faction-1472"><a href="#NSSession.leave_nday_faction-1472"><span class="linenos">1472</span></a>        <span class="k">return</span> <span class="s2">&quot; has left &quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</span></pre></div>


            <div class="docstring"><p>Leaves a faction in the N-Day event</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>id (str):</strong>  The ID of the faction you want to leave</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>bool: Whether the leaving was successful or not</p>
</blockquote>
</div>


                            </div>
                </section>
    </main>
</body>
</html>